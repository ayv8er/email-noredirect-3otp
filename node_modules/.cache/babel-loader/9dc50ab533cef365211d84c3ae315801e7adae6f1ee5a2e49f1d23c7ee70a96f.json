{"ast":null,"code":"var Gt = Object.create;\nvar ue = Object.defineProperty,\n  Kt = Object.defineProperties,\n  jt = Object.getOwnPropertyDescriptor,\n  Bt = Object.getOwnPropertyDescriptors,\n  Ht = Object.getOwnPropertyNames,\n  Ve = Object.getOwnPropertySymbols,\n  Vt = Object.getPrototypeOf,\n  ze = Object.prototype.hasOwnProperty,\n  Xt = Object.prototype.propertyIsEnumerable;\nvar Xe = (n, t, e) => t in n ? ue(n, t, {\n    enumerable: !0,\n    configurable: !0,\n    writable: !0,\n    value: e\n  }) : n[t] = e,\n  j = (n, t) => {\n    for (var e in t || (t = {})) ze.call(t, e) && Xe(n, e, t[e]);\n    if (Ve) for (var e of Ve(t)) Xt.call(t, e) && Xe(n, e, t[e]);\n    return n;\n  },\n  B = (n, t) => Kt(n, Bt(t));\nvar zt = (n, t) => () => (t || n((t = {\n    exports: {}\n  }).exports, t), t.exports),\n  Yt = (n, t) => {\n    for (var e in t) ue(n, e, {\n      get: t[e],\n      enumerable: !0\n    });\n  },\n  Zt = (n, t, e, r) => {\n    if (t && typeof t == \"object\" || typeof t == \"function\") for (let o of Ht(t)) !ze.call(n, o) && o !== e && ue(n, o, {\n      get: () => t[o],\n      enumerable: !(r = jt(t, o)) || r.enumerable\n    });\n    return n;\n  };\nvar Qt = (n, t, e) => (e = n != null ? Gt(Vt(n)) : {}, Zt(t || !n || !n.__esModule ? ue(e, \"default\", {\n  value: n,\n  enumerable: !0\n}) : e, n));\nvar m = (n, t, e) => new Promise((r, o) => {\n  var s = c => {\n      try {\n        i(e.next(c));\n      } catch (u) {\n        o(u);\n      }\n    },\n    a = c => {\n      try {\n        i(e.throw(c));\n      } catch (u) {\n        o(u);\n      }\n    },\n    i = c => c.done ? r(c.value) : Promise.resolve(c.value).then(s, a);\n  i((e = e.apply(n, t)).next());\n});\nvar wt = zt((Gr, Le) => {\n  \"use strict\";\n\n  var Xn = Object.prototype.hasOwnProperty,\n    w = \"~\";\n  function oe() {}\n  Object.create && (oe.prototype = Object.create(null), new oe().__proto__ || (w = !1));\n  function zn(n, t, e) {\n    this.fn = n, this.context = t, this.once = e || !1;\n  }\n  function bt(n, t, e, r, o) {\n    if (typeof e != \"function\") throw new TypeError(\"The listener must be a function\");\n    var s = new zn(e, r || n, o),\n      a = w ? w + t : t;\n    return n._events[a] ? n._events[a].fn ? n._events[a] = [n._events[a], s] : n._events[a].push(s) : (n._events[a] = s, n._eventsCount++), n;\n  }\n  function ye(n, t) {\n    --n._eventsCount === 0 ? n._events = new oe() : delete n._events[t];\n  }\n  function I() {\n    this._events = new oe(), this._eventsCount = 0;\n  }\n  I.prototype.eventNames = function () {\n    var t = [],\n      e,\n      r;\n    if (this._eventsCount === 0) return t;\n    for (r in e = this._events) Xn.call(e, r) && t.push(w ? r.slice(1) : r);\n    return Object.getOwnPropertySymbols ? t.concat(Object.getOwnPropertySymbols(e)) : t;\n  };\n  I.prototype.listeners = function (t) {\n    var e = w ? w + t : t,\n      r = this._events[e];\n    if (!r) return [];\n    if (r.fn) return [r.fn];\n    for (var o = 0, s = r.length, a = new Array(s); o < s; o++) a[o] = r[o].fn;\n    return a;\n  };\n  I.prototype.listenerCount = function (t) {\n    var e = w ? w + t : t,\n      r = this._events[e];\n    return r ? r.fn ? 1 : r.length : 0;\n  };\n  I.prototype.emit = function (t, e, r, o, s, a) {\n    var i = w ? w + t : t;\n    if (!this._events[i]) return !1;\n    var c = this._events[i],\n      u = arguments.length,\n      l,\n      p;\n    if (c.fn) {\n      switch (c.once && this.removeListener(t, c.fn, void 0, !0), u) {\n        case 1:\n          return c.fn.call(c.context), !0;\n        case 2:\n          return c.fn.call(c.context, e), !0;\n        case 3:\n          return c.fn.call(c.context, e, r), !0;\n        case 4:\n          return c.fn.call(c.context, e, r, o), !0;\n        case 5:\n          return c.fn.call(c.context, e, r, o, s), !0;\n        case 6:\n          return c.fn.call(c.context, e, r, o, s, a), !0;\n      }\n      for (p = 1, l = new Array(u - 1); p < u; p++) l[p - 1] = arguments[p];\n      c.fn.apply(c.context, l);\n    } else {\n      var x = c.length,\n        v;\n      for (p = 0; p < x; p++) switch (c[p].once && this.removeListener(t, c[p].fn, void 0, !0), u) {\n        case 1:\n          c[p].fn.call(c[p].context);\n          break;\n        case 2:\n          c[p].fn.call(c[p].context, e);\n          break;\n        case 3:\n          c[p].fn.call(c[p].context, e, r);\n          break;\n        case 4:\n          c[p].fn.call(c[p].context, e, r, o);\n          break;\n        default:\n          if (!l) for (v = 1, l = new Array(u - 1); v < u; v++) l[v - 1] = arguments[v];\n          c[p].fn.apply(c[p].context, l);\n      }\n    }\n    return !0;\n  };\n  I.prototype.on = function (t, e, r) {\n    return bt(this, t, e, r, !1);\n  };\n  I.prototype.once = function (t, e, r) {\n    return bt(this, t, e, r, !0);\n  };\n  I.prototype.removeListener = function (t, e, r, o) {\n    var s = w ? w + t : t;\n    if (!this._events[s]) return this;\n    if (!e) return ye(this, s), this;\n    var a = this._events[s];\n    if (a.fn) a.fn === e && (!o || a.once) && (!r || a.context === r) && ye(this, s);else {\n      for (var i = 0, c = [], u = a.length; i < u; i++) (a[i].fn !== e || o && !a[i].once || r && a[i].context !== r) && c.push(a[i]);\n      c.length ? this._events[s] = c.length === 1 ? c[0] : c : ye(this, s);\n    }\n    return this;\n  };\n  I.prototype.removeAllListeners = function (t) {\n    var e;\n    return t ? (e = w ? w + t : t, this._events[e] && ye(this, e)) : (this._events = new oe(), this._eventsCount = 0), this;\n  };\n  I.prototype.off = I.prototype.removeListener;\n  I.prototype.addListener = I.prototype.on;\n  I.prefixed = w;\n  I.EventEmitter = I;\n  typeof Le < \"u\" && (Le.exports = I);\n});\nfunction en(n) {\n  let t = {\n    exports: {}\n  };\n  return n(t, t.exports), t.exports;\n}\nvar tn = Number.MAX_SAFE_INTEGER || 9007199254740991;\nvar Ae = {\n    SEMVER_SPEC_VERSION: \"2.0.0\",\n    MAX_LENGTH: 256,\n    MAX_SAFE_INTEGER: tn,\n    MAX_SAFE_COMPONENT_LENGTH: 16\n  },\n  nn = typeof process == \"object\" && process.env && process.env.NODE_DEBUG && /\\bsemver\\b/i.test(process.env.NODE_DEBUG) ? (...n) => console.error(\"SEMVER\", ...n) : () => {},\n  f = nn,\n  ne = en(function (n, t) {\n    let {\n        MAX_SAFE_COMPONENT_LENGTH: e\n      } = Ae,\n      r = (t = n.exports = {}).re = [],\n      o = t.src = [],\n      s = t.t = {},\n      a = 0,\n      i = (c, u, l) => {\n        let p = a++;\n        f(p, u), s[c] = p, o[p] = u, r[p] = new RegExp(u, l ? \"g\" : void 0);\n      };\n    i(\"NUMERICIDENTIFIER\", \"0|[1-9]\\\\d*\"), i(\"NUMERICIDENTIFIERLOOSE\", \"[0-9]+\"), i(\"NONNUMERICIDENTIFIER\", \"\\\\d*[a-zA-Z-][a-zA-Z0-9-]*\"), i(\"MAINVERSION\", `(${o[s.NUMERICIDENTIFIER]})\\\\.(${o[s.NUMERICIDENTIFIER]})\\\\.(${o[s.NUMERICIDENTIFIER]})`), i(\"MAINVERSIONLOOSE\", `(${o[s.NUMERICIDENTIFIERLOOSE]})\\\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`), i(\"PRERELEASEIDENTIFIER\", `(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`), i(\"PRERELEASEIDENTIFIERLOOSE\", `(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`), i(\"PRERELEASE\", `(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\\\.${o[s.PRERELEASEIDENTIFIER]})*))`), i(\"PRERELEASELOOSE\", `(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`), i(\"BUILDIDENTIFIER\", \"[0-9A-Za-z-]+\"), i(\"BUILD\", `(?:\\\\+(${o[s.BUILDIDENTIFIER]}(?:\\\\.${o[s.BUILDIDENTIFIER]})*))`), i(\"FULLPLAIN\", `v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`), i(\"FULL\", `^${o[s.FULLPLAIN]}$`), i(\"LOOSEPLAIN\", `[v=\\\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`), i(\"LOOSE\", `^${o[s.LOOSEPLAIN]}$`), i(\"GTLT\", \"((?:<|>)?=?)\"), i(\"XRANGEIDENTIFIERLOOSE\", `${o[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\\\*`), i(\"XRANGEIDENTIFIER\", `${o[s.NUMERICIDENTIFIER]}|x|X|\\\\*`), i(\"XRANGEPLAIN\", `[v=\\\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\\\.(${o[s.XRANGEIDENTIFIER]})(?:\\\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`), i(\"XRANGEPLAINLOOSE\", `[v=\\\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`), i(\"XRANGE\", `^${o[s.GTLT]}\\\\s*${o[s.XRANGEPLAIN]}$`), i(\"XRANGELOOSE\", `^${o[s.GTLT]}\\\\s*${o[s.XRANGEPLAINLOOSE]}$`), i(\"COERCE\", `(^|[^\\\\d])(\\\\d{1,${e}})(?:\\\\.(\\\\d{1,${e}}))?(?:\\\\.(\\\\d{1,${e}}))?(?:$|[^\\\\d])`), i(\"COERCERTL\", o[s.COERCE], !0), i(\"LONETILDE\", \"(?:~>?)\"), i(\"TILDETRIM\", `(\\\\s*)${o[s.LONETILDE]}\\\\s+`, !0), t.tildeTrimReplace = \"$1~\", i(\"TILDE\", `^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`), i(\"TILDELOOSE\", `^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`), i(\"LONECARET\", \"(?:\\\\^)\"), i(\"CARETTRIM\", `(\\\\s*)${o[s.LONECARET]}\\\\s+`, !0), t.caretTrimReplace = \"$1^\", i(\"CARET\", `^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`), i(\"CARETLOOSE\", `^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`), i(\"COMPARATORLOOSE\", `^${o[s.GTLT]}\\\\s*(${o[s.LOOSEPLAIN]})$|^$`), i(\"COMPARATOR\", `^${o[s.GTLT]}\\\\s*(${o[s.FULLPLAIN]})$|^$`), i(\"COMPARATORTRIM\", `(\\\\s*)${o[s.GTLT]}\\\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`, !0), t.comparatorTrimReplace = \"$1$2$3\", i(\"HYPHENRANGE\", `^\\\\s*(${o[s.XRANGEPLAIN]})\\\\s+-\\\\s+(${o[s.XRANGEPLAIN]})\\\\s*$`), i(\"HYPHENRANGELOOSE\", `^\\\\s*(${o[s.XRANGEPLAINLOOSE]})\\\\s+-\\\\s+(${o[s.XRANGEPLAINLOOSE]})\\\\s*$`), i(\"STAR\", \"(<|>)?=?\\\\s*\\\\*\"), i(\"GTE0\", \"^\\\\s*>=\\\\s*0.0.0\\\\s*$\"), i(\"GTE0PRE\", \"^\\\\s*>=\\\\s*0.0.0-0\\\\s*$\");\n  }),\n  Ye = /^[0-9]+$/,\n  it = (n, t) => {\n    let e = Ye.test(n),\n      r = Ye.test(t);\n    return e && r && (n = +n, t = +t), n === t ? 0 : e && !r ? -1 : r && !e ? 1 : n < t ? -1 : 1;\n  },\n  rn = (n, t) => it(t, n),\n  sn = {\n    compareIdentifiers: it,\n    rcompareIdentifiers: rn\n  },\n  {\n    MAX_LENGTH: Ze,\n    MAX_SAFE_INTEGER: de\n  } = Ae,\n  {\n    re: Qe,\n    t: et\n  } = ne,\n  {\n    compareIdentifiers: ee\n  } = sn,\n  E = class {\n    constructor(t, e) {\n      if (e && typeof e == \"object\" || (e = {\n        loose: !!e,\n        includePrerelease: !1\n      }), t instanceof E) {\n        if (t.loose === !!e.loose && t.includePrerelease === !!e.includePrerelease) return t;\n        t = t.version;\n      } else if (typeof t != \"string\") throw new TypeError(`Invalid Version: ${t}`);\n      if (t.length > Ze) throw new TypeError(`version is longer than ${Ze} characters`);\n      f(\"SemVer\", t, e), this.options = e, this.loose = !!e.loose, this.includePrerelease = !!e.includePrerelease;\n      let r = t.trim().match(e.loose ? Qe[et.LOOSE] : Qe[et.FULL]);\n      if (!r) throw new TypeError(`Invalid Version: ${t}`);\n      if (this.raw = t, this.major = +r[1], this.minor = +r[2], this.patch = +r[3], this.major > de || this.major < 0) throw new TypeError(\"Invalid major version\");\n      if (this.minor > de || this.minor < 0) throw new TypeError(\"Invalid minor version\");\n      if (this.patch > de || this.patch < 0) throw new TypeError(\"Invalid patch version\");\n      r[4] ? this.prerelease = r[4].split(\".\").map(o => {\n        if (/^[0-9]+$/.test(o)) {\n          let s = +o;\n          if (s >= 0 && s < de) return s;\n        }\n        return o;\n      }) : this.prerelease = [], this.build = r[5] ? r[5].split(\".\") : [], this.format();\n    }\n    format() {\n      return this.version = `${this.major}.${this.minor}.${this.patch}`, this.prerelease.length && (this.version += `-${this.prerelease.join(\".\")}`), this.version;\n    }\n    toString() {\n      return this.version;\n    }\n    compare(t) {\n      if (f(\"SemVer.compare\", this.version, this.options, t), !(t instanceof E)) {\n        if (typeof t == \"string\" && t === this.version) return 0;\n        t = new E(t, this.options);\n      }\n      return t.version === this.version ? 0 : this.compareMain(t) || this.comparePre(t);\n    }\n    compareMain(t) {\n      return t instanceof E || (t = new E(t, this.options)), ee(this.major, t.major) || ee(this.minor, t.minor) || ee(this.patch, t.patch);\n    }\n    comparePre(t) {\n      if (t instanceof E || (t = new E(t, this.options)), this.prerelease.length && !t.prerelease.length) return -1;\n      if (!this.prerelease.length && t.prerelease.length) return 1;\n      if (!this.prerelease.length && !t.prerelease.length) return 0;\n      let e = 0;\n      do {\n        let r = this.prerelease[e],\n          o = t.prerelease[e];\n        if (f(\"prerelease compare\", e, r, o), r === void 0 && o === void 0) return 0;\n        if (o === void 0) return 1;\n        if (r === void 0) return -1;\n        if (r !== o) return ee(r, o);\n      } while (++e);\n    }\n    compareBuild(t) {\n      t instanceof E || (t = new E(t, this.options));\n      let e = 0;\n      do {\n        let r = this.build[e],\n          o = t.build[e];\n        if (f(\"prerelease compare\", e, r, o), r === void 0 && o === void 0) return 0;\n        if (o === void 0) return 1;\n        if (r === void 0) return -1;\n        if (r !== o) return ee(r, o);\n      } while (++e);\n    }\n    inc(t, e) {\n      switch (t) {\n        case \"premajor\":\n          this.prerelease.length = 0, this.patch = 0, this.minor = 0, this.major++, this.inc(\"pre\", e);\n          break;\n        case \"preminor\":\n          this.prerelease.length = 0, this.patch = 0, this.minor++, this.inc(\"pre\", e);\n          break;\n        case \"prepatch\":\n          this.prerelease.length = 0, this.inc(\"patch\", e), this.inc(\"pre\", e);\n          break;\n        case \"prerelease\":\n          this.prerelease.length === 0 && this.inc(\"patch\", e), this.inc(\"pre\", e);\n          break;\n        case \"major\":\n          this.minor === 0 && this.patch === 0 && this.prerelease.length !== 0 || this.major++, this.minor = 0, this.patch = 0, this.prerelease = [];\n          break;\n        case \"minor\":\n          this.patch === 0 && this.prerelease.length !== 0 || this.minor++, this.patch = 0, this.prerelease = [];\n          break;\n        case \"patch\":\n          this.prerelease.length === 0 && this.patch++, this.prerelease = [];\n          break;\n        case \"pre\":\n          if (this.prerelease.length === 0) this.prerelease = [0];else {\n            let r = this.prerelease.length;\n            for (; --r >= 0;) typeof this.prerelease[r] == \"number\" && (this.prerelease[r]++, r = -2);\n            r === -1 && this.prerelease.push(0);\n          }\n          e && (this.prerelease[0] === e ? isNaN(this.prerelease[1]) && (this.prerelease = [e, 0]) : this.prerelease = [e, 0]);\n          break;\n        default:\n          throw new Error(`invalid increment argument: ${t}`);\n      }\n      return this.format(), this.raw = this.version, this;\n    }\n  },\n  on = (n, t, e) => new E(n, e).compare(new E(t, e)),\n  H = on,\n  an = (n, t, e) => H(n, t, e) === 0,\n  cn = an,\n  ln = (n, t, e) => H(n, t, e) !== 0,\n  un = ln,\n  dn = (n, t, e) => H(n, t, e) > 0,\n  pn = dn,\n  hn = (n, t, e) => H(n, t, e) >= 0,\n  mn = hn,\n  fn = (n, t, e) => H(n, t, e) < 0,\n  En = fn,\n  yn = (n, t, e) => H(n, t, e) <= 0,\n  gn = yn,\n  Rn = (n, t, e, r) => {\n    switch (t) {\n      case \"===\":\n        return typeof n == \"object\" && (n = n.version), typeof e == \"object\" && (e = e.version), n === e;\n      case \"!==\":\n        return typeof n == \"object\" && (n = n.version), typeof e == \"object\" && (e = e.version), n !== e;\n      case \"\":\n      case \"=\":\n      case \"==\":\n        return cn(n, e, r);\n      case \"!=\":\n        return un(n, e, r);\n      case \">\":\n        return pn(n, e, r);\n      case \">=\":\n        return mn(n, e, r);\n      case \"<\":\n        return En(n, e, r);\n      case \"<=\":\n        return gn(n, e, r);\n      default:\n        throw new TypeError(`Invalid operator: ${t}`);\n    }\n  },\n  Ce = Rn,\n  te = Symbol(\"SemVer ANY\"),\n  D = class {\n    static get ANY() {\n      return te;\n    }\n    constructor(t, e) {\n      if (e && typeof e == \"object\" || (e = {\n        loose: !!e,\n        includePrerelease: !1\n      }), t instanceof D) {\n        if (t.loose === !!e.loose) return t;\n        t = t.value;\n      }\n      f(\"comparator\", t, e), this.options = e, this.loose = !!e.loose, this.parse(t), this.semver === te ? this.value = \"\" : this.value = this.operator + this.semver.version, f(\"comp\", this);\n    }\n    parse(t) {\n      let e = this.options.loose ? tt[nt.COMPARATORLOOSE] : tt[nt.COMPARATOR],\n        r = t.match(e);\n      if (!r) throw new TypeError(`Invalid comparator: ${t}`);\n      this.operator = r[1] !== void 0 ? r[1] : \"\", this.operator === \"=\" && (this.operator = \"\"), r[2] ? this.semver = new E(r[2], this.options.loose) : this.semver = te;\n    }\n    toString() {\n      return this.value;\n    }\n    test(t) {\n      if (f(\"Comparator.test\", t, this.options.loose), this.semver === te || t === te) return !0;\n      if (typeof t == \"string\") try {\n        t = new E(t, this.options);\n      } catch (e) {\n        return !1;\n      }\n      return Ce(t, this.operator, this.semver, this.options);\n    }\n    intersects(t, e) {\n      if (!(t instanceof D)) throw new TypeError(\"a Comparator is required\");\n      if (e && typeof e == \"object\" || (e = {\n        loose: !!e,\n        includePrerelease: !1\n      }), this.operator === \"\") return this.value === \"\" || new L(t.value, e).test(this.value);\n      if (t.operator === \"\") return t.value === \"\" || new L(this.value, e).test(t.semver);\n      let r = !(this.operator !== \">=\" && this.operator !== \">\" || t.operator !== \">=\" && t.operator !== \">\"),\n        o = !(this.operator !== \"<=\" && this.operator !== \"<\" || t.operator !== \"<=\" && t.operator !== \"<\"),\n        s = this.semver.version === t.semver.version,\n        a = !(this.operator !== \">=\" && this.operator !== \"<=\" || t.operator !== \">=\" && t.operator !== \"<=\"),\n        i = Ce(this.semver, \"<\", t.semver, e) && (this.operator === \">=\" || this.operator === \">\") && (t.operator === \"<=\" || t.operator === \"<\"),\n        c = Ce(this.semver, \">\", t.semver, e) && (this.operator === \"<=\" || this.operator === \"<\") && (t.operator === \">=\" || t.operator === \">\");\n      return r || o || s && a || i || c;\n    }\n  },\n  {\n    re: tt,\n    t: nt\n  } = ne,\n  L = class {\n    constructor(t, e) {\n      if (e && typeof e == \"object\" || (e = {\n        loose: !!e,\n        includePrerelease: !1\n      }), t instanceof L) return t.loose === !!e.loose && t.includePrerelease === !!e.includePrerelease ? t : new L(t.raw, e);\n      if (t instanceof D) return this.raw = t.value, this.set = [[t]], this.format(), this;\n      if (this.options = e, this.loose = !!e.loose, this.includePrerelease = !!e.includePrerelease, this.raw = t, this.set = t.split(/\\s*\\|\\|\\s*/).map(r => this.parseRange(r.trim())).filter(r => r.length), !this.set.length) throw new TypeError(`Invalid SemVer Range: ${t}`);\n      this.format();\n    }\n    format() {\n      return this.range = this.set.map(t => t.join(\" \").trim()).join(\"||\").trim(), this.range;\n    }\n    toString() {\n      return this.range;\n    }\n    parseRange(t) {\n      let {\n        loose: e\n      } = this.options;\n      t = t.trim();\n      let r = e ? T[g.HYPHENRANGELOOSE] : T[g.HYPHENRANGE];\n      t = t.replace(r, Sn(this.options.includePrerelease)), f(\"hyphen replace\", t), t = t.replace(T[g.COMPARATORTRIM], vn), f(\"comparator trim\", t, T[g.COMPARATORTRIM]), t = (t = (t = t.replace(T[g.TILDETRIM], Tn)).replace(T[g.CARETTRIM], In)).split(/\\s+/).join(\" \");\n      let o = e ? T[g.COMPARATORLOOSE] : T[g.COMPARATOR];\n      return t.split(\" \").map(s => bn(s, this.options)).join(\" \").split(/\\s+/).map(s => An(s, this.options)).filter(this.options.loose ? s => !!s.match(o) : () => !0).map(s => new D(s, this.options));\n    }\n    intersects(t, e) {\n      if (!(t instanceof L)) throw new TypeError(\"a Range is required\");\n      return this.set.some(r => rt(r, e) && t.set.some(o => rt(o, e) && r.every(s => o.every(a => s.intersects(a, e)))));\n    }\n    test(t) {\n      if (!t) return !1;\n      if (typeof t == \"string\") try {\n        t = new E(t, this.options);\n      } catch (e) {\n        return !1;\n      }\n      for (let e = 0; e < this.set.length; e++) if (Ln(this.set[e], t, this.options)) return !0;\n      return !1;\n    }\n  },\n  {\n    re: T,\n    t: g,\n    comparatorTrimReplace: vn,\n    tildeTrimReplace: Tn,\n    caretTrimReplace: In\n  } = ne,\n  rt = (n, t) => {\n    let e = !0,\n      r = n.slice(),\n      o = r.pop();\n    for (; e && r.length;) e = r.every(s => o.intersects(s, t)), o = r.pop();\n    return e;\n  },\n  bn = (n, t) => (f(\"comp\", n, t), n = Mn(n, t), f(\"caret\", n), n = wn(n, t), f(\"tildes\", n), n = Nn(n, t), f(\"xrange\", n), n = Cn(n, t), f(\"stars\", n), n),\n  b = n => !n || n.toLowerCase() === \"x\" || n === \"*\",\n  wn = (n, t) => n.trim().split(/\\s+/).map(e => Pn(e, t)).join(\" \"),\n  Pn = (n, t) => {\n    let e = t.loose ? T[g.TILDELOOSE] : T[g.TILDE];\n    return n.replace(e, (r, o, s, a, i) => {\n      let c;\n      return f(\"tilde\", n, r, o, s, a, i), b(o) ? c = \"\" : b(s) ? c = `>=${o}.0.0 <${+o + 1}.0.0-0` : b(a) ? c = `>=${o}.${s}.0 <${o}.${+s + 1}.0-0` : i ? (f(\"replaceTilde pr\", i), c = `>=${o}.${s}.${a}-${i} <${o}.${+s + 1}.0-0`) : c = `>=${o}.${s}.${a} <${o}.${+s + 1}.0-0`, f(\"tilde return\", c), c;\n    });\n  },\n  Mn = (n, t) => n.trim().split(/\\s+/).map(e => xn(e, t)).join(\" \"),\n  xn = (n, t) => {\n    f(\"caret\", n, t);\n    let e = t.loose ? T[g.CARETLOOSE] : T[g.CARET],\n      r = t.includePrerelease ? \"-0\" : \"\";\n    return n.replace(e, (o, s, a, i, c) => {\n      let u;\n      return f(\"caret\", n, o, s, a, i, c), b(s) ? u = \"\" : b(a) ? u = `>=${s}.0.0${r} <${+s + 1}.0.0-0` : b(i) ? u = s === \"0\" ? `>=${s}.${a}.0${r} <${s}.${+a + 1}.0-0` : `>=${s}.${a}.0${r} <${+s + 1}.0.0-0` : c ? (f(\"replaceCaret pr\", c), u = s === \"0\" ? a === \"0\" ? `>=${s}.${a}.${i}-${c} <${s}.${a}.${+i + 1}-0` : `>=${s}.${a}.${i}-${c} <${s}.${+a + 1}.0-0` : `>=${s}.${a}.${i}-${c} <${+s + 1}.0.0-0`) : (f(\"no pr\"), u = s === \"0\" ? a === \"0\" ? `>=${s}.${a}.${i}${r} <${s}.${a}.${+i + 1}-0` : `>=${s}.${a}.${i}${r} <${s}.${+a + 1}.0-0` : `>=${s}.${a}.${i} <${+s + 1}.0.0-0`), f(\"caret return\", u), u;\n    });\n  },\n  Nn = (n, t) => (f(\"replaceXRanges\", n, t), n.split(/\\s+/).map(e => $n(e, t)).join(\" \")),\n  $n = (n, t) => {\n    n = n.trim();\n    let e = t.loose ? T[g.XRANGELOOSE] : T[g.XRANGE];\n    return n.replace(e, (r, o, s, a, i, c) => {\n      f(\"xRange\", n, r, o, s, a, i, c);\n      let u = b(s),\n        l = u || b(a),\n        p = l || b(i),\n        x = p;\n      return o === \"=\" && x && (o = \"\"), c = t.includePrerelease ? \"-0\" : \"\", u ? r = o === \">\" || o === \"<\" ? \"<0.0.0-0\" : \"*\" : o && x ? (l && (a = 0), i = 0, o === \">\" ? (o = \">=\", l ? (s = +s + 1, a = 0, i = 0) : (a = +a + 1, i = 0)) : o === \"<=\" && (o = \"<\", l ? s = +s + 1 : a = +a + 1), o === \"<\" && (c = \"-0\"), r = `${o + s}.${a}.${i}${c}`) : l ? r = `>=${s}.0.0${c} <${+s + 1}.0.0-0` : p && (r = `>=${s}.${a}.0${c} <${s}.${+a + 1}.0-0`), f(\"xRange return\", r), r;\n    });\n  },\n  Cn = (n, t) => (f(\"replaceStars\", n, t), n.trim().replace(T[g.STAR], \"\")),\n  An = (n, t) => (f(\"replaceGTE0\", n, t), n.trim().replace(T[t.includePrerelease ? g.GTE0PRE : g.GTE0], \"\")),\n  Sn = n => (t, e, r, o, s, a, i, c, u, l, p, x, v) => `${e = b(r) ? \"\" : b(o) ? `>=${r}.0.0${n ? \"-0\" : \"\"}` : b(s) ? `>=${r}.${o}.0${n ? \"-0\" : \"\"}` : a ? `>=${e}` : `>=${e}${n ? \"-0\" : \"\"}`} ${c = b(u) ? \"\" : b(l) ? `<${+u + 1}.0.0-0` : b(p) ? `<${u}.${+l + 1}.0-0` : x ? `<=${u}.${l}.${p}-${x}` : n ? `<${u}.${l}.${+p + 1}-0` : `<=${c}`}`.trim(),\n  Ln = (n, t, e) => {\n    for (let r = 0; r < n.length; r++) if (!n[r].test(t)) return !1;\n    if (t.prerelease.length && !e.includePrerelease) {\n      for (let r = 0; r < n.length; r++) if (f(n[r].semver), n[r].semver !== D.ANY && n[r].semver.prerelease.length > 0) {\n        let o = n[r].semver;\n        if (o.major === t.major && o.minor === t.minor && o.patch === t.patch) return !0;\n      }\n      return !1;\n    }\n    return !0;\n  },\n  at = (n, t, e) => {\n    try {\n      t = new L(t, e);\n    } catch (r) {\n      return !1;\n    }\n    return t.test(n);\n  };\nvar {\n    MAX_LENGTH: On\n  } = Ae,\n  {\n    re: st,\n    t: ot\n  } = ne,\n  _n = (n, t) => {\n    if (t && typeof t == \"object\" || (t = {\n      loose: !!t,\n      includePrerelease: !1\n    }), n instanceof E) return n;\n    if (typeof n != \"string\" || n.length > On || !(t.loose ? st[ot.LOOSE] : st[ot.FULL]).test(n)) return null;\n    try {\n      return new E(n, t);\n    } catch (e) {\n      return null;\n    }\n  },\n  kn = _n,\n  {\n    re: pe,\n    t: he\n  } = ne,\n  ct = (n, t) => {\n    if (n instanceof E) return n;\n    if (typeof n == \"number\" && (n = String(n)), typeof n != \"string\") return null;\n    let e = null;\n    if ((t = t || {}).rtl) {\n      let r;\n      for (; (r = pe[he.COERCERTL].exec(n)) && (!e || e.index + e[0].length !== n.length);) e && r.index + r[0].length === e.index + e[0].length || (e = r), pe[he.COERCERTL].lastIndex = r.index + r[1].length + r[2].length;\n      pe[he.COERCERTL].lastIndex = -1;\n    } else e = n.match(pe[he.COERCE]);\n    return e === null ? null : kn(`${e[2]}.${e[3] || \"0\"}.${e[4] || \"0\"}`, t);\n  };\nfunction qn(n) {\n  return String.fromCharCode(parseInt(n.slice(1), 16));\n}\nfunction Dn(n) {\n  return `%${`00${n.charCodeAt(0).toString(16)}`.slice(-2)}`;\n}\nfunction Wn(n) {\n  return btoa(encodeURIComponent(n).replace(/%[0-9A-F]{2}/g, qn));\n}\nfunction Un(n) {\n  return decodeURIComponent(Array.from(atob(n), Dn).join(\"\"));\n}\nfunction me(n) {\n  return Wn(JSON.stringify(n));\n}\nfunction lt(n) {\n  return JSON.parse(Un(n));\n}\nimport { RPCErrorCode as jn, SDKErrorCode as X, SDKWarningCode as Ee } from \"@magic-sdk/types\";\nimport { MagicPayloadMethod as Fn, RPCErrorCode as Jn } from \"@magic-sdk/types\";\nfunction O(n) {\n  return typeof n == \"undefined\";\n}\nfunction Gn(n) {\n  return n === null;\n}\nfunction fe(n) {\n  return Gn(n) || O(n);\n}\nfunction $r(n) {\n  return fe(n) ? !1 : !O(n.jsonrpc) && !O(n.id) && !O(n.method) && !O(n.params);\n}\nfunction ut(n) {\n  return fe(n) ? !1 : !O(n.jsonrpc) && !O(n.id) && (!O(n.result) || !O(n.error));\n}\nfunction Cr(n) {\n  return fe(n) ? !1 : typeof n == \"string\" && Object.values(Fn).includes(n);\n}\nfunction dt(n) {\n  return fe(n) ? !1 : typeof n == \"number\" && Object.values(Jn).includes(n);\n}\nfunction re(n) {\n  if (!n) return !0;\n  for (let t in n) if (Object.hasOwnProperty.call(n, t)) return !1;\n  return !0;\n}\nvar h = {};\nfunction Kn(n, t) {\n  return Object.assign(h, t), n;\n}\nvar pt = {\n  \"magic-sdk\": \"magic-sdk\",\n  \"@magic-sdk/react-native\": \"magic-sdk-rn\",\n  \"@magic-sdk/react-native-bare\": \"magic-sdk-rn-bare\",\n  \"@magic-sdk/react-native-expo\": \"magic-sdk-rn-expo\"\n};\nvar A = class extends Error {\n    constructor(e, r) {\n      super(`Magic SDK Error: [${e}] ${r}`);\n      this.code = e;\n      this.rawMessage = r;\n      this.__proto__ = Error;\n      Object.setPrototypeOf(this, A.prototype);\n    }\n  },\n  _ = class extends Error {\n    constructor(e) {\n      super();\n      this.__proto__ = Error;\n      let r = Number(e == null ? void 0 : e.code);\n      this.rawMessage = (e == null ? void 0 : e.message) || \"Internal error\", this.code = dt(r) ? r : jn.InternalError, this.message = `Magic RPC Error: [${this.code}] ${this.rawMessage}`, this.data = (e == null ? void 0 : e.data) || void 0, Object.setPrototypeOf(this, _.prototype);\n    }\n  },\n  W = class {\n    constructor(t, e) {\n      this.code = t;\n      this.rawMessage = e;\n      this.message = `Magic SDK Warning: [${t}] ${e}`;\n    }\n    log() {\n      console.warn(this.message);\n    }\n  },\n  V = class extends Error {\n    constructor(e, r, o, s) {\n      super(`Magic Extension Error (${e.name}): [${r}] ${o}`);\n      this.code = r;\n      this.rawMessage = o;\n      this.data = s;\n      this.__proto__ = Error;\n      Object.setPrototypeOf(this, V.prototype);\n    }\n  },\n  se = class {\n    constructor(t, e, r) {\n      this.code = e;\n      this.rawMessage = r;\n      this.message = `Magic Extension Warning (${t.name}): [${e}] ${r}`;\n    }\n    log() {\n      console.warn(this.message);\n    }\n  };\nfunction ht() {\n  return new A(X.MissingApiKey, \"Please provide an API key that you acquired from the Magic developer dashboard.\");\n}\nfunction mt() {\n  return new A(X.ModalNotReady, \"Modal is not ready.\");\n}\nfunction ft() {\n  return new A(X.MalformedResponse, \"Response from the Magic iframe is malformed.\");\n}\nfunction Et(n) {\n  return new A(X.ExtensionNotInitialized, `Extensions must be initialized with a Magic SDK instance before \\`Extension.${n}\\` can be accessed. Do not invoke \\`Extension.${n}\\` inside an extension constructor.`);\n}\nfunction yt(n) {\n  let t = `Some extensions are incompatible with \\`${h.sdkName}@${h.version}\\`:`;\n  return n.filter(e => typeof e.compat != \"undefined\" && e.compat !== null).forEach(e => {\n    let r = e.compat[h.sdkName];\n    typeof r == \"string\" ? t += `\n  - Extension \\`${e.name}\\` supports version(s) \\`${r}\\`` : r || (t += `\n  - Extension \\`${e.name}\\` does not support ${h.platform} environments.`);\n  }), new A(X.IncompatibleExtensions, t);\n}\nfunction gt(n) {\n  let t = e => {\n    let r = e + 1,\n      o = r % 10,\n      s = r % 100;\n    return o === 1 && s !== 11 ? `${r}st` : o === 2 && s !== 12 ? `${r}nd` : o === 3 && s !== 13 ? `${r}rd` : `${r}th`;\n  };\n  return new A(X.InvalidArgument, `Invalid ${t(n.argument)} argument given to \\`${n.procedure}\\`.\n  Expected: \\`${n.expected}\\`\n  Received: \\`${n.received}\\``);\n}\nfunction qr() {\n  return new W(Ee.DuplicateIframe, \"Duplicate iframes found.\");\n}\nfunction Rt() {\n  return new W(Ee.SyncWeb3Method, \"Non-async web3 methods are deprecated in web3 > 1.0 and are not supported by the Magic web3 provider. Please use an async method instead.\");\n}\nfunction vt() {\n  return new W(Ee.ReactNativeEndpointConfiguration, `CUSTOM DOMAINS ARE NOT SUPPORTED WHEN USING MAGIC SDK WITH REACT NATIVE! The \\`endpoint\\` parameter SHOULD NOT be provided. The Magic \\`<iframe>\\` is automatically wrapped by a WebView pointed at \\`${h.defaultEndpoint}\\`. Changing this default behavior will lead to unexpected results and potentially security-threatening bugs.`);\n}\nfunction U(n) {\n  let {\n      method: t,\n      removalVersions: e,\n      useInstead: r\n    } = n,\n    o = e[h.sdkName],\n    s = r ? ` Use \\`${r}\\` instead.` : \"\",\n    a = `\\`${t}\\` will be removed from \\`${h.sdkName}\\` in version \\`${o}\\`.${s}`;\n  return new W(Ee.DeprecationNotice, a);\n}\nimport { MagicPayloadMethod as C, DeviceVerificationEventEmit as $t, LoginWithEmailOTPEventEmit as Re, UpdateEmailEventEmit as z, RecencyCheckEventEmit as Y } from \"@magic-sdk/types\";\nimport { MagicOutgoingWindowMessage as Yn, MagicIncomingWindowMessage as Zn, MagicPayloadMethod as Qn } from \"@magic-sdk/types\";\nfunction* Bn() {\n  let n = 0;\n  for (;;) n < Number.MAX_SAFE_INTEGER ? yield ++n : n = 0;\n}\nvar Hn = Bn();\nfunction Se() {\n  return Hn.next().value;\n}\nvar Tt = Symbol(\"Payload pre-processed by Magic SDK\");\nfunction It(n) {\n  return Object.defineProperty(n, Tt, {\n    value: !0,\n    enumerable: !1\n  }), n;\n}\nfunction Vn(n) {\n  return !!n[Tt];\n}\nfunction G(n) {\n  var t, e, r;\n  return Vn(n) || (n.jsonrpc = (t = n.jsonrpc) != null ? t : \"2.0\", n.id = Se(), n.method = (e = n.method) != null ? e : \"noop\", n.params = (r = n.params) != null ? r : [], It(n)), n;\n}\nfunction d(n, t = []) {\n  return It({\n    params: t,\n    method: n,\n    jsonrpc: \"2.0\",\n    id: Se()\n  });\n}\nvar F = class {\n  constructor(t) {\n    t instanceof F ? (this._jsonrpc = t.payload.jsonrpc, this._id = t.payload.id, this._result = t.payload.result, this._error = t.payload.error) : ut(t) ? (this._jsonrpc = t.jsonrpc, this._id = t.id, this._result = t.result, this._error = t.error) : (this._jsonrpc = t.jsonrpc, this._id = t.id, this._result = void 0, this._error = void 0);\n  }\n  applyError(t) {\n    return this._error = t, this;\n  }\n  applyResult(t) {\n    return this._result = t, this;\n  }\n  get hasError() {\n    return typeof this._error != \"undefined\" && this._error !== null;\n  }\n  get hasResult() {\n    return typeof this._result != \"undefined\";\n  }\n  get payload() {\n    return {\n      jsonrpc: this._jsonrpc,\n      id: this._id,\n      result: this._result,\n      error: this._error\n    };\n  }\n};\nvar Pt = Qt(wt()),\n  Oe = class extends Pt.default {};\nfunction ge() {\n  let n = new Oe();\n  return {\n    emitter: n,\n    createChainingEmitterMethod: (r, o) => (...s) => (n[r].apply(n, s), o),\n    createBoundEmitterMethod: r => (...o) => n[r].apply(n, o)\n  };\n}\nvar Mt = Symbol(\"isPromiEvent\");\nfunction xt(n) {\n  return !!n[Mt];\n}\nfunction k(n) {\n  let t = _e(n),\n    {\n      createBoundEmitterMethod: e,\n      createChainingEmitterMethod: r\n    } = ge(),\n    o = Symbol(\"Promise.then\"),\n    s = Symbol(\"Promise.catch\"),\n    a = Symbol(\"Promise.finally\"),\n    i = (l, p) => (...x) => {\n      let v = p[l].apply(p, x);\n      return c(v);\n    },\n    c = l => Object.assign(l, {\n      [Mt]: !0,\n      [o]: l[o] || l.then,\n      [s]: l[s] || l.catch,\n      [a]: l[a] || l.finally,\n      then: i(o, l),\n      catch: i(s, l),\n      finally: i(a, l),\n      on: r(\"on\", l),\n      once: r(\"once\", l),\n      addListener: r(\"addListener\", l),\n      off: r(\"off\", l),\n      removeListener: r(\"removeListener\", l),\n      removeAllListeners: r(\"removeAllListeners\", l),\n      emit: e(\"emit\"),\n      eventNames: e(\"eventNames\"),\n      listeners: e(\"listeners\"),\n      listenerCount: e(\"listenerCount\")\n    }),\n    u = c(t.then(l => (u.emit(\"done\", l), u.emit(\"settled\"), l), l => {\n      throw u.emit(\"error\", l), u.emit(\"settled\"), l;\n    }));\n  return u;\n}\nfunction _e(n) {\n  return new Promise((t, e) => {\n    let r = n(t, e);\n    Promise.resolve(r).catch(e);\n  });\n}\nvar P = class {\n  constructor(t) {\n    this.sdk = t;\n  }\n  get overlay() {\n    return this.sdk.overlay;\n  }\n  request(t) {\n    let e = this.overlay.post(Yn.MAGIC_HANDLE_REQUEST, G(t)),\n      r = k((s, a) => {\n        e.then(i => {\n          if (o(), i.hasError) a(new _(i.payload.error));else if (i.hasResult) s(i.payload.result);else throw ft();\n        }).catch(i => {\n          o(), a(i);\n        });\n      }),\n      o = this.overlay.on(Zn.MAGIC_HANDLE_EVENT, s => {\n        var i;\n        let {\n          response: a\n        } = s.data;\n        if (a.id === t.id && ((i = a.result) == null ? void 0 : i.event)) {\n          let {\n            event: c,\n            params: u = []\n          } = a.result;\n          r.emit(c, ...u);\n        }\n      });\n    return r;\n  }\n  createIntermediaryEvent(t, e) {\n    return o => {\n      let s = d(Qn.IntermediaryEvent, [{\n        payloadId: e,\n        eventType: t,\n        args: o\n      }]);\n      this.request(s);\n    };\n  }\n};\nfunction Nt(n, t) {\n  let [e] = n.split(\".\").map(Number);\n  return e >= t;\n}\nvar K = {\n    \"magic-sdk\": \"v18.0.0\",\n    \"@magic-sdk/react-native\": \"v14.0.0\",\n    \"@magic-sdk/react-native-bare\": \"v19.0.0\",\n    \"@magic-sdk/react-native-expo\": \"v19.0.0\"\n  },\n  ve = class extends P {\n    loginWithMagicLink(t) {\n      let e = h.sdkName === \"@magic-sdk/react-native\" || h.sdkName === \"@magic-sdk/react-native-bare\" || h.sdkName === \"@magic-sdk/react-native-expo\";\n      if (e && Nt(h.version, 19)) throw new Error(\"loginWithMagicLink() is deprecated for this package, please utlize a passcode method like loginWithSMS or loginWithEmailOTP instead.\");\n      e && U({\n        method: \"auth.loginWithMagicLink()\",\n        removalVersions: K,\n        useInstead: \"auth.loginWithEmailOTP()\"\n      }).log();\n      let {\n          email: r,\n          showUI: o = !0,\n          redirectURI: s,\n          overrides: a\n        } = t,\n        i = d(this.sdk.testMode ? C.LoginWithMagicLinkTestMode : C.LoginWithMagicLink, [{\n          email: r,\n          showUI: o,\n          redirectURI: s,\n          overrides: a\n        }]);\n      return this.request(i);\n    }\n    loginWithSMS(t) {\n      let {\n          phoneNumber: e\n        } = t,\n        r = d(this.sdk.testMode ? C.LoginWithSmsTestMode : C.LoginWithSms, [{\n          phoneNumber: e,\n          showUI: !0\n        }]);\n      return this.request(r);\n    }\n    loginWithEmailOTP(t) {\n      let {\n          email: e,\n          showUI: r,\n          deviceCheckUI: o,\n          overrides: s\n        } = t,\n        a = d(this.sdk.testMode ? C.LoginWithEmailOTPTestMode : C.LoginWithEmailOTP, [{\n          email: e,\n          showUI: r,\n          deviceCheckUI: o,\n          overrides: s\n        }]),\n        i = this.request(a);\n      return !o && i && i.on($t.Retry, () => {\n        this.createIntermediaryEvent($t.Retry, a.id)();\n      }), !r && i && (i.on(Re.VerifyEmailOtp, c => {\n        this.createIntermediaryEvent(Re.VerifyEmailOtp, a.id)(c);\n      }), i.on(Re.Cancel, () => {\n        this.createIntermediaryEvent(Re.Cancel, a.id)();\n      })), i;\n    }\n    loginWithCredential(t) {\n      let e = t != null ? t : \"\";\n      if (!t && h.platform === \"web\") {\n        e = window.location.search;\n        let o = window.location.origin + window.location.pathname;\n        window.history.replaceState(null, \"\", o);\n      }\n      let r = d(this.sdk.testMode ? C.LoginWithCredentialTestMode : C.LoginWithCredential, [e]);\n      return this.request(r);\n    }\n    setAuthorizationToken(t) {\n      let e = d(C.SetAuthorizationToken, [{\n        jwt: t\n      }]);\n      return this.request(e);\n    }\n    updateEmailWithUI(t) {\n      let {\n          email: e,\n          showUI: r = !0\n        } = t,\n        o = d(this.sdk.testMode ? C.UpdateEmailTestMode : C.UpdateEmail, [{\n          email: e,\n          showUI: r\n        }]),\n        s = this.request(o);\n      return r || (s.on(Y.Retry, () => {\n        this.createIntermediaryEvent(Y.Retry, o.id)();\n      }), s.on(Y.Cancel, () => {\n        this.createIntermediaryEvent(Y.Cancel, o.id)();\n      }), s.on(Y.VerifyEmailOtp, a => {\n        this.createIntermediaryEvent(Y.VerifyEmailOtp, o.id)(a);\n      }), s.on(z.RetryWithNewEmail, a => {\n        this.createIntermediaryEvent(z.RetryWithNewEmail, o.id)(a);\n      }), s.on(z.Cancel, () => {\n        this.createIntermediaryEvent(z.Cancel, o.id)();\n      }), s.on(z.VerifyEmailOtp, a => {\n        this.createIntermediaryEvent(z.VerifyEmailOtp, o.id)(a);\n      })), s;\n    }\n  };\nimport { MagicPayloadMethod as R } from \"@magic-sdk/types\";\nvar ie = {};\nYt(ie, {\n  clear: () => er,\n  getItem: () => y,\n  iterate: () => ke,\n  key: () => nr,\n  keys: () => rr,\n  length: () => tr,\n  removeItem: () => N,\n  setItem: () => M\n});\nvar Te;\nfunction J(n) {\n  return (...t) => m(this, null, function* () {\n    return Te || (Te = yield h.configureStorage()), yield Te.ready(), Te[n](...t);\n  });\n}\nvar y = J(\"getItem\"),\n  M = J(\"setItem\"),\n  N = J(\"removeItem\"),\n  er = J(\"clear\"),\n  tr = J(\"length\"),\n  nr = J(\"key\"),\n  rr = J(\"keys\"),\n  ke = J(\"iterate\");\nfunction Ct() {\n  let n = window.crypto.getRandomValues(new Uint8Array(16));\n  n[6] = n[6] & 15 | 64, n[8] = n[8] & 191 | 128;\n  let t = \"\";\n  return t += n[0].toString(16), t += n[1].toString(16), t += n[2].toString(16), t += n[3].toString(16), t += \"-\", t += n[4].toString(16), t += n[5].toString(16), t += \"-\", t += n[6].toString(16), t += n[7].toString(16), t += \"-\", t += n[8].toString(16), t += n[9].toString(16), t += \"-\", t += n[10].toString(16), t += n[11].toString(16), t += n[12].toString(16), t += n[13].toString(16), t += n[14].toString(16), t += n[15].toString(16), t;\n}\nvar qe = \"STORE_KEY_PRIVATE_KEY\",\n  Ie = \"STORE_KEY_PUBLIC_JWK\",\n  St = \"ECDSA\",\n  sr = \"P-256\",\n  or = {\n    name: St,\n    namedCurve: sr\n  };\nfunction ae() {\n  let n = typeof window != \"undefined\" && !!window.crypto,\n    t = n && !!window.crypto.subtle;\n  return n && t;\n}\nfunction Ts() {\n  N(Ie), N(qe);\n}\nfunction Lt() {\n  return m(this, null, function* () {\n    let n = yield ir();\n    if (!n) {\n      console.info(\"unable to create public key or webcrypto is unsupported\");\n      return;\n    }\n    let {\n        subtle: t\n      } = window.crypto,\n      e = yield y(qe);\n    if (!e || !t) {\n      console.info(\"unable to find private key or webcrypto unsupported\");\n      return;\n    }\n    let r = {\n        iat: Math.floor(new Date().getTime() / 1e3),\n        jti: Ct()\n      },\n      o = {\n        typ: \"dpop+jwt\",\n        alg: \"ES256\",\n        jwk: n\n      },\n      s = {\n        protected: At(JSON.stringify(o)),\n        claims: At(JSON.stringify(r))\n      },\n      a = cr(`${s.protected}.${s.claims}`),\n      i = {\n        name: St,\n        hash: {\n          name: \"SHA-256\"\n        }\n      },\n      c = ur(new Uint8Array(yield t.sign(i, e, a)));\n    return `${s.protected}.${s.claims}.${c}`;\n  });\n}\nfunction ir() {\n  return m(this, null, function* () {\n    if (!ae()) {\n      console.info(\"webcrypto is not supported\");\n      return;\n    }\n    return (yield y(Ie)) || (yield ar()), y(Ie);\n  });\n}\nfunction ar() {\n  return m(this, null, function* () {\n    let {\n        subtle: n\n      } = window.crypto,\n      t = yield n.generateKey(or, !1, [\"sign\"]),\n      e = yield n.exportKey(\"jwk\", t.publicKey);\n    yield M(qe, t.privateKey), yield M(Ie, e);\n  });\n}\nfunction At(n) {\n  return Ot(lr(n));\n}\nfunction cr(n) {\n  return new TextEncoder().encode(n);\n}\nfunction Ot(n) {\n  return btoa(n).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+/g, \"\");\n}\nfunction lr(n) {\n  return encodeURIComponent(n).replace(/%([0-9A-F]{2})/g, (e, r) => String.fromCharCode(parseInt(r, 16)));\n}\nfunction ur(n) {\n  let t = \"\";\n  return n.forEach(e => {\n    t += String.fromCharCode(e);\n  }), Ot(t);\n}\nvar De = \"ds\",\n  We = \"ek\",\n  Ue = \"iv\",\n  Fe = \"AES-GCM\",\n  dr = 256;\nfunction Z() {\n  return m(this, null, function* () {\n    let n = [];\n    yield ke((t, e, r) => {\n      e.startsWith(`${De}_`) && n.push(e);\n    });\n    for (let t of n) yield N(t);\n  });\n}\nfunction _t(n) {\n  let t = \"\",\n    e = new Uint8Array(n),\n    r = e.byteLength;\n  for (let o = 0; o < r; o++) t += String.fromCharCode(e[o]);\n  return window.btoa(t);\n}\nfunction kt(n) {\n  let t = window.atob(n),\n    e = t.length,\n    r = new Uint8Array(e);\n  for (let o = 0; o < e; o++) r[o] = t.charCodeAt(o);\n  return r.buffer;\n}\nfunction pr() {\n  return m(this, null, function* () {\n    if (!ae()) {\n      console.info(\"webcrypto is not supported\");\n      return;\n    }\n    let {\n        crypto: n\n      } = window,\n      t = yield y(Ue);\n    return t || n.getRandomValues(new Uint8Array(12));\n  });\n}\nfunction hr() {\n  return m(this, null, function* () {\n    if (!ae()) {\n      console.info(\"webcrypto is not supported\");\n      return;\n    }\n    let {\n        subtle: n\n      } = window.crypto,\n      t = yield y(We);\n    return t || (yield n.generateKey({\n      name: Fe,\n      length: dr\n    }, !1, [\"encrypt\", \"decrypt\"]));\n  });\n}\nfunction qt(n, t) {\n  return m(this, null, function* () {\n    let e = yield pr(),\n      r = yield hr();\n    if (!e || !r || !n) return;\n    let o = kt(n),\n      {\n        subtle: s\n      } = window.crypto,\n      a = yield s.encrypt({\n        name: Fe,\n        iv: e\n      }, r, o),\n      i = _t(a);\n    yield M(`${De}_${t}`, i), yield M(We, r), yield M(Ue, e);\n  });\n}\nfunction Dt(n) {\n  return m(this, null, function* () {\n    let t = yield y(`${De}_${n}`),\n      e = yield y(Ue),\n      r = yield y(We);\n    if (!e || !t || !r || !ae()) return;\n    let {\n        subtle: o\n      } = window.crypto,\n      s = yield o.decrypt({\n        name: Fe,\n        iv: e\n      }, r, kt(t));\n    return _t(s);\n  });\n}\nfunction Je(n, t) {\n  return t ? new URL(n, t) : new URL(n);\n}\nvar be = class extends P {\n  constructor() {\n    super(...arguments);\n    this.localForageKey = \"mc_active_wallet\";\n    this.localForageIsLoggedInKey = \"magic_auth_is_logged_in\";\n    this.userLoggedOutCallbacks = [];\n  }\n  getIdToken(e) {\n    let r = d(this.sdk.testMode ? R.GetIdTokenTestMode : R.GetIdToken, [e]);\n    return this.request(r);\n  }\n  generateIdToken(e) {\n    let r = d(this.sdk.testMode ? R.GenerateIdTokenTestMode : R.GenerateIdToken, [e]);\n    return this.request(r);\n  }\n  getInfo() {\n    return m(this, null, function* () {\n      let e = yield y(this.localForageKey),\n        r = d(R.GetInfo, [{\n          walletType: e\n        }]);\n      return this.request(r);\n    });\n  }\n  isLoggedIn() {\n    return k((e, r) => m(this, null, function* () {\n      try {\n        let o = !1;\n        this.sdk.useStorageCache && (o = (yield y(this.localForageIsLoggedInKey)) === \"true\", o && e(!0));\n        let s = d(this.sdk.testMode ? R.IsLoggedInTestMode : R.IsLoggedIn),\n          a = yield this.request(s);\n        this.sdk.useStorageCache && (a ? M(this.localForageIsLoggedInKey, !0) : N(this.localForageIsLoggedInKey), o && !a && this.emitUserLoggedOut(!0)), e(a);\n      } catch (o) {\n        r(o);\n      }\n    }));\n  }\n  logout() {\n    return N(this.localForageKey), N(this.localForageIsLoggedInKey), Z(), k((e, r) => m(this, null, function* () {\n      try {\n        let o = d(this.sdk.testMode ? R.LogoutTestMode : R.Logout),\n          s = yield this.request(o);\n        this.sdk.useStorageCache && this.emitUserLoggedOut(s), e(s);\n      } catch (o) {\n        r(o);\n      }\n    }));\n  }\n  requestInfoWithUI(e) {\n    let r = d(R.RequestUserInfoWithUI, e ? [e] : []);\n    return this.request(r);\n  }\n  showSettings(e) {\n    let r = d(this.sdk.testMode ? R.UserSettingsTestMode : R.UserSettings, [e]);\n    return this.request(r);\n  }\n  recoverAccount(e) {\n    let r = d(this.sdk.testMode ? R.RecoverAccountTestMode : R.RecoverAccount, [e]);\n    return this.request(r);\n  }\n  revealPrivateKey() {\n    let e = d(R.RevealPK);\n    return this.request(e);\n  }\n  getMetadata() {\n    U({\n      method: \"user.getMetadata()\",\n      removalVersions: K,\n      useInstead: \"user.getInfo()\"\n    }).log();\n    let e = d(this.sdk.testMode ? R.GetMetadataTestMode : R.GetMetadata);\n    return this.request(e);\n  }\n  onUserLoggedOut(e) {\n    this.userLoggedOutCallbacks.push(e);\n  }\n  emitUserLoggedOut(e) {\n    this.userLoggedOutCallbacks.forEach(r => {\n      r(e);\n    });\n  }\n};\nimport { Events as Ge, MagicPayloadMethod as $, Wallets as S } from \"@magic-sdk/types\";\nvar we = class extends P {\n  constructor() {\n    super(...arguments);\n    this.localForageKey = \"mc_active_wallet\";\n  }\n  connectWithUI() {\n    let e = k((r, o) => m(this, null, function* () {\n      try {\n        if (this.isMetaMaskBrowser() && (yield this.isWalletEnabled(S.MetaMask))) {\n          let u = yield this.autoConnectIfWalletBrowser(S.MetaMask);\n          r(u);\n          return;\n        }\n        if (this.isCoinbaseWalletBrowser() && (yield this.isWalletEnabled(S.CoinbaseWallet))) {\n          let u = yield this.autoConnectIfWalletBrowser(S.CoinbaseWallet);\n          r(u);\n          return;\n        }\n        let s = this.getUserEnv(),\n          a = d($.Login, [s]),\n          i = this.request(a);\n        i.on(Ge.WalletSelected, u => this.handleWalletSelected(B(j({}, u), {\n          payloadId: a.id\n        }))), i.on(\"id-token-created\", u => {\n          e.emit(\"id-token-created\", u);\n        });\n        let c = yield i;\n        c.error && o(c), r(c);\n      } catch (s) {\n        o(s);\n      }\n    }));\n    return e;\n  }\n  showUI(e) {\n    return this.request(d($.ShowUI, [e]));\n  }\n  showAddress() {\n    return this.request(d($.ShowAddress));\n  }\n  showSendTokensUI() {\n    return this.request(d($.ShowSendTokensUI));\n  }\n  showOnRamp() {\n    return this.request(d($.ShowOnRamp));\n  }\n  showNFTs() {\n    return this.request(d($.ShowNFTs));\n  }\n  showBalances() {\n    return this.request(d($.ShowBalances));\n  }\n  sendGaslessTransaction(e, r) {\n    return this.request(d($.SendGaslessTransaction, [e, r]));\n  }\n  getInfo() {\n    return m(this, null, function* () {\n      U({\n        method: \"wallet.getInfo()\",\n        removalVersions: K,\n        useInstead: \"user.getInfo()\"\n      }).log();\n      let e = yield y(this.localForageKey),\n        r = d($.GetInfo, [{\n          walletType: e\n        }]);\n      return this.request(r);\n    });\n  }\n  disconnect() {\n    U({\n      method: \"wallet.disconnect()\",\n      removalVersions: K,\n      useInstead: \"user.logout()\"\n    }).log(), N(this.localForageKey), Z();\n    let e = d($.Disconnect);\n    return this.request(e);\n  }\n  requestUserInfoWithUI(e) {\n    U({\n      method: \"wallet.requestUserInfoWithUI()\",\n      removalVersions: K,\n      useInstead: \"user.requestUserInfoWithUI()\"\n    }).log();\n    let r = d($.RequestUserInfoWithUI, e ? [e] : []);\n    return this.request(r);\n  }\n  getProvider() {\n    return m(this, null, function* () {\n      switch (yield y(this.localForageKey)) {\n        case S.MetaMask:\n          return this.getMetaMaskProvider();\n        case S.CoinbaseWallet:\n          return this.getCoinbaseProvider();\n        default:\n          return this.sdk.rpcProvider;\n      }\n    });\n  }\n  isMetaMaskInstalled() {\n    var e, r, o;\n    return ((e = window.ethereum) == null ? void 0 : e.isMetaMask) || !!((o = (r = window.ethereum) == null ? void 0 : r.providers) != null && o.find(s => s == null ? void 0 : s.isMetaMask));\n  }\n  isMetaMaskBrowser() {\n    return this.isMobile() && this.isMetaMaskInstalled();\n  }\n  getMetaMaskProvider() {\n    var e, r;\n    return ((r = (e = window.ethereum) == null ? void 0 : e.providers) == null ? void 0 : r.find(o => o == null ? void 0 : o.isMetaMask)) || window.ethereum;\n  }\n  connectToMetaMask() {\n    if (this.isMobile() && !this.isMetaMaskInstalled()) {\n      let e = `https://metamask.app.link/dapp/${window.location.href.replace(/(^\\w+:|^)\\/\\//, \"\")}`;\n      window.location.href = e;\n    }\n    return this.getMetaMaskProvider().request({\n      method: \"eth_requestAccounts\"\n    });\n  }\n  isCoinbaseWalletInstalled() {\n    var e, r, o;\n    return ((e = window.ethereum) == null ? void 0 : e.isCoinbaseWallet) || !!((o = (r = window.ethereum) == null ? void 0 : r.providers) != null && o.find(s => s == null ? void 0 : s.isCoinbaseWallet));\n  }\n  isCoinbaseWalletBrowser() {\n    var e;\n    return !!((e = window.ethereum) != null && e.isCoinbaseBrowser);\n  }\n  getCoinbaseProvider() {\n    var e, r;\n    return ((r = (e = window.ethereum) == null ? void 0 : e.providers) == null ? void 0 : r.find(o => o == null ? void 0 : o.isCoinbaseWallet)) || window.ethereum;\n  }\n  connectToCoinbaseWallet() {\n    if (this.isMobile() && !this.isCoinbaseWalletBrowser()) {\n      let r = `https://go.cb-w.com/dapp?cb_url=${encodeURIComponent(window.location.href)}`;\n      window.location.href = r;\n    }\n    return this.getCoinbaseProvider().request({\n      method: \"eth_requestAccounts\"\n    });\n  }\n  isMobile() {\n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Silk|Opera Mini/i.test(navigator.userAgent);\n  }\n  getUserEnv() {\n    return {\n      env: {\n        isMetaMaskInstalled: this.isMetaMaskInstalled(),\n        isCoinbaseWalletInstalled: this.isCoinbaseWalletInstalled()\n      }\n    };\n  }\n  connectToThirdPartyWallet(e) {\n    switch (e) {\n      case S.MetaMask:\n        return this.connectToMetaMask();\n      case S.CoinbaseWallet:\n        return this.connectToCoinbaseWallet();\n      default:\n        throw new Error(`Invalid provider: ${e}. Must be one of \"metamask\" or \"coinbase_wallet\".`);\n    }\n  }\n  isWalletEnabled(e) {\n    let r = d(\"mc_is_wallet_enabled\", [{\n      wallet: e\n    }]);\n    return this.request(r);\n  }\n  handleWalletSelected(e) {\n    return m(this, null, function* () {\n      try {\n        let r = yield this.connectToThirdPartyWallet(e.wallet);\n        yield M(this.localForageKey, e.wallet), this.createIntermediaryEvent(Ge.WalletConnected, e.payloadId)(r);\n      } catch (r) {\n        console.error(r), this.createIntermediaryEvent(Ge.WalletRejected, e.payloadId)();\n      }\n    });\n  }\n  autoConnectIfWalletBrowser(e) {\n    return m(this, null, function* () {\n      let r;\n      e === S.MetaMask && (r = yield this.getMetaMaskProvider().request({\n        method: \"eth_requestAccounts\"\n      })), e === S.CoinbaseWallet && (r = yield this.getCoinbaseProvider().request({\n        method: \"eth_requestAccounts\"\n      })), yield M(this.localForageKey, e);\n      let o = d($.AutoConnect, [{\n        wallet: e,\n        address: r\n      }]);\n      return this.request(o);\n    });\n  }\n};\nimport { MagicOutgoingWindowMessage as Wt, MagicPayloadMethod as mr } from \"@magic-sdk/types\";\nvar {\n    createBoundEmitterMethod: Pe,\n    createChainingEmitterMethod: Q\n  } = ge(),\n  Me = class extends P {\n    constructor() {\n      super(...arguments);\n      this.isMagic = !0;\n      this.on = Q(\"on\", this);\n      this.once = Q(\"once\", this);\n      this.addListener = Q(\"addListener\", this);\n      this.off = Q(\"off\", this);\n      this.removeListener = Q(\"removeListener\", this);\n      this.removeAllListeners = Q(\"removeAllListeners\", this);\n      this.emit = Pe(\"emit\");\n      this.eventNames = Pe(\"eventNames\");\n      this.listeners = Pe(\"listeners\");\n      this.listenerCount = Pe(\"listenerCount\");\n    }\n    sendAsync(e, r) {\n      if (!r) throw gt({\n        procedure: \"Magic.rpcProvider.sendAsync\",\n        argument: 1,\n        expected: \"function\",\n        received: r === null ? \"null\" : typeof r\n      });\n      if (Array.isArray(e)) this.overlay.post(Wt.MAGIC_HANDLE_REQUEST, e.map(o => {\n        let s = G(o);\n        return this.prefixPayloadMethodForTestMode(s), s;\n      })).then(o => {\n        r(null, o.map(s => B(j({}, s.payload), {\n          error: s.hasError ? new _(s.payload.error) : null\n        })));\n      });else {\n        let o = G(e);\n        this.prefixPayloadMethodForTestMode(o), this.overlay.post(Wt.MAGIC_HANDLE_REQUEST, o).then(s => {\n          r(s.hasError ? new _(s.payload.error) : null, s.payload);\n        });\n      }\n    }\n    send(e, r) {\n      if (typeof e == \"string\") {\n        let s = d(e, Array.isArray(r) ? r : []);\n        return this.request(s);\n      }\n      if (Array.isArray(e) || !!r) {\n        this.sendAsync(e, r);\n        return;\n      }\n      let o = Rt();\n      return o.log(), new F(e).applyError({\n        code: -32603,\n        message: o.rawMessage\n      }).payload;\n    }\n    enable() {\n      let e = d(mr.Login);\n      return this.request(e);\n    }\n    request(e) {\n      return this.prefixPayloadMethodForTestMode(e), super.request(e);\n    }\n    prefixPayloadMethodForTestMode(e) {\n      let r = \"testMode/eth/\";\n      this.sdk.testMode && (e.method = `${r}${e.method}`);\n    }\n  };\nvar Ut = [\"request\", \"overlay\", \"sdk\"];\nfunction fr(n) {\n  let t = Object.getPrototypeOf(n),\n    e = [t];\n  for (; t !== P.prototype;) t = Object.getPrototypeOf(t), e.push(t);\n  return e;\n}\nvar xe = class extends P {\n    constructor() {\n      super(void 0);\n      this.__sdk_access_field_descriptors__ = new Map();\n      this.__is_initialized__ = !1;\n      this.utils = {\n        createPromiEvent: k,\n        isPromiEvent: xt,\n        encodeJSON: me,\n        decodeJSON: lt,\n        createJsonRpcRequestPayload: d,\n        standardizeJsonRpcRequestPayload: G,\n        storage: ie\n      };\n      let e = [this, ...fr(this)];\n      Ut.forEach(r => {\n        let o = e.map(c => Object.getOwnPropertyDescriptor(c, r)),\n          s = o.findIndex(c => !!c),\n          a = s > 0,\n          i = o[s];\n        i && (this.__sdk_access_field_descriptors__.set(r, {\n          descriptor: i,\n          isPrototypeField: a\n        }), Object.defineProperty(this, r, {\n          configurable: !0,\n          get: () => {\n            throw Et(r);\n          }\n        }));\n      });\n    }\n    init(e) {\n      this.__is_initialized__ || (Ut.forEach(r => {\n        if (this.__sdk_access_field_descriptors__.has(r)) {\n          let {\n            descriptor: o,\n            isPrototypeField: s\n          } = this.__sdk_access_field_descriptors__.get(r);\n          s ? delete this[r] : Object.defineProperty(this, r, o);\n        }\n      }), this.sdk = e, this.__is_initialized__ = !0);\n    }\n    createDeprecationWarning(e) {\n      let {\n          method: r,\n          removalVersion: o,\n          useInstead: s\n        } = e,\n        a = s ? ` Use \\`${s}\\` instead.` : \"\",\n        i = `\\`${r}\\` will be removed from this Extension in version \\`${o}\\`.${a}`;\n      return new se(this, \"DEPRECATION_NOTICE\", i);\n    }\n    createWarning(e, r) {\n      return new se(this, e, r);\n    }\n    createError(e, r, o) {\n      return new V(this, e, r, o);\n    }\n  },\n  Ke = class extends xe {},\n  q = class extends xe {};\nq.Internal = Ke, q.Anonymous = \"anonymous extension\";\nimport { MagicPayloadMethod as je } from \"@magic-sdk/types\";\nvar Ne = class extends P {\n  purchase(t) {\n    let e = d(je.NFTPurchase, [t]);\n    return this.request(e);\n  }\n  checkout(t) {\n    let e = d(je.NFTCheckout, [t]);\n    return this.request(e);\n  }\n  transfer(t) {\n    let e = d(je.NFTTransfer, [t]);\n    return this.request(e);\n  }\n};\nfunction Ft(n) {\n  return n.compat && n.compat[h.sdkName] != null ? typeof n.compat[h.sdkName] == \"string\" ? at(ct(h.version), n.compat[h.sdkName]) : !!n.compat[h.sdkName] : !0;\n}\nfunction Er(n, t, e) {\n  return !t && !e ? `${n}_eth_mainnet` : e ? `${n}_${JSON.stringify(e)}` : t ? typeof t == \"string\" ? `${n}_eth_${t}` : `${n}_${t.rpcUrl}_${t.chainId}_${t.chainType}` : `${n}_unknown`;\n}\nfunction yr(n) {\n  var o;\n  let t = (o = n == null ? void 0 : n.extensions) != null ? o : [],\n    e = {},\n    r = [];\n  if (Array.isArray(t) ? t.forEach(s => {\n    Ft(s) ? (s.init(this), (s.name || s.name !== q.Anonymous) && (this[s.name] = s), s instanceof q.Internal && (re(s.config) || (e[s.name] = s.config))) : r.push(s);\n  }) : Object.keys(t).forEach(s => {\n    if (Ft(t[s])) {\n      t[s].init(this);\n      let a = t[s];\n      this[s] = a, a instanceof q.Internal && (re(a.config) || (e[t[s].name] = a.config));\n    } else r.push(t[s]);\n  }), r.length) throw yt(r);\n  return e;\n}\nvar ce = class {\n    constructor(t, e) {\n      this.apiKey = t;\n      var a;\n      if (!t) throw ht();\n      h.platform === \"react-native\" && (e == null ? void 0 : e.endpoint) && vt().log();\n      let {\n        defaultEndpoint: r,\n        version: o\n      } = h;\n      this.testMode = !!(e != null && e.testMode), this.useStorageCache = !!(e != null && e.useStorageCache), this.endpoint = Je((a = e == null ? void 0 : e.endpoint) != null ? a : r).origin, this.auth = new ve(this), this.user = new be(this), this.wallet = new we(this), this.nft = new Ne(this), this.rpcProvider = new Me(this);\n      let s = yr.call(this, e);\n      this.parameters = me(B(j({\n        API_KEY: this.apiKey,\n        DOMAIN_ORIGIN: window.location ? window.location.origin : \"\",\n        ETH_NETWORK: e == null ? void 0 : e.network,\n        host: Je(this.endpoint).host,\n        sdk: pt[h.sdkName],\n        version: o,\n        ext: re(s) ? void 0 : s,\n        locale: (e == null ? void 0 : e.locale) || \"en_US\"\n      }, h.bundleId ? {\n        bundleId: h.bundleId\n      } : {}), {\n        meta: e == null ? void 0 : e.meta\n      })), this.networkHash = Er(this.apiKey, e == null ? void 0 : e.network, re(s) ? void 0 : s), e != null && e.deferPreload || this.preload();\n    }\n    get overlay() {\n      if (!ce.__overlays__.has(this.parameters)) {\n        let t = new h.ViewController(this.endpoint, this.parameters, this.networkHash);\n        t.init(), ce.__overlays__.set(this.parameters, t);\n      }\n      return ce.__overlays__.get(this.parameters);\n    }\n    preload() {\n      return m(this, null, function* () {\n        yield this.overlay.checkIsReadyForRequest;\n      });\n    }\n  },\n  $e = ce;\n$e.__overlays__ = new Map();\nimport { MagicIncomingWindowMessage as le, SDKWarningCode as gr } from \"@magic-sdk/types\";\nfunction Rr(n, t) {\n  return t && Array.isArray(n) ? n.find(e => e.id === t) : n;\n}\nfunction vr(n, t) {\n  var o;\n  let e = (o = t.data.response) == null ? void 0 : o.id,\n    r = Rr(n, e);\n  if (e && r) {\n    let s = new F(r).applyResult(t.data.response.result).applyError(t.data.response.error);\n    return {\n      id: e,\n      response: s\n    };\n  }\n  return {};\n}\nfunction Tr(n, t, e) {\n  return m(this, null, function* () {\n    var i;\n    let r = yield y(\"rt\"),\n      o;\n    if (h.platform === \"web\") try {\n      o = (i = yield y(\"jwt\")) != null ? i : yield Lt();\n    } catch (c) {\n      console.error(\"webcrypto error\", c);\n    }\n    let s = {\n      msgType: n,\n      payload: t\n    };\n    o && (s.jwt = o), o && r && (s.rt = r);\n    let a = yield Dt(e);\n    return a && (s.deviceShare = a), s;\n  });\n}\nfunction Ir(n) {\n  return m(this, null, function* () {\n    !n.data.rt || (yield M(\"rt\", n.data.rt));\n  });\n}\nvar Be = class {\n  constructor(t, e, r) {\n    this.endpoint = t;\n    this.parameters = e;\n    this.networkHash = r;\n    this.messageHandlers = new Set();\n    this.isConnectedToInternet = !0;\n    this.checkIsReadyForRequest = this.waitForReady(), this.isReadyForRequest = !1, this.listen();\n  }\n  post(t, e) {\n    return m(this, null, function* () {\n      return _e((r, o) => m(this, null, function* () {\n        if (!this.isConnectedToInternet) {\n          let l = mt();\n          o(l);\n        }\n        this.isReadyForRequest || (yield this.waitForReady());\n        let s = [],\n          a = Array.isArray(e) ? e.map(l => l.id) : [],\n          i = yield Tr(`${t}-${this.parameters}`, e, this.networkHash);\n        yield this._post(i);\n        let c = l => p => {\n            var He;\n            let {\n              id: x,\n              response: v\n            } = vr(e, p);\n            if (Ir(p), ((He = v == null ? void 0 : v.payload.error) == null ? void 0 : He.message) === \"User denied account access.\") Z();else if (p.data.deviceShare) {\n              let {\n                deviceShare: Jt\n              } = p.data;\n              qt(Jt, this.networkHash);\n            }\n            x && v && Array.isArray(e) && a.includes(x) ? (s.push(v), s.length === e.length && (l(), r(s))) : x && v && !Array.isArray(e) && x === e.id && (l(), r(v));\n          },\n          u = this.on(le.MAGIC_HANDLE_RESPONSE, c(() => u()));\n      }));\n    });\n  }\n  on(t, e) {\n    let r = e.bind(window),\n      o = s => {\n        s.data.msgType === `${t}-${this.parameters}` && r(s);\n      };\n    return this.messageHandlers.add(o), () => this.messageHandlers.delete(o);\n  }\n  waitForReady() {\n    return new Promise(t => {\n      let e = this.on(le.MAGIC_OVERLAY_READY, () => {\n        this.isReadyForRequest = !0, t(), e();\n      });\n      setTimeout(() => {\n        this.isReadyForRequest = !0, t(), e();\n      }, 15e3);\n    });\n  }\n  listen() {\n    this.on(le.MAGIC_HIDE_OVERLAY, () => {\n      this.hideOverlay();\n    }), this.on(le.MAGIC_SHOW_OVERLAY, () => {\n      this.showOverlay();\n    }), this.on(le.MAGIC_SEND_PRODUCT_ANNOUNCEMENT, t => {\n      t.data.response.result.product_announcement && new W(gr.ProductAnnouncement, t.data.response.result.product_announcement).log();\n    });\n  }\n};\nexport { q as Extension, V as MagicExtensionError, se as MagicExtensionWarning, _ as MagicRPCError, A as MagicSDKError, W as MagicSDKWarning, $e as SDKBase, qe as STORE_KEY_PRIVATE_KEY, Ie as STORE_KEY_PUBLIC_JWK, Oe as TypedEmitter, Be as ViewController, Ts as clearKeys, U as createDeprecationWarning, qr as createDuplicateIframeWarning, Et as createExtensionNotInitializedError, yt as createIncompatibleExtensionsError, gt as createInvalidArgumentError, Lt as createJwt, ft as createMalformedResponseError, ht as createMissingApiKeyError, mt as createModalNotReadyError, k as createPromiEvent, _e as createPromise, vt as createReactNativeEndpointConfigurationWarning, Kn as createSDK, Rt as createSynchronousWeb3MethodWarning, ge as createTypedEmitter, Je as createURL, lt as decodeJSON, me as encodeJSON, Se as getPayloadId, re as isEmpty, dt as isJsonRpcErrorCode, $r as isJsonRpcRequestPayload, ut as isJsonRpcResponsePayload, Cr as isMagicPayloadMethod, Nt as isMajorVersionAtLeast, xt as isPromiEvent, ae as isWebCryptoSupported, ie as storage, Ct as uuid };","map":{"version":3,"names":["wt","zt","Gr","Le","Xn","Object","prototype","hasOwnProperty","w","oe","create","__proto__","zn","n","t","e","fn","context","once","bt","r","o","TypeError","s","a","_events","push","_eventsCount","ye","I","eventNames","call","slice","getOwnPropertySymbols","concat","listeners","length","Array","listenerCount","emit","i","c","u","arguments","l","p","removeListener","apply","x","v","on","removeAllListeners","off","addListener","prefixed","EventEmitter","exports","en","tn","Number","MAX_SAFE_INTEGER","Ae","SEMVER_SPEC_VERSION","MAX_LENGTH","MAX_SAFE_COMPONENT_LENGTH","nn","process","env","NODE_DEBUG","test","console","error","f","ne","re","src","RegExp","NUMERICIDENTIFIER","NUMERICIDENTIFIERLOOSE","NONNUMERICIDENTIFIER","PRERELEASEIDENTIFIER","PRERELEASEIDENTIFIERLOOSE","BUILDIDENTIFIER","MAINVERSION","PRERELEASE","BUILD","FULLPLAIN","MAINVERSIONLOOSE","PRERELEASELOOSE","LOOSEPLAIN","XRANGEIDENTIFIER","XRANGEIDENTIFIERLOOSE","GTLT","XRANGEPLAIN","XRANGEPLAINLOOSE","COERCE","LONETILDE","tildeTrimReplace","LONECARET","caretTrimReplace","comparatorTrimReplace","Ye","it","compareIdentifiers$1","rn","rcompareIdentifiers","sn","compareIdentifiers","Ze","de","Qe","et","ee","E","constructor","loose","includePrerelease","version","options","trim","match","LOOSE","FULL","raw","major","minor","patch","prerelease","split","map","build","format","join","toString","compare","compareMain","comparePre","compareBuild","inc","isNaN","Error","H","an","eq","cn","ln","neq","un","dn","gt","pn","hn","gte","mn","lt","En","yn","lte","gn","Rn","cmp","Ce","te","Symbol","D","ANY","value","parse","semver","operator","tt","nt","COMPARATORLOOSE","COMPARATOR","intersects","L","set","parseRange","filter","range","T","g","HYPHENRANGELOOSE","HYPHENRANGE","replace","Sn","COMPARATORTRIM","vn","TILDETRIM","Tn","CARETTRIM","In","bn","An","some","rt","every","Ln","isSatisfiable","pop","parseComparator","Mn","wn","Nn","Cn","b","toLowerCase","replaceTildes","Pn","replaceTilde","TILDELOOSE","TILDE","replaceCarets","xn","replaceCaret","CARETLOOSE","CARET","replaceXRanges","$n","replaceXRange","XRANGELOOSE","XRANGE","replaceStars","STAR","replaceGTE0","GTE0PRE","GTE0","testSet","at","satisfies","On","st","ot","_n","kn","pe","he","ct","coerce","String","rtl","COERCERTL","exec","index","lastIndex","qn","fromCharCode","parseInt","Dn","charCodeAt","Wn","btoa","encodeURIComponent","Un","decodeURIComponent","from","atob","me","JSON","stringify","RPCErrorCode","jn","SDKErrorCode","X","SDKWarningCode","Ee","MagicPayloadMethod","Fn","Jn","O","Gn","fe","$r","jsonrpc","id","method","params","ut","result","Cr","values","includes","dt","h","Kn","assign","pt","A","code","rawMessage","setPrototypeOf","_","message","InternalError","data","W","log","warn","V","name","se","ht","MissingApiKey","mt","ModalNotReady","ft","MalformedResponse","Et","ExtensionNotInitialized","yt","sdkName","compat","forEach","platform","IncompatibleExtensions","InvalidArgument","argument","procedure","expected","received","qr","DuplicateIframe","Rt","SyncWeb3Method","vt","ReactNativeEndpointConfiguration","defaultEndpoint","U","removalVersions","useInstead","DeprecationNotice","C","DeviceVerificationEventEmit","$t","LoginWithEmailOTPEventEmit","Re","UpdateEmailEventEmit","z","RecencyCheckEventEmit","Y","MagicOutgoingWindowMessage","Yn","MagicIncomingWindowMessage","Zn","Qn","Bn","Hn","Se","next","Tt","It","defineProperty","enumerable","Vn","G","d","F","_jsonrpc","payload","_id","_result","_error","applyError","applyResult","hasError","hasResult","Pt","Qt","Oe","default","ge","emitter","createChainingEmitterMethod","createBoundEmitterMethod","Mt","xt","k","_e","createChainingPromiseMethod","then","catch","finally","Promise","resolve","P","sdk","overlay","request","post","MAGIC_HANDLE_REQUEST","MAGIC_HANDLE_EVENT","response","event","createIntermediaryEvent","IntermediaryEvent","payloadId","eventType","args","Nt","K","ve","loginWithMagicLink","email","showUI","redirectURI","overrides","testMode","LoginWithMagicLinkTestMode","LoginWithMagicLink","loginWithSMS","phoneNumber","LoginWithSmsTestMode","LoginWithSms","loginWithEmailOTP","deviceCheckUI","LoginWithEmailOTPTestMode","LoginWithEmailOTP","Retry","VerifyEmailOtp","Cancel","loginWithCredential","window","location","search","origin","pathname","history","replaceState","LoginWithCredentialTestMode","LoginWithCredential","setAuthorizationToken","SetAuthorizationToken","jwt","updateEmailWithUI","UpdateEmailTestMode","UpdateEmail","RetryWithNewEmail","R","ie","Yt","clear","er","getItem","y","iterate","ke","key","nr","keys","rr","tr","removeItem","N","setItem","M","Te","J","m","configureStorage","ready","Ct","crypto","getRandomValues","Uint8Array","qe","Ie","St","sr","or","namedCurve","ae","subtle","Ts","Lt","ir","info","iat","Math","floor","Date","getTime","jti","typ","alg","jwk","protected","At","claims","cr","hash","ur","sign","ar","generateKey","exportKey","publicKey","privateKey","Ot","lr","TextEncoder","encode","De","We","Ue","Fe","dr","Z","startsWith","_t","byteLength","kt","buffer","pr","hr","qt","encrypt","iv","Dt","decrypt","Je","URL","be","localForageKey","localForageIsLoggedInKey","userLoggedOutCallbacks","getIdToken","GetIdTokenTestMode","GetIdToken","generateIdToken","GenerateIdTokenTestMode","GenerateIdToken","getInfo","GetInfo","walletType","isLoggedIn","useStorageCache","IsLoggedInTestMode","IsLoggedIn","emitUserLoggedOut","logout","LogoutTestMode","Logout","requestInfoWithUI","RequestUserInfoWithUI","showSettings","UserSettingsTestMode","UserSettings","recoverAccount","RecoverAccountTestMode","RecoverAccount","revealPrivateKey","RevealPK","getMetadata","GetMetadataTestMode","GetMetadata","onUserLoggedOut","Events","Ge","$","Wallets","S","we","connectWithUI","isMetaMaskBrowser","isWalletEnabled","MetaMask","autoConnectIfWalletBrowser","isCoinbaseWalletBrowser","CoinbaseWallet","getUserEnv","Login","WalletSelected","handleWalletSelected","B","j","ShowUI","showAddress","ShowAddress","showSendTokensUI","ShowSendTokensUI","showOnRamp","ShowOnRamp","showNFTs","ShowNFTs","showBalances","ShowBalances","sendGaslessTransaction","SendGaslessTransaction","disconnect","Disconnect","requestUserInfoWithUI","getProvider","getMetaMaskProvider","getCoinbaseProvider","rpcProvider","isMetaMaskInstalled","ethereum","isMetaMask","providers","find","isMobile","connectToMetaMask","href","isCoinbaseWalletInstalled","isCoinbaseWallet","isCoinbaseBrowser","connectToCoinbaseWallet","navigator","userAgent","connectToThirdPartyWallet","wallet","WalletConnected","WalletRejected","AutoConnect","address","Wt","mr","Pe","Q","Me","isMagic","sendAsync","isArray","prefixPayloadMethodForTestMode","send","enable","Ut","fr","getPrototypeOf","xe","__sdk_access_field_descriptors__","Map","__is_initialized__","utils","createPromiEvent","isPromiEvent","encodeJSON","decodeJSON","createJsonRpcRequestPayload","standardizeJsonRpcRequestPayload","storage","getOwnPropertyDescriptor","findIndex","descriptor","isPrototypeField","configurable","get","init","has","createDeprecationWarning","removalVersion","createWarning","createError","Ke","q","Internal","Anonymous","je","Ne","purchase","NFTPurchase","checkout","NFTCheckout","transfer","NFTTransfer","Ft","Er","rpcUrl","chainId","chainType","yr","extensions","config","ce","apiKey","endpoint","auth","user","nft","parameters","API_KEY","DOMAIN_ORIGIN","ETH_NETWORK","network","host","ext","locale","bundleId","meta","networkHash","deferPreload","preload","__overlays__","ViewController","checkIsReadyForRequest","$e","le","gr","Rr","vr","Tr","msgType","deviceShare","Ir","Be","messageHandlers","Set","isConnectedToInternet","waitForReady","isReadyForRequest","listen","_post","He","Jt","MAGIC_HANDLE_RESPONSE","bind","add","delete","MAGIC_OVERLAY_READY","setTimeout","MAGIC_HIDE_OVERLAY","hideOverlay","MAGIC_SHOW_OVERLAY","showOverlay","MAGIC_SEND_PRODUCT_ANNOUNCEMENT","product_announcement","ProductAnnouncement","Extension","MagicExtensionError","MagicExtensionWarning","MagicRPCError","MagicSDKError","MagicSDKWarning","SDKBase","STORE_KEY_PRIVATE_KEY","STORE_KEY_PUBLIC_JWK","TypedEmitter","clearKeys","createDuplicateIframeWarning","createExtensionNotInitializedError","createIncompatibleExtensionsError","createInvalidArgumentError","createJwt","createMalformedResponseError","createMissingApiKeyError","createModalNotReadyError","createPromise","createReactNativeEndpointConfigurationWarning","createSDK","createSynchronousWeb3MethodWarning","createTypedEmitter","createURL","getPayloadId","isEmpty","isJsonRpcErrorCode","isJsonRpcRequestPayload","isJsonRpcResponsePayload","isMagicPayloadMethod","isMajorVersionAtLeast","isWebCryptoSupported","uuid"],"sources":["/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/node_modules/eventemitter3/index.js","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/semver.js","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/base64-json.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/core/sdk-exceptions.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/type-guards.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/core/sdk-environment.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/modules/auth.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/modules/base-module.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/get-payload-id.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/core/json-rpc.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/events.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/promise-tools.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/version-check.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/modules/user.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/storage.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/uuid.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/web-crypto.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/device-share-web-crypto.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/util/url.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/modules/wallet.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/modules/rpc-provider.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/modules/base-extension.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/modules/nft.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/core/sdk.ts","/Users/richard/Documents/repos/email-noredirect-3otp/node_modules/@magic-sdk/provider/src/core/view-controller.ts"],"sourcesContent":["'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/* eslint-disable */\n/* istanbul ignore file */\n\n// DO NOT CHANGE THIS FILE.\n//\n// We have to bundle `semver` ourselves due to a long-standing cyclic dependency\n// which causes Rollup to break the `satisfies` function.\n//\n// See:\n//   - https://github.com/magiclabs/magic-js/issues/198\n//   - https://github.com/rollup/plugins/issues/879\n//   - https://github.com/npm/node-semver/issues/318\n//   - https://github.com/npm/node-semver/issues/381\n\nfunction createCommonjsModule(e){const r={exports:{}};return e(r,r.exports),r.exports}const SEMVER_SPEC_VERSION=\"2.0.0\",MAX_LENGTH$2=256,MAX_SAFE_INTEGER$1=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16,constants={SEMVER_SPEC_VERSION:\"2.0.0\",MAX_LENGTH:256,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER$1,MAX_SAFE_COMPONENT_LENGTH:16},debug=\"object\"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\\bsemver\\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error(\"SEMVER\",...e):()=>{},debug_1=debug,re_1=createCommonjsModule(function(e,r){const{MAX_SAFE_COMPONENT_LENGTH:t}=constants,s=(r=e.exports={}).re=[],i=r.src=[],o=r.t={};let a=0;const n=(e,r,t)=>{const n=a++;debug_1(n,r),o[e]=n,i[n]=r,s[n]=new RegExp(r,t?\"g\":void 0)};n(\"NUMERICIDENTIFIER\",\"0|[1-9]\\\\d*\"),n(\"NUMERICIDENTIFIERLOOSE\",\"[0-9]+\"),n(\"NONNUMERICIDENTIFIER\",\"\\\\d*[a-zA-Z-][a-zA-Z0-9-]*\"),n(\"MAINVERSION\",`(${i[o.NUMERICIDENTIFIER]})\\\\.`+`(${i[o.NUMERICIDENTIFIER]})\\\\.`+`(${i[o.NUMERICIDENTIFIER]})`),n(\"MAINVERSIONLOOSE\",`(${i[o.NUMERICIDENTIFIERLOOSE]})\\\\.`+`(${i[o.NUMERICIDENTIFIERLOOSE]})\\\\.`+`(${i[o.NUMERICIDENTIFIERLOOSE]})`),n(\"PRERELEASEIDENTIFIER\",`(?:${i[o.NUMERICIDENTIFIER]}|${i[o.NONNUMERICIDENTIFIER]})`),n(\"PRERELEASEIDENTIFIERLOOSE\",`(?:${i[o.NUMERICIDENTIFIERLOOSE]}|${i[o.NONNUMERICIDENTIFIER]})`),n(\"PRERELEASE\",`(?:-(${i[o.PRERELEASEIDENTIFIER]}(?:\\\\.${i[o.PRERELEASEIDENTIFIER]})*))`),n(\"PRERELEASELOOSE\",`(?:-?(${i[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\\\.${i[o.PRERELEASEIDENTIFIERLOOSE]})*))`),n(\"BUILDIDENTIFIER\",\"[0-9A-Za-z-]+\"),n(\"BUILD\",`(?:\\\\+(${i[o.BUILDIDENTIFIER]}(?:\\\\.${i[o.BUILDIDENTIFIER]})*))`),n(\"FULLPLAIN\",`v?${i[o.MAINVERSION]}${i[o.PRERELEASE]}?${i[o.BUILD]}?`),n(\"FULL\",`^${i[o.FULLPLAIN]}$`),n(\"LOOSEPLAIN\",`[v=\\\\s]*${i[o.MAINVERSIONLOOSE]}${i[o.PRERELEASELOOSE]}?${i[o.BUILD]}?`),n(\"LOOSE\",`^${i[o.LOOSEPLAIN]}$`),n(\"GTLT\",\"((?:<|>)?=?)\"),n(\"XRANGEIDENTIFIERLOOSE\",`${i[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\\\*`),n(\"XRANGEIDENTIFIER\",`${i[o.NUMERICIDENTIFIER]}|x|X|\\\\*`),n(\"XRANGEPLAIN\",`[v=\\\\s]*(${i[o.XRANGEIDENTIFIER]})`+`(?:\\\\.(${i[o.XRANGEIDENTIFIER]})`+`(?:\\\\.(${i[o.XRANGEIDENTIFIER]})`+`(?:${i[o.PRERELEASE]})?${i[o.BUILD]}?`+\")?)?\"),n(\"XRANGEPLAINLOOSE\",`[v=\\\\s]*(${i[o.XRANGEIDENTIFIERLOOSE]})`+`(?:\\\\.(${i[o.XRANGEIDENTIFIERLOOSE]})`+`(?:\\\\.(${i[o.XRANGEIDENTIFIERLOOSE]})`+`(?:${i[o.PRERELEASELOOSE]})?${i[o.BUILD]}?`+\")?)?\"),n(\"XRANGE\",`^${i[o.GTLT]}\\\\s*${i[o.XRANGEPLAIN]}$`),n(\"XRANGELOOSE\",`^${i[o.GTLT]}\\\\s*${i[o.XRANGEPLAINLOOSE]}$`),n(\"COERCE\",`(^|[^\\\\d])(\\\\d{1,${t}})`+`(?:\\\\.(\\\\d{1,${t}}))?`+`(?:\\\\.(\\\\d{1,${t}}))?`+\"(?:$|[^\\\\d])\"),n(\"COERCERTL\",i[o.COERCE],!0),n(\"LONETILDE\",\"(?:~>?)\"),n(\"TILDETRIM\",`(\\\\s*)${i[o.LONETILDE]}\\\\s+`,!0),r.tildeTrimReplace=\"$1~\",n(\"TILDE\",`^${i[o.LONETILDE]}${i[o.XRANGEPLAIN]}$`),n(\"TILDELOOSE\",`^${i[o.LONETILDE]}${i[o.XRANGEPLAINLOOSE]}$`),n(\"LONECARET\",\"(?:\\\\^)\"),n(\"CARETTRIM\",`(\\\\s*)${i[o.LONECARET]}\\\\s+`,!0),r.caretTrimReplace=\"$1^\",n(\"CARET\",`^${i[o.LONECARET]}${i[o.XRANGEPLAIN]}$`),n(\"CARETLOOSE\",`^${i[o.LONECARET]}${i[o.XRANGEPLAINLOOSE]}$`),n(\"COMPARATORLOOSE\",`^${i[o.GTLT]}\\\\s*(${i[o.LOOSEPLAIN]})$|^$`),n(\"COMPARATOR\",`^${i[o.GTLT]}\\\\s*(${i[o.FULLPLAIN]})$|^$`),n(\"COMPARATORTRIM\",`(\\\\s*)${i[o.GTLT]}\\\\s*(${i[o.LOOSEPLAIN]}|${i[o.XRANGEPLAIN]})`,!0),r.comparatorTrimReplace=\"$1$2$3\",n(\"HYPHENRANGE\",`^\\\\s*(${i[o.XRANGEPLAIN]})`+\"\\\\s+-\\\\s+\"+`(${i[o.XRANGEPLAIN]})`+\"\\\\s*$\"),n(\"HYPHENRANGELOOSE\",`^\\\\s*(${i[o.XRANGEPLAINLOOSE]})`+\"\\\\s+-\\\\s+\"+`(${i[o.XRANGEPLAINLOOSE]})`+\"\\\\s*$\"),n(\"STAR\",\"(<|>)?=?\\\\s*\\\\*\"),n(\"GTE0\",\"^\\\\s*>=\\\\s*0.0.0\\\\s*$\"),n(\"GTE0PRE\",\"^\\\\s*>=\\\\s*0.0.0-0\\\\s*$\")}),numeric=/^[0-9]+$/,compareIdentifiers$1=(e,r)=>{const t=numeric.test(e),s=numeric.test(r);return t&&s&&(e=+e,r=+r),e===r?0:t&&!s?-1:s&&!t?1:e<r?-1:1},rcompareIdentifiers=(e,r)=>compareIdentifiers$1(r,e),identifiers={compareIdentifiers:compareIdentifiers$1,rcompareIdentifiers:rcompareIdentifiers},{MAX_LENGTH:MAX_LENGTH$1,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER}=constants,{re:re$4,t:t$4}=re_1,{compareIdentifiers:compareIdentifiers}=identifiers;class SemVer{constructor(e,r){if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof SemVer){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(\"string\"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>MAX_LENGTH$1)throw new TypeError(`version is longer than ${MAX_LENGTH$1} characters`);debug_1(\"SemVer\",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const t=e.trim().match(r.loose?re$4[t$4.LOOSE]:re$4[t$4.FULL]);if(!t)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError(\"Invalid major version\");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError(\"Invalid minor version\");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError(\"Invalid patch version\");t[4]?this.prerelease=t[4].split(\".\").map(e=>{if(/^[0-9]+$/.test(e)){const r=+e;if(r>=0&&r<MAX_SAFE_INTEGER)return r}return e}):this.prerelease=[],this.build=t[5]?t[5].split(\".\"):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(\".\")}`),this.version}toString(){return this.version}compare(e){if(debug_1(\"SemVer.compare\",this.version,this.options,e),!(e instanceof SemVer)){if(\"string\"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),compareIdentifiers(this.major,e.major)||compareIdentifiers(this.minor,e.minor)||compareIdentifiers(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{const t=this.prerelease[r],s=e.prerelease[r];if(debug_1(\"prerelease compare\",r,t,s),void 0===t&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===t)return-1;if(t!==s)return compareIdentifiers(t,s)}while(++r)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let r=0;do{const t=this.build[r],s=e.build[r];if(debug_1(\"prerelease compare\",r,t,s),void 0===t&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===t)return-1;if(t!==s)return compareIdentifiers(t,s)}while(++r)}inc(e,r){switch(e){case\"premajor\":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc(\"pre\",r);break;case\"preminor\":this.prerelease.length=0,this.patch=0,this.minor++,this.inc(\"pre\",r);break;case\"prepatch\":this.prerelease.length=0,this.inc(\"patch\",r),this.inc(\"pre\",r);break;case\"prerelease\":0===this.prerelease.length&&this.inc(\"patch\",r),this.inc(\"pre\",r);break;case\"major\":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case\"minor\":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case\"patch\":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case\"pre\":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)\"number\"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}r&&(this.prerelease[0]===r?isNaN(this.prerelease[1])&&(this.prerelease=[r,0]):this.prerelease=[r,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}const compare=(e,r,t)=>new SemVer(e,t).compare(new SemVer(r,t)),compare_1=compare,eq=(e,r,t)=>0===compare_1(e,r,t),eq_1=eq,neq=(e,r,t)=>0!==compare_1(e,r,t),neq_1=neq,gt=(e,r,t)=>compare_1(e,r,t)>0,gt_1=gt,gte=(e,r,t)=>compare_1(e,r,t)>=0,gte_1=gte,lt=(e,r,t)=>compare_1(e,r,t)<0,lt_1=lt,lte=(e,r,t)=>compare_1(e,r,t)<=0,lte_1=lte,cmp=(e,r,t,s)=>{switch(r){case\"===\":return\"object\"==typeof e&&(e=e.version),\"object\"==typeof t&&(t=t.version),e===t;case\"!==\":return\"object\"==typeof e&&(e=e.version),\"object\"==typeof t&&(t=t.version),e!==t;case\"\":case\"=\":case\"==\":return eq_1(e,t,s);case\"!=\":return neq_1(e,t,s);case\">\":return gt_1(e,t,s);case\">=\":return gte_1(e,t,s);case\"<\":return lt_1(e,t,s);case\"<=\":return lte_1(e,t,s);default:throw new TypeError(`Invalid operator: ${r}`)}},cmp_1=cmp,ANY=Symbol(\"SemVer ANY\");class Comparator{static get ANY(){return ANY}constructor(e,r){if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof Comparator){if(e.loose===!!r.loose)return e;e=e.value}debug_1(\"comparator\",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===ANY?this.value=\"\":this.value=this.operator+this.semver.version,debug_1(\"comp\",this)}parse(e){const r=this.options.loose?re$3[t$3.COMPARATORLOOSE]:re$3[t$3.COMPARATOR],t=e.match(r);if(!t)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==t[1]?t[1]:\"\",\"=\"===this.operator&&(this.operator=\"\"),t[2]?this.semver=new SemVer(t[2],this.options.loose):this.semver=ANY}toString(){return this.value}test(e){if(debug_1(\"Comparator.test\",e,this.options.loose),this.semver===ANY||e===ANY)return!0;if(\"string\"==typeof e)try{e=new SemVer(e,this.options)}catch(e){return!1}return cmp_1(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof Comparator))throw new TypeError(\"a Comparator is required\");if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),\"\"===this.operator)return\"\"===this.value||new Range(e.value,r).test(this.value);if(\"\"===e.operator)return\"\"===e.value||new Range(this.value,r).test(e.semver);const t=!(\">=\"!==this.operator&&\">\"!==this.operator||\">=\"!==e.operator&&\">\"!==e.operator),s=!(\"<=\"!==this.operator&&\"<\"!==this.operator||\"<=\"!==e.operator&&\"<\"!==e.operator),i=this.semver.version===e.semver.version,o=!(\">=\"!==this.operator&&\"<=\"!==this.operator||\">=\"!==e.operator&&\"<=\"!==e.operator),a=cmp_1(this.semver,\"<\",e.semver,r)&&(\">=\"===this.operator||\">\"===this.operator)&&(\"<=\"===e.operator||\"<\"===e.operator),n=cmp_1(this.semver,\">\",e.semver,r)&&(\"<=\"===this.operator||\"<\"===this.operator)&&(\">=\"===e.operator||\">\"===e.operator);return t||s||i&&o||a||n}}const{re:re$3,t:t$3}=re_1;class Range{constructor(e,r){if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof Range)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new Range(e.raw,r);if(e instanceof Comparator)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e,this.set=e.split(/\\s*\\|\\|\\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);this.format()}format(){return this.range=this.set.map(e=>e.join(\" \").trim()).join(\"||\").trim(),this.range}toString(){return this.range}parseRange(e){const{loose:r}=this.options;e=e.trim();const t=r?re$2[t$2.HYPHENRANGELOOSE]:re$2[t$2.HYPHENRANGE];e=e.replace(t,hyphenReplace(this.options.includePrerelease)),debug_1(\"hyphen replace\",e),e=e.replace(re$2[t$2.COMPARATORTRIM],comparatorTrimReplace),debug_1(\"comparator trim\",e,re$2[t$2.COMPARATORTRIM]),e=(e=(e=e.replace(re$2[t$2.TILDETRIM],tildeTrimReplace)).replace(re$2[t$2.CARETTRIM],caretTrimReplace)).split(/\\s+/).join(\" \");const s=r?re$2[t$2.COMPARATORLOOSE]:re$2[t$2.COMPARATOR];return e.split(\" \").map(e=>parseComparator(e,this.options)).join(\" \").split(/\\s+/).map(e=>replaceGTE0(e,this.options)).filter(this.options.loose?e=>!!e.match(s):()=>!0).map(e=>new Comparator(e,this.options))}intersects(e,r){if(!(e instanceof Range))throw new TypeError(\"a Range is required\");return this.set.some(t=>isSatisfiable(t,r)&&e.set.some(e=>isSatisfiable(e,r)&&t.every(t=>e.every(e=>t.intersects(e,r)))))}test(e){if(!e)return!1;if(\"string\"==typeof e)try{e=new SemVer(e,this.options)}catch(e){return!1}for(let r=0;r<this.set.length;r++)if(testSet(this.set[r],e,this.options))return!0;return!1}}const{re:re$2,t:t$2,comparatorTrimReplace:comparatorTrimReplace,tildeTrimReplace:tildeTrimReplace,caretTrimReplace:caretTrimReplace}=re_1,isSatisfiable=(e,r)=>{let t=!0;const s=e.slice();let i=s.pop();for(;t&&s.length;)t=s.every(e=>i.intersects(e,r)),i=s.pop();return t},parseComparator=(e,r)=>(debug_1(\"comp\",e,r),e=replaceCarets(e,r),debug_1(\"caret\",e),e=replaceTildes(e,r),debug_1(\"tildes\",e),e=replaceXRanges(e,r),debug_1(\"xrange\",e),e=replaceStars(e,r),debug_1(\"stars\",e),e),isX=e=>!e||\"x\"===e.toLowerCase()||\"*\"===e,replaceTildes=(e,r)=>e.trim().split(/\\s+/).map(e=>replaceTilde(e,r)).join(\" \"),replaceTilde=(e,r)=>{const t=r.loose?re$2[t$2.TILDELOOSE]:re$2[t$2.TILDE];return e.replace(t,(r,t,s,i,o)=>{let a;return debug_1(\"tilde\",e,r,t,s,i,o),isX(t)?a=\"\":isX(s)?a=`>=${t}.0.0 <${+t+1}.0.0-0`:isX(i)?a=`>=${t}.${s}.0 <${t}.${+s+1}.0-0`:o?(debug_1(\"replaceTilde pr\",o),a=`>=${t}.${s}.${i}-${o} <${t}.${+s+1}.0-0`):a=`>=${t}.${s}.${i} <${t}.${+s+1}.0-0`,debug_1(\"tilde return\",a),a})},replaceCarets=(e,r)=>e.trim().split(/\\s+/).map(e=>replaceCaret(e,r)).join(\" \"),replaceCaret=(e,r)=>{debug_1(\"caret\",e,r);const t=r.loose?re$2[t$2.CARETLOOSE]:re$2[t$2.CARET],s=r.includePrerelease?\"-0\":\"\";return e.replace(t,(r,t,i,o,a)=>{let n;return debug_1(\"caret\",e,r,t,i,o,a),isX(t)?n=\"\":isX(i)?n=`>=${t}.0.0${s} <${+t+1}.0.0-0`:isX(o)?n=\"0\"===t?`>=${t}.${i}.0${s} <${t}.${+i+1}.0-0`:`>=${t}.${i}.0${s} <${+t+1}.0.0-0`:a?(debug_1(\"replaceCaret pr\",a),n=\"0\"===t?\"0\"===i?`>=${t}.${i}.${o}-${a} <${t}.${i}.${+o+1}-0`:`>=${t}.${i}.${o}-${a} <${t}.${+i+1}.0-0`:`>=${t}.${i}.${o}-${a} <${+t+1}.0.0-0`):(debug_1(\"no pr\"),n=\"0\"===t?\"0\"===i?`>=${t}.${i}.${o}${s} <${t}.${i}.${+o+1}-0`:`>=${t}.${i}.${o}${s} <${t}.${+i+1}.0-0`:`>=${t}.${i}.${o} <${+t+1}.0.0-0`),debug_1(\"caret return\",n),n})},replaceXRanges=(e,r)=>(debug_1(\"replaceXRanges\",e,r),e.split(/\\s+/).map(e=>replaceXRange(e,r)).join(\" \")),replaceXRange=(e,r)=>{e=e.trim();const t=r.loose?re$2[t$2.XRANGELOOSE]:re$2[t$2.XRANGE];return e.replace(t,(t,s,i,o,a,n)=>{debug_1(\"xRange\",e,t,s,i,o,a,n);const E=isX(i),p=E||isX(o),l=p||isX(a),c=l;return\"=\"===s&&c&&(s=\"\"),n=r.includePrerelease?\"-0\":\"\",E?t=\">\"===s||\"<\"===s?\"<0.0.0-0\":\"*\":s&&c?(p&&(o=0),a=0,\">\"===s?(s=\">=\",p?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):\"<=\"===s&&(s=\"<\",p?i=+i+1:o=+o+1),\"<\"===s&&(n=\"-0\"),t=`${s+i}.${o}.${a}${n}`):p?t=`>=${i}.0.0${n} <${+i+1}.0.0-0`:l&&(t=`>=${i}.${o}.0${n} <${i}.${+o+1}.0-0`),debug_1(\"xRange return\",t),t})},replaceStars=(e,r)=>(debug_1(\"replaceStars\",e,r),e.trim().replace(re$2[t$2.STAR],\"\")),replaceGTE0=(e,r)=>(debug_1(\"replaceGTE0\",e,r),e.trim().replace(re$2[r.includePrerelease?t$2.GTE0PRE:t$2.GTE0],\"\")),hyphenReplace=e=>(r,t,s,i,o,a,n,E,p,l,c,$,h)=>`${t=isX(s)?\"\":isX(i)?`>=${s}.0.0${e?\"-0\":\"\"}`:isX(o)?`>=${s}.${i}.0${e?\"-0\":\"\"}`:a?`>=${t}`:`>=${t}${e?\"-0\":\"\"}`} ${E=isX(p)?\"\":isX(l)?`<${+p+1}.0.0-0`:isX(c)?`<${p}.${+l+1}.0-0`:$?`<=${p}.${l}.${c}-${$}`:e?`<${p}.${l}.${+c+1}-0`:`<=${E}`}`.trim(),testSet=(e,r,t)=>{for(let t=0;t<e.length;t++)if(!e[t].test(r))return!1;if(r.prerelease.length&&!t.includePrerelease){for(let t=0;t<e.length;t++)if(debug_1(e[t].semver),e[t].semver!==Comparator.ANY&&e[t].semver.prerelease.length>0){const s=e[t].semver;if(s.major===r.major&&s.minor===r.minor&&s.patch===r.patch)return!0}return!1}return!0};export const satisfies=(e,r,t)=>{try{r=new Range(r,t)}catch(e){return!1}return r.test(e)};const satisfies_1=satisfies,{MAX_LENGTH:MAX_LENGTH}=constants,{re:re$1,t:t$1}=re_1,parse=(e,r)=>{if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof SemVer)return e;if(\"string\"!=typeof e)return null;if(e.length>MAX_LENGTH)return null;if(!(r.loose?re$1[t$1.LOOSE]:re$1[t$1.FULL]).test(e))return null;try{return new SemVer(e,r)}catch(e){return null}},parse_1=parse,{re:re,t:t}=re_1;export const coerce=(e,r)=>{if(e instanceof SemVer)return e;if(\"number\"==typeof e&&(e=String(e)),\"string\"!=typeof e)return null;let s=null;if((r=r||{}).rtl){let r;for(;(r=re[t.COERCERTL].exec(e))&&(!s||s.index+s[0].length!==e.length);)s&&r.index+r[0].length===s.index+s[0].length||(s=r),re[t.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;re[t.COERCERTL].lastIndex=-1}else s=e.match(re[t.COERCE]);return null===s?null:parse_1(`${s[2]}.${s[3]||\"0\"}.${s[4]||\"0\"}`,r)};\n","function percentToByte(p: string) {\n  return String.fromCharCode(parseInt(p.slice(1), 16));\n}\n\nfunction byteToPercent(b: string) {\n  return `%${`00${b.charCodeAt(0).toString(16)}`.slice(-2)}`;\n}\n\n/**\n * Encodes a Base64 string. Safe for UTF-8 characters.\n * Original source is from the `universal-base64` NPM package.\n *\n * @source https://github.com/blakeembrey/universal-base64/blob/master/src/browser.ts\n */\nfunction btoaUTF8(str: string): string {\n  return btoa(encodeURIComponent(str).replace(/%[0-9A-F]{2}/g, percentToByte));\n}\n\n/**\n * Decodes a Base64 string. Safe for UTF-8 characters.\n * Original source is from the `universal-base64` NPM package.\n *\n * @source https://github.com/blakeembrey/universal-base64/blob/master/src/browser.ts\n */\nfunction atobUTF8(str: string): string {\n  return decodeURIComponent(Array.from(atob(str), byteToPercent).join(''));\n}\n\n/**\n * Given a JSON-serializable object, encode as a Base64 string.\n */\nexport function encodeJSON<T>(options: T): string {\n  return btoaUTF8(JSON.stringify(options));\n}\n\n/**\n * Given a Base64 JSON string, decode a JavaScript object.\n */\nexport function decodeJSON<T>(queryString: string): T {\n  return JSON.parse(atobUTF8(queryString));\n}\n","import { JsonRpcError, RPCErrorCode, SDKErrorCode, SDKWarningCode } from '@magic-sdk/types';\nimport { isJsonRpcErrorCode } from '../util/type-guards';\nimport { SDKEnvironment } from './sdk-environment';\nimport { Extension } from '../modules/base-extension';\n\n// --- Error/warning classes\n\n/**\n * This error type represents internal SDK errors. This could be developer\n * mistakes (or Magic's mistakes), or execution errors unrelated to standard\n * JavaScript exceptions.\n */\nexport class MagicSDKError extends Error {\n  __proto__ = Error;\n\n  constructor(public code: SDKErrorCode, public rawMessage: string) {\n    super(`Magic SDK Error: [${code}] ${rawMessage}`);\n    Object.setPrototypeOf(this, MagicSDKError.prototype);\n  }\n}\n\n/**\n * This error type communicates exceptions that occur during execution in the\n * Magic `<iframe>` context.\n */\nexport class MagicRPCError extends Error {\n  __proto__ = Error;\n\n  public code: RPCErrorCode | number;\n  public rawMessage: string;\n  public data: any;\n\n  constructor(sourceError?: JsonRpcError | null) {\n    super();\n\n    const codeNormalized = Number(sourceError?.code);\n    this.rawMessage = sourceError?.message || 'Internal error';\n    this.code = isJsonRpcErrorCode(codeNormalized) ? codeNormalized : RPCErrorCode.InternalError;\n    this.message = `Magic RPC Error: [${this.code}] ${this.rawMessage}`;\n    this.data = sourceError?.data || undefined;\n\n    Object.setPrototypeOf(this, MagicRPCError.prototype);\n  }\n}\n\n/**\n * In contrast to `SDKError` objects, this \"warning\" type communicates important\n * context that does not rise to the level of an exception. These should be\n * logged rather than thrown.\n */\nexport class MagicSDKWarning {\n  public message: string;\n\n  constructor(public code: SDKWarningCode, public rawMessage: string) {\n    this.message = `Magic SDK Warning: [${code}] ${rawMessage}`;\n  }\n\n  /**\n   * Logs this warning to the console.\n   */\n  public log() {\n    console.warn(this.message);\n  }\n}\n\n/**\n * This error type is reserved for communicating errors that arise during\n * execution of Magic SDK Extension methods. Compare this to the `SDKError`\n * type, specifically in context of Extensions.\n */\nexport class MagicExtensionError<TData = any> extends Error {\n  __proto__ = Error;\n\n  constructor(ext: Extension<string>, public code: string | number, public rawMessage: string, public data: TData) {\n    super(`Magic Extension Error (${ext.name}): [${code}] ${rawMessage}`);\n    Object.setPrototypeOf(this, MagicExtensionError.prototype);\n  }\n}\n\n/**\n * In contrast to `MagicExtensionError` objects, this \"warning\" type\n * communicates important context that does not rise to the level of an\n * exception. These should be logged rather than thrown.\n */\nexport class MagicExtensionWarning {\n  public message: string;\n\n  constructor(ext: Extension<string>, public code: string | number, public rawMessage: string) {\n    this.message = `Magic Extension Warning (${ext.name}): [${code}] ${rawMessage}`;\n  }\n\n  /**\n   * Logs this warning to the console.\n   */\n  public log() {\n    console.warn(this.message);\n  }\n}\n\n// --- SDK error factories\n\nexport function createMissingApiKeyError() {\n  return new MagicSDKError(\n    SDKErrorCode.MissingApiKey,\n    'Please provide an API key that you acquired from the Magic developer dashboard.',\n  );\n}\n\nexport function createModalNotReadyError() {\n  return new MagicSDKError(SDKErrorCode.ModalNotReady, 'Modal is not ready.');\n}\n\nexport function createMalformedResponseError() {\n  return new MagicSDKError(SDKErrorCode.MalformedResponse, 'Response from the Magic iframe is malformed.');\n}\n\nexport function createExtensionNotInitializedError(member: string) {\n  return new MagicSDKError(\n    SDKErrorCode.ExtensionNotInitialized,\n    `Extensions must be initialized with a Magic SDK instance before \\`Extension.${member}\\` can be accessed. Do not invoke \\`Extension.${member}\\` inside an extension constructor.`,\n  );\n}\n\nexport function createIncompatibleExtensionsError(extensions: Extension<string>[]) {\n  let msg = `Some extensions are incompatible with \\`${SDKEnvironment.sdkName}@${SDKEnvironment.version}\\`:`;\n\n  extensions\n    .filter((ext) => typeof ext.compat !== 'undefined' && ext.compat !== null)\n    .forEach((ext) => {\n      const compat = ext.compat![SDKEnvironment.sdkName];\n\n      /* istanbul ignore else */\n      if (typeof compat === 'string') {\n        msg += `\\n  - Extension \\`${ext.name}\\` supports version(s) \\`${compat}\\``;\n      } else if (!compat) {\n        msg += `\\n  - Extension \\`${ext.name}\\` does not support ${SDKEnvironment.platform} environments.`;\n      }\n\n      // Else case is irrelevant here here\n      // (we filter out extensions with missing `compat` field)\n    });\n\n  return new MagicSDKError(SDKErrorCode.IncompatibleExtensions, msg);\n}\n\nexport function createInvalidArgumentError(options: {\n  procedure: string;\n  argument: number;\n  expected: string;\n  received: string;\n}) {\n  /**\n   * Parses the argument index (given by `argument`) to attach the correct ordinal suffix.\n   * (i.e.: 1st, 2nd, 3rd, 4th, etc.)\n   */\n  const ordinalSuffix = (i: number) => {\n    const iAdjusted = i + 1; // Argument is zero-indexed.\n    const j = iAdjusted % 10;\n    const k = iAdjusted % 100;\n    if (j === 1 && k !== 11) return `${iAdjusted}st`;\n    if (j === 2 && k !== 12) return `${iAdjusted}nd`;\n    if (j === 3 && k !== 13) return `${iAdjusted}rd`;\n    return `${iAdjusted}th`;\n  };\n\n  return new MagicSDKError(\n    SDKErrorCode.InvalidArgument,\n    `Invalid ${ordinalSuffix(options.argument)} argument given to \\`${options.procedure}\\`.\\n` +\n      `  Expected: \\`${options.expected}\\`\\n` +\n      `  Received: \\`${options.received}\\``,\n  );\n}\n\n// --- SDK warning factories\n\nexport function createDuplicateIframeWarning() {\n  return new MagicSDKWarning(SDKWarningCode.DuplicateIframe, 'Duplicate iframes found.');\n}\n\nexport function createSynchronousWeb3MethodWarning() {\n  return new MagicSDKWarning(\n    SDKWarningCode.SyncWeb3Method,\n    'Non-async web3 methods are deprecated in web3 > 1.0 and are not supported by the Magic web3 provider. Please use an async method instead.',\n  );\n}\n\nexport function createReactNativeEndpointConfigurationWarning() {\n  return new MagicSDKWarning(\n    SDKWarningCode.ReactNativeEndpointConfiguration,\n    `CUSTOM DOMAINS ARE NOT SUPPORTED WHEN USING MAGIC SDK WITH REACT NATIVE! The \\`endpoint\\` parameter SHOULD NOT be provided. The Magic \\`<iframe>\\` is automatically wrapped by a WebView pointed at \\`${SDKEnvironment.defaultEndpoint}\\`. Changing this default behavior will lead to unexpected results and potentially security-threatening bugs.`,\n  );\n}\n\nexport function createDeprecationWarning(options: {\n  method: string;\n  removalVersions: {\n    [P in\n      | 'magic-sdk'\n      | '@magic-sdk/react-native'\n      | '@magic-sdk/react-native-bare'\n      | '@magic-sdk/react-native-expo']: string;\n  };\n  useInstead?: string;\n}) {\n  const { method, removalVersions, useInstead } = options;\n\n  const removalVersion = removalVersions[SDKEnvironment.sdkName];\n  const useInsteadSuffix = useInstead ? ` Use \\`${useInstead}\\` instead.` : '';\n  const message = `\\`${method}\\` will be removed from \\`${SDKEnvironment.sdkName}\\` in version \\`${removalVersion}\\`.${useInsteadSuffix}`;\n\n  return new MagicSDKWarning(SDKWarningCode.DeprecationNotice, message);\n}\n","/**\n * This file contains our type guards.\n *\n * Type guards are a feature of TypeScript which narrow the type signature of\n * intesection types (types that can be one thing or another).\n *\n * @see\n * https://www.typescriptlang.org/docs/handbook/advanced-types.html#type-guards-and-differentiating-types\n */\n\nimport { JsonRpcRequestPayload, JsonRpcResponsePayload, MagicPayloadMethod, RPCErrorCode } from '@magic-sdk/types';\n\n/**\n * Assert `value` is `undefined`.\n */\nfunction isUndefined(value: any): value is undefined {\n  return typeof value === 'undefined';\n}\n\n/**\n * Assert `value` is `null`.\n */\nfunction isNull(value: any): value is null {\n  return value === null;\n}\n\n/**\n * Assert `value` is `null` or `undefined`.\n */\nfunction isNil(value: any): value is null | undefined {\n  return isNull(value) || isUndefined(value);\n}\n\n/**\n * Assert `value` is a `JsonRpcRequestPayload` object.\n */\nexport function isJsonRpcRequestPayload(value?: JsonRpcRequestPayload): value is JsonRpcRequestPayload {\n  if (isNil(value)) return false;\n  return (\n    !isUndefined(value.jsonrpc) && !isUndefined(value.id) && !isUndefined(value.method) && !isUndefined(value.params)\n  );\n}\n\n/**\n * Assert `value` is a `JsonRpcResponsePayload` object.\n */\nexport function isJsonRpcResponsePayload(value: any): value is JsonRpcResponsePayload {\n  if (isNil(value)) return false;\n  return (\n    !isUndefined(value.jsonrpc) && !isUndefined(value.id) && (!isUndefined(value.result) || !isUndefined(value.error))\n  );\n}\n\n/**\n * Assert `value` is a Magic SDK payload method identifier.\n */\nexport function isMagicPayloadMethod(value?: any): value is MagicPayloadMethod {\n  if (isNil(value)) return false;\n  return typeof value === 'string' && Object.values(MagicPayloadMethod).includes(value as any);\n}\n\n/**\n * Assert `value` is an expected JSON RPC error code.\n */\nexport function isJsonRpcErrorCode(value?: any): value is RPCErrorCode {\n  if (isNil(value)) return false;\n  return typeof value === 'number' && Object.values(RPCErrorCode).includes(value);\n}\n\n/**\n * Assert `value` is an empty, plain object.\n */\nexport function isEmpty(value?: any): value is {} {\n  if (!value) return true;\n\n  for (const key in value) {\n    /* istanbul ignore else */\n    if (Object.hasOwnProperty.call(value, key)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import type localForage from 'localforage';\nimport type { ViewController } from './view-controller';\nimport type { SDKBase } from './sdk';\nimport type { WithExtensions } from '../modules/base-extension';\n\ntype ConstructorOf<C> = { new (...args: any[]): C };\n\n/**\n * A structure containing details about the current environment.\n * This is guaranteed to be populated before the SDK is instantiated.\n */\nexport interface SDKEnvironment {\n  sdkName: 'magic-sdk' | '@magic-sdk/react-native' | '@magic-sdk/react-native-bare' | '@magic-sdk/react-native-expo';\n  version: string;\n  platform: 'web' | 'react-native';\n  defaultEndpoint: string;\n  ViewController: ConstructorOf<ViewController>;\n  configureStorage: () => Promise<typeof localForage>;\n  bundleId?: string | null;\n}\n\nexport const SDKEnvironment: SDKEnvironment = {} as any;\n\nexport function createSDK<SDK extends SDKBase>(\n  SDKBaseCtor: ConstructorOf<SDK>,\n  environment: SDKEnvironment,\n): WithExtensions<SDK> {\n  Object.assign(SDKEnvironment, environment);\n  return SDKBaseCtor as any;\n}\n\nexport const sdkNameToEnvName = {\n  'magic-sdk': 'magic-sdk' as const,\n  '@magic-sdk/react-native': 'magic-sdk-rn' as const,\n  '@magic-sdk/react-native-bare': 'magic-sdk-rn-bare' as const,\n  '@magic-sdk/react-native-expo': 'magic-sdk-rn-expo' as const,\n};\n","import {\n  MagicPayloadMethod,\n  LoginWithMagicLinkConfiguration,\n  LoginWithSmsConfiguration,\n  LoginWithEmailOTPConfiguration,\n  LoginWithEmailOTPEventHandlers,\n  LoginWithMagicLinkEventHandlers,\n  UpdateEmailConfiguration,\n  DeviceVerificationEventEmit,\n  LoginWithEmailOTPEventEmit,\n  UpdateEmailEventHandlers,\n  UpdateEmailEventEmit,\n  RecencyCheckEventEmit,\n} from '@magic-sdk/types';\nimport { BaseModule } from './base-module';\nimport { createJsonRpcRequestPayload } from '../core/json-rpc';\nimport { SDKEnvironment } from '../core/sdk-environment';\nimport { isMajorVersionAtLeast } from '../util/version-check';\nimport { createDeprecationWarning } from '../core/sdk-exceptions';\n\nexport const ProductConsolidationMethodRemovalVersions = {\n  'magic-sdk': 'v18.0.0',\n  '@magic-sdk/react-native': 'v14.0.0',\n  '@magic-sdk/react-native-bare': 'v19.0.0',\n  '@magic-sdk/react-native-expo': 'v19.0.0',\n};\n\nexport class AuthModule extends BaseModule {\n  /**\n   * Initiate the \"magic link\" login flow for a user. If the flow is successful,\n   * this method will return a Decentralized ID token (with a default lifespan\n   * of 15 minutes).\n   */\n  public loginWithMagicLink(configuration: LoginWithMagicLinkConfiguration) {\n    const isRNMobilePackage =\n      SDKEnvironment.sdkName === '@magic-sdk/react-native' ||\n      SDKEnvironment.sdkName === '@magic-sdk/react-native-bare' ||\n      SDKEnvironment.sdkName === '@magic-sdk/react-native-expo';\n\n    // RN SDK major version is greater than or equal to v19\n    if (isRNMobilePackage && isMajorVersionAtLeast(SDKEnvironment.version, 19)) {\n      throw new Error(\n        'loginWithMagicLink() is deprecated for this package, please utlize a passcode method like loginWithSMS or loginWithEmailOTP instead.',\n      );\n    } else if (isRNMobilePackage) {\n      // RN SDK major version is less than v19\n      createDeprecationWarning({\n        method: 'auth.loginWithMagicLink()',\n        removalVersions: ProductConsolidationMethodRemovalVersions,\n        useInstead: 'auth.loginWithEmailOTP()',\n      }).log();\n    }\n\n    const { email, showUI = true, redirectURI, overrides } = configuration;\n\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.LoginWithMagicLinkTestMode : MagicPayloadMethod.LoginWithMagicLink,\n      [{ email, showUI, redirectURI, overrides }],\n    );\n    return this.request<string | null, LoginWithMagicLinkEventHandlers>(requestPayload);\n  }\n\n  /**\n   * Initiate an SMS login flow for a user. If successful,\n   * this method will return a Decenteralized ID token (with a default lifespan\n   * of 15 minutes)\n   */\n  public loginWithSMS(configuration: LoginWithSmsConfiguration) {\n    const { phoneNumber } = configuration;\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.LoginWithSmsTestMode : MagicPayloadMethod.LoginWithSms,\n      [{ phoneNumber, showUI: true }],\n    );\n    return this.request<string | null>(requestPayload);\n  }\n\n  /**\n   * Initiate an Email with OTP login flow for a user. If successful,\n   * this method will return a Decenteralized ID token (with a default lifespan\n   * of 15 minutes)\n   */\n  public loginWithEmailOTP(configuration: LoginWithEmailOTPConfiguration) {\n    const { email, showUI, deviceCheckUI, overrides } = configuration;\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.LoginWithEmailOTPTestMode : MagicPayloadMethod.LoginWithEmailOTP,\n      [{ email, showUI, deviceCheckUI, overrides }],\n    );\n    const handle = this.request<string | null, LoginWithEmailOTPEventHandlers>(requestPayload);\n    if (!deviceCheckUI && handle) {\n      handle.on(DeviceVerificationEventEmit.Retry, () => {\n        this.createIntermediaryEvent(DeviceVerificationEventEmit.Retry, requestPayload.id as any)();\n      });\n    }\n    if (!showUI && handle) {\n      handle.on(LoginWithEmailOTPEventEmit.VerifyEmailOtp, (otp: string) => {\n        this.createIntermediaryEvent(LoginWithEmailOTPEventEmit.VerifyEmailOtp, requestPayload.id as any)(otp);\n      });\n      handle.on(LoginWithEmailOTPEventEmit.Cancel, () => {\n        this.createIntermediaryEvent(LoginWithEmailOTPEventEmit.Cancel, requestPayload.id as any)();\n      });\n    }\n    return handle;\n  }\n\n  /**\n   * Log a user in with a special one-time-use credential token. This is\n   * currently used during magic link flows with a configured redirect to\n   * hydrate the user session at the end of the flow. If the flow is successful,\n   * this method will return a Decentralized ID token (with a default lifespan\n   * of 15 minutes).\n   *\n   * If no argument is provided, a credential is automatically parsed from\n   * `window.location.search`.\n   */\n  public loginWithCredential(credentialOrQueryString?: string) {\n    let credentialResolved = credentialOrQueryString ?? '';\n\n    if (!credentialOrQueryString && SDKEnvironment.platform === 'web') {\n      credentialResolved = window.location.search;\n\n      // Remove the query from the redirect callback as a precaution.\n      const urlWithoutQuery = window.location.origin + window.location.pathname;\n      window.history.replaceState(null, '', urlWithoutQuery);\n    }\n\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.LoginWithCredentialTestMode : MagicPayloadMethod.LoginWithCredential,\n      [credentialResolved],\n    );\n\n    return this.request<string | null>(requestPayload);\n  }\n\n  // Custom Auth\n  public setAuthorizationToken(jwt: string) {\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.SetAuthorizationToken, [{ jwt }]);\n    return this.request<boolean>(requestPayload);\n  }\n\n  public updateEmailWithUI(configuration: UpdateEmailConfiguration) {\n    const { email, showUI = true } = configuration;\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.UpdateEmailTestMode : MagicPayloadMethod.UpdateEmail,\n      [{ email, showUI }],\n    );\n\n    const handle = this.request<string | null, UpdateEmailEventHandlers>(requestPayload);\n\n    if (!showUI) {\n      handle.on(RecencyCheckEventEmit.Retry, () => {\n        this.createIntermediaryEvent(RecencyCheckEventEmit.Retry, requestPayload.id as any)();\n      });\n      handle.on(RecencyCheckEventEmit.Cancel, () => {\n        this.createIntermediaryEvent(RecencyCheckEventEmit.Cancel, requestPayload.id as any)();\n      });\n      handle.on(RecencyCheckEventEmit.VerifyEmailOtp, (otp: string) => {\n        this.createIntermediaryEvent(RecencyCheckEventEmit.VerifyEmailOtp, requestPayload.id as any)(otp);\n      });\n      handle.on(UpdateEmailEventEmit.RetryWithNewEmail, (newEmail?) => {\n        this.createIntermediaryEvent(UpdateEmailEventEmit.RetryWithNewEmail, requestPayload.id as any)(newEmail);\n      });\n      handle.on(UpdateEmailEventEmit.Cancel, () => {\n        this.createIntermediaryEvent(UpdateEmailEventEmit.Cancel, requestPayload.id as any)();\n      });\n      handle.on(UpdateEmailEventEmit.VerifyEmailOtp, (otp: string) => {\n        this.createIntermediaryEvent(UpdateEmailEventEmit.VerifyEmailOtp, requestPayload.id as any)(otp);\n      });\n    }\n    return handle;\n  }\n}\n","import {\n  JsonRpcRequestPayload,\n  MagicOutgoingWindowMessage,\n  MagicIncomingWindowMessage,\n  MagicPayloadMethod,\n  IntermediaryEvents,\n} from '@magic-sdk/types';\nimport { createMalformedResponseError, MagicRPCError } from '../core/sdk-exceptions';\nimport type { SDKBase } from '../core/sdk';\nimport { createJsonRpcRequestPayload, standardizeJsonRpcRequestPayload } from '../core/json-rpc';\nimport { createPromiEvent } from '../util/promise-tools';\nimport type { ViewController } from '../core/view-controller';\nimport type { EventsDefinition } from '../util/events';\n\nexport class BaseModule {\n  constructor(protected sdk: SDKBase) {}\n\n  /**\n   * The `ViewController` for the SDK instance registered to this module.\n   */\n  protected get overlay(): ViewController {\n    return (this.sdk as any).overlay;\n  }\n\n  /**\n   * Emits promisified requests to the Magic `<iframe>` context.\n   */\n  protected request<ResultType = any, Events extends EventsDefinition = void>(payload: Partial<JsonRpcRequestPayload>) {\n    const responsePromise = this.overlay.post<ResultType>(\n      MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,\n      standardizeJsonRpcRequestPayload(payload),\n    );\n\n    // PromiEvent-ify the response.\n    const promiEvent = createPromiEvent<ResultType, Events>((resolve, reject) => {\n      responsePromise\n        .then((res) => {\n          cleanupEvents();\n          if (res.hasError) reject(new MagicRPCError(res.payload.error));\n          else if (res.hasResult) resolve(res.payload.result as ResultType);\n          else throw createMalformedResponseError();\n        })\n        .catch((err) => {\n          cleanupEvents();\n          reject(err);\n        });\n    });\n\n    // Listen for events from the `<iframe>` associated with the current payload\n    // and emit those to `PromiEvent` subscribers.\n    const cleanupEvents = this.overlay.on(MagicIncomingWindowMessage.MAGIC_HANDLE_EVENT, (evt) => {\n      const { response } = evt.data;\n\n      if (response.id === payload.id && response.result?.event) {\n        const { event, params = [] } = response.result;\n        promiEvent.emit(event, ...params);\n      }\n    });\n\n    return promiEvent;\n  }\n\n  // Creates an intermediary event which takes a typed event and a payload ID\n  protected createIntermediaryEvent<T = Function>(eventType: IntermediaryEvents, payloadId: string) {\n    const e = (args: any) => {\n      const res = createJsonRpcRequestPayload(MagicPayloadMethod.IntermediaryEvent, [{ payloadId, eventType, args }]);\n      this.request(res);\n    };\n    return e as unknown as T;\n  }\n}\n","function* createIntGenerator(): Generator<number, number, void> {\n  let index = 0;\n\n  while (true) {\n    /* istanbul ignore next */\n    if (index < Number.MAX_SAFE_INTEGER) yield ++index;\n    else index = 0;\n  }\n}\n\nconst intGenerator = createIntGenerator();\n\n/**\n * Get an integer ID for attaching to a JSON RPC request payload.\n */\nexport function getPayloadId(): number {\n  return intGenerator.next().value;\n}\n","/* eslint-disable no-param-reassign */\n\nimport { JsonRpcRequestPayload, JsonRpcResponsePayload, JsonRpcError } from '@magic-sdk/types';\nimport { isJsonRpcResponsePayload } from '../util/type-guards';\nimport { getPayloadId } from '../util/get-payload-id';\n\nconst payloadPreprocessedSymbol = Symbol('Payload pre-processed by Magic SDK');\n\n/**\n * To avoid \"pre-processing\" a payload more than once (and needlessly\n * incrementing our payload ID generator), we attach a symbol to detect a\n * payloads we've already visited.\n */\nfunction markPayloadAsPreprocessed<T extends Partial<JsonRpcRequestPayload>>(payload: T): T {\n  Object.defineProperty(payload, payloadPreprocessedSymbol, {\n    value: true,\n    enumerable: false,\n  });\n\n  return payload;\n}\n\n/**\n * Returns `true` if the payload has been visited by our \"pre-processing,\" in\n * `standardizeJsonRpcRequestPayload(...)`.\n */\nfunction isPayloadPreprocessed<T extends Partial<JsonRpcRequestPayload>>(payload: T) {\n  return !!(payload as any)[payloadPreprocessedSymbol];\n}\n\n/**\n * Returns a full `JsonRpcRequestPayload` from a potentially incomplete payload\n * object. This method mutates the given `payload` to preserve compatibility\n * with external libraries that perform their own `JsonRpcRequestPayload.id`\n * check to associate responses (such as `web3`).\n *\n * This function is no-op if the payload has already been processed before.\n */\nexport function standardizeJsonRpcRequestPayload(payload: Partial<JsonRpcRequestPayload>) {\n  if (!isPayloadPreprocessed(payload)) {\n    payload.jsonrpc = payload.jsonrpc ?? '2.0';\n    payload.id = getPayloadId();\n    payload.method = payload.method ?? 'noop';\n    payload.params = payload.params ?? [];\n\n    markPayloadAsPreprocessed(payload);\n  }\n\n  /* eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion */\n  return payload as JsonRpcRequestPayload;\n}\n\n/**\n * Build a valid JSON RPC payload for emitting to the Magic SDK iframe relayer.\n */\nexport function createJsonRpcRequestPayload(method: string, params: any[] = []): JsonRpcRequestPayload {\n  return markPayloadAsPreprocessed({\n    params,\n    method,\n    jsonrpc: '2.0',\n    id: getPayloadId(),\n  });\n}\n\n/**\n * Formats and standardizes a JSON RPC 2.0 response from a number of potential\n * sources.\n */\nexport class JsonRpcResponse<ResultType = any> {\n  private readonly _jsonrpc: string;\n  private readonly _id: string | number | null;\n  private _result?: ResultType | null;\n  private _error?: JsonRpcError | null;\n\n  constructor(responsePayload: JsonRpcResponsePayload);\n  constructor(response: JsonRpcResponse<ResultType>);\n  constructor(requestPayload: JsonRpcRequestPayload);\n  constructor(responseOrPayload: JsonRpcResponsePayload | JsonRpcResponse<ResultType> | JsonRpcRequestPayload) {\n    if (responseOrPayload instanceof JsonRpcResponse) {\n      this._jsonrpc = responseOrPayload.payload.jsonrpc;\n      this._id = responseOrPayload.payload.id;\n      this._result = responseOrPayload.payload.result;\n      this._error = responseOrPayload.payload.error;\n    } else if (isJsonRpcResponsePayload(responseOrPayload)) {\n      this._jsonrpc = responseOrPayload.jsonrpc;\n      this._id = responseOrPayload.id;\n      this._result = responseOrPayload.result;\n      this._error = responseOrPayload.error;\n    } else {\n      this._jsonrpc = responseOrPayload.jsonrpc;\n      this._id = responseOrPayload.id;\n      this._result = undefined;\n      this._error = undefined;\n    }\n  }\n\n  public applyError(error?: JsonRpcError | null) {\n    this._error = error;\n    return this;\n  }\n\n  public applyResult(result?: ResultType | null) {\n    this._result = result;\n    return this;\n  }\n\n  public get hasError() {\n    return typeof this._error !== 'undefined' && this._error !== null;\n  }\n\n  public get hasResult() {\n    return typeof this._result !== 'undefined';\n  }\n\n  public get payload(): JsonRpcResponsePayload {\n    return {\n      jsonrpc: this._jsonrpc,\n      id: this._id,\n      result: this._result,\n      error: this._error,\n    };\n  }\n}\n","import EventEmitter from 'eventemitter3';\n\nexport type EventsDefinition = { [K in string | symbol]: (...args: any[]) => void } | void;\n\n/**\n * An extension of `EventEmitter` (provided by `eventemitter3`) with an adjusted\n * type interface that supports the unique structure of Magic SDK modules.\n */\nexport class TypedEmitter<Events extends EventsDefinition = void> extends EventEmitter<\n  Events extends void ? string | symbol : Events\n> {}\n\ntype ChainingMethods = 'on' | 'once' | 'addListener' | 'off' | 'removeListener' | 'removeAllListeners';\ntype NonChainingMethods = 'emit' | 'eventNames' | 'listeners' | 'listenerCount';\n\ntype ReplaceReturnType<T extends (...a: any) => any, TNewReturn> = (...a: Parameters<T>) => TNewReturn;\n\n/**\n * Creates a `TypedEmitter` instance and returns helper functions for easily\n * mixing `TypedEmitter` methods into other objects.\n */\nexport function createTypedEmitter<Events extends EventsDefinition = void>() {\n  const emitter = new TypedEmitter<Events>();\n\n  const createChainingEmitterMethod = <T1 extends ChainingMethods, T2>(\n    method: T1,\n    source: T2,\n  ): ReplaceReturnType<TypedEmitter[T1], T2> => {\n    return (...args: any[]) => {\n      (emitter as any)[method].apply(emitter, args);\n      return source;\n    };\n  };\n\n  const createBoundEmitterMethod = <T extends NonChainingMethods>(method: T): TypedEmitter[T] => {\n    return (...args: any[]) => {\n      return (emitter as any)[method].apply(emitter, args);\n    };\n  };\n\n  return {\n    emitter,\n    createChainingEmitterMethod,\n    createBoundEmitterMethod,\n  };\n}\n","import { TypedEmitter, EventsDefinition, createTypedEmitter } from './events';\n\n/**\n * Extends `Promise` with a polymorphic `this` type to accomodate arbitrary\n * `Promise` API extensions.\n */\ninterface ExtendedPromise<T> extends Promise<T> {\n  then<TResult1 = T, TResult2 = never>(\n    onfulfilled?: ((value: T) => TResult1 | PromiseLike<TResult1>) | undefined | null,\n    onrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | undefined | null,\n  ): ExtendedPromise<TResult1 | TResult2> & this;\n\n  catch<TResult = never>(\n    onrejected?: ((reason: any) => TResult | PromiseLike<TResult>) | undefined | null,\n  ): ExtendedPromise<T | TResult> & this;\n\n  finally(onfinally?: (() => void) | undefined | null): ExtendedPromise<T> & this;\n}\n\n/**\n * A `Promise` and `EventEmitter` all in one!\n */\nexport type PromiEvent<TResult, TEvents extends EventsDefinition = void> = ExtendedPromise<TResult> &\n  TypedEmitter<TEvents extends void ? DefaultEvents<TResult> : TEvents & DefaultEvents<TResult>>;\n\n/**\n * Default events attached to every `PromiEvent`.\n */\ntype DefaultEvents<TResult> = {\n  done: (result: TResult) => void;\n  error: (reason: any) => void;\n  settled: () => void;\n};\n\n/**\n * A `Promise` executor with can be optionally asynchronous.\n */\ntype AsyncPromiseExecutor<TResult> = (\n  resolve: (value: TResult | PromiseLike<TResult>) => void,\n  reject: (reason?: any) => void,\n) => void | Promise<void>;\n\nconst promiEventBrand = Symbol('isPromiEvent');\n\n/**\n * Returns `true` if the given `value` is a `PromiEvent`.\n */\nexport function isPromiEvent(value: any): value is PromiEvent<any> {\n  return !!value[promiEventBrand];\n}\n\n/**\n * Create a native JavaScript `Promise` overloaded with strongly-typed methods\n * from `EventEmitter`.\n */\nexport function createPromiEvent<TResult, TEvents extends EventsDefinition = void>(\n  executor: AsyncPromiseExecutor<TResult>,\n): PromiEvent<TResult, TEvents extends void ? DefaultEvents<TResult> : TEvents & DefaultEvents<TResult>> {\n  const promise = createPromise(executor);\n  const { createBoundEmitterMethod, createChainingEmitterMethod } = createTypedEmitter<\n    TEvents & DefaultEvents<TResult>\n  >();\n\n  // We save the original `Promise` methods to the following symbols so we can\n  // access them internally.\n  const thenSymbol = Symbol('Promise.then');\n  const catchSymbol = Symbol('Promise.catch');\n  const finallySymbol = Symbol('Promise.finally');\n\n  /**\n   * Ensures the next object in the `PromiEvent` chain is overloaded with\n   * `EventEmitter` methods.\n   */\n  const createChainingPromiseMethod =\n    (method: typeof thenSymbol | typeof catchSymbol | typeof finallySymbol, source: Promise<any>) =>\n    (...args: any[]) => {\n      const nextPromise = (source as any)[method].apply(source, args);\n      return promiEvent(nextPromise);\n    };\n\n  /**\n   * Builds a `PromiEvent` by assigning `EventEmitter` methods to a native\n   * `Promise` object.\n   */\n  const promiEvent = (source: any) => {\n    return Object.assign(source, {\n      [promiEventBrand]: true,\n\n      [thenSymbol]: source[thenSymbol] || source.then,\n      [catchSymbol]: source[catchSymbol] || source.catch,\n      [finallySymbol]: source[finallySymbol] || source.finally,\n\n      then: createChainingPromiseMethod(thenSymbol, source),\n      catch: createChainingPromiseMethod(catchSymbol, source),\n      finally: createChainingPromiseMethod(finallySymbol, source),\n\n      on: createChainingEmitterMethod('on', source),\n      once: createChainingEmitterMethod('once', source),\n      addListener: createChainingEmitterMethod('addListener', source),\n\n      off: createChainingEmitterMethod('off', source),\n      removeListener: createChainingEmitterMethod('removeListener', source),\n      removeAllListeners: createChainingEmitterMethod('removeAllListeners', source),\n\n      emit: createBoundEmitterMethod('emit'),\n      eventNames: createBoundEmitterMethod('eventNames'),\n      listeners: createBoundEmitterMethod('listeners'),\n      listenerCount: createBoundEmitterMethod('listenerCount'),\n    });\n  };\n\n  const result = promiEvent(\n    promise.then(\n      (resolved) => {\n        // Emit default completion events and resolve result.\n        result.emit('done', resolved);\n        result.emit('settled');\n        return resolved;\n      },\n\n      (err) => {\n        // Emit default error events and re-throw.\n        result.emit('error', err);\n        result.emit('settled');\n        throw err;\n      },\n    ),\n  );\n\n  return result;\n}\n\n/**\n * Creates a `Promise` with an **async executor** that automatically catches\n * errors occurring within the executor. Nesting promises in this way is usually\n * deemed an _anti-pattern_, but it's useful and clean when promisifying the\n * event-based code that's inherent to JSON RPC.\n *\n * So, here we solve the issue of nested promises by ensuring that no errors\n * mistakenly go unhandled!\n */\nexport function createPromise<TResult>(executor: AsyncPromiseExecutor<TResult>) {\n  return new Promise<TResult>((resolve, reject) => {\n    const result = executor(resolve, reject);\n    Promise.resolve(result).catch(reject);\n  });\n}\n","export function isMajorVersionAtLeast(version: string, majorVersion: number): boolean {\n  // Split the version string into major, minor, and patch versions\n  const [major] = version.split('.').map(Number);\n\n  // Check if the major version is at least the required major version\n  return major >= majorVersion;\n}\n","import {\n  GetIdTokenConfiguration,\n  MagicPayloadMethod,\n  MagicUserMetadata,\n  GenerateIdTokenConfiguration,\n  UserInfo,\n  RequestUserInfoScope,\n  RecoverAccountConfiguration,\n  ShowSettingsConfiguration,\n} from '@magic-sdk/types';\nimport { getItem, setItem, removeItem } from '../util/storage';\nimport { BaseModule } from './base-module';\nimport { createJsonRpcRequestPayload } from '../core/json-rpc';\nimport { createDeprecationWarning } from '../core/sdk-exceptions';\nimport { ProductConsolidationMethodRemovalVersions } from './auth';\nimport { clearDeviceShares } from '../util/device-share-web-crypto';\nimport { createPromiEvent } from '../util';\n\ntype UserLoggedOutCallback = (loggedOut: boolean) => void;\n\nexport class UserModule extends BaseModule {\n  public getIdToken(configuration?: GetIdTokenConfiguration) {\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.GetIdTokenTestMode : MagicPayloadMethod.GetIdToken,\n      [configuration],\n    );\n    return this.request<string>(requestPayload);\n  }\n\n  public generateIdToken(configuration?: GenerateIdTokenConfiguration) {\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.GenerateIdTokenTestMode : MagicPayloadMethod.GenerateIdToken,\n      [configuration],\n    );\n    return this.request<string>(requestPayload);\n  }\n\n  public async getInfo() {\n    const activeWallet = await getItem(this.localForageKey);\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.GetInfo, [{ walletType: activeWallet }]);\n    return this.request<MagicUserMetadata>(requestPayload);\n  }\n\n  public isLoggedIn() {\n    return createPromiEvent<boolean, any>(async (resolve, reject) => {\n      try {\n        let cachedIsLoggedIn = false;\n        if (this.sdk.useStorageCache) {\n          cachedIsLoggedIn = (await getItem(this.localForageIsLoggedInKey)) === 'true';\n\n          // if isLoggedIn is true on storage, optimistically resolve with true\n          // if it is false, we use `usr.isLoggedIn` as the source of truth.\n          if (cachedIsLoggedIn) {\n            resolve(true);\n          }\n        }\n\n        const requestPayload = createJsonRpcRequestPayload(\n          this.sdk.testMode ? MagicPayloadMethod.IsLoggedInTestMode : MagicPayloadMethod.IsLoggedIn,\n        );\n        const isLoggedInResponse = await this.request<boolean>(requestPayload);\n        if (this.sdk.useStorageCache) {\n          if (isLoggedInResponse) {\n            setItem(this.localForageIsLoggedInKey, true);\n          } else {\n            removeItem(this.localForageIsLoggedInKey);\n          }\n          if (cachedIsLoggedIn && !isLoggedInResponse) {\n            this.emitUserLoggedOut(true);\n          }\n        }\n        resolve(isLoggedInResponse);\n      } catch (err) {\n        reject(err);\n      }\n    });\n  }\n\n  public logout() {\n    removeItem(this.localForageKey);\n    removeItem(this.localForageIsLoggedInKey);\n    clearDeviceShares();\n\n    return createPromiEvent<boolean, any>(async (resolve, reject) => {\n      try {\n        const requestPayload = createJsonRpcRequestPayload(\n          this.sdk.testMode ? MagicPayloadMethod.LogoutTestMode : MagicPayloadMethod.Logout,\n        );\n        const response = await this.request<boolean>(requestPayload);\n        if (this.sdk.useStorageCache) {\n          this.emitUserLoggedOut(response);\n        }\n        resolve(response);\n      } catch (err) {\n        reject(err);\n      }\n    });\n  }\n\n  /* Request email address from logged in user */\n  public requestInfoWithUI(scope?: RequestUserInfoScope) {\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.RequestUserInfoWithUI, scope ? [scope] : []);\n    return this.request<UserInfo>(requestPayload);\n  }\n\n  public showSettings(configuration?: ShowSettingsConfiguration) {\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.UserSettingsTestMode : MagicPayloadMethod.UserSettings,\n      [configuration],\n    );\n    return this.request<MagicUserMetadata>(requestPayload);\n  }\n\n  public recoverAccount(configuration: RecoverAccountConfiguration) {\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.RecoverAccountTestMode : MagicPayloadMethod.RecoverAccount,\n      [configuration],\n    );\n    return this.request<boolean | null>(requestPayload);\n  }\n\n  public revealPrivateKey() {\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.RevealPK);\n    return this.request<boolean>(requestPayload);\n  }\n\n  // Deprecating\n  public getMetadata() {\n    createDeprecationWarning({\n      method: 'user.getMetadata()',\n      removalVersions: ProductConsolidationMethodRemovalVersions,\n      useInstead: 'user.getInfo()',\n    }).log();\n    const requestPayload = createJsonRpcRequestPayload(\n      this.sdk.testMode ? MagicPayloadMethod.GetMetadataTestMode : MagicPayloadMethod.GetMetadata,\n    );\n    return this.request<MagicUserMetadata>(requestPayload);\n  }\n\n  public onUserLoggedOut(callback: UserLoggedOutCallback): void {\n    this.userLoggedOutCallbacks.push(callback);\n  }\n\n  // Private members\n  private emitUserLoggedOut(loggedOut: boolean): void {\n    this.userLoggedOutCallbacks.forEach((callback) => {\n      callback(loggedOut);\n    });\n  }\n\n  private localForageKey = 'mc_active_wallet';\n  private localForageIsLoggedInKey = 'magic_auth_is_logged_in';\n  private userLoggedOutCallbacks: UserLoggedOutCallback[] = [];\n}\n","import { SDKEnvironment } from '../core/sdk-environment';\n\nlet lf: LocalForage;\n\n/**\n * Proxies `localforage` methods with strong-typing.\n */\nfunction proxyLocalForageMethod<TMethod extends keyof LocalForageDbMethods>(method: TMethod): LocalForage[TMethod] {\n  return async (...args: any[]) => {\n    /* istanbul ignore else */\n    if (!lf) lf = await SDKEnvironment.configureStorage();\n    await lf.ready();\n    return (lf[method] as any)(...args);\n  };\n}\n\nexport const getItem = proxyLocalForageMethod('getItem');\nexport const setItem = proxyLocalForageMethod('setItem');\nexport const removeItem = proxyLocalForageMethod('removeItem');\nexport const clear = proxyLocalForageMethod('clear');\nexport const length = proxyLocalForageMethod('length');\nexport const key = proxyLocalForageMethod('key');\nexport const keys = proxyLocalForageMethod('keys');\nexport const iterate = proxyLocalForageMethod('iterate');\n","/* eslint-disable no-bitwise */\nexport function uuid() {\n  const u = window.crypto.getRandomValues(new Uint8Array(16));\n\n  // set the version bit to v4\n  u[6] = (u[6] & 0x0f) | 0x40;\n\n  // set the variant bit to \"don't care\" (yes, the RFC\n  // calls it that)\n  u[8] = (u[8] & 0xbf) | 0x80;\n\n  // hex encode them and add the dashes\n  let uid = '';\n  uid += u[0].toString(16);\n  uid += u[1].toString(16);\n  uid += u[2].toString(16);\n  uid += u[3].toString(16);\n  uid += '-';\n\n  uid += u[4].toString(16);\n  uid += u[5].toString(16);\n  uid += '-';\n\n  uid += u[6].toString(16);\n  uid += u[7].toString(16);\n  uid += '-';\n\n  uid += u[8].toString(16);\n  uid += u[9].toString(16);\n  uid += '-';\n\n  uid += u[10].toString(16);\n  uid += u[11].toString(16);\n  uid += u[12].toString(16);\n  uid += u[13].toString(16);\n  uid += u[14].toString(16);\n  uid += u[15].toString(16);\n\n  return uid;\n}\n","import { setItem, getItem, removeItem } from './storage';\nimport { uuid } from './uuid';\n\nexport const STORE_KEY_PRIVATE_KEY = 'STORE_KEY_PRIVATE_KEY';\nexport const STORE_KEY_PUBLIC_JWK = 'STORE_KEY_PUBLIC_JWK';\nconst ALGO_NAME = 'ECDSA';\nconst ALGO_CURVE = 'P-256';\n\nconst EC_GEN_PARAMS: EcKeyGenParams = {\n  name: ALGO_NAME,\n  namedCurve: ALGO_CURVE,\n};\n\nexport function isWebCryptoSupported() {\n  const hasCrypto = typeof window !== 'undefined' && !!(window.crypto as any);\n  const hasSubtleCrypto = hasCrypto && !!(window.crypto.subtle as any);\n\n  return hasCrypto && hasSubtleCrypto;\n}\n\nexport function clearKeys() {\n  removeItem(STORE_KEY_PUBLIC_JWK);\n  removeItem(STORE_KEY_PRIVATE_KEY);\n}\n\nexport async function createJwt() {\n  // will return undefiend is webcrypto is not supported\n  const publicJwk = await getPublicKey();\n\n  if (!publicJwk) {\n    console.info('unable to create public key or webcrypto is unsupported');\n    return undefined;\n  }\n\n  const { subtle } = window.crypto;\n  const privateJwk = await getItem<CryptoKey>(STORE_KEY_PRIVATE_KEY);\n\n  if (!privateJwk || !subtle) {\n    console.info('unable to find private key or webcrypto unsupported');\n    return undefined;\n  }\n\n  const claims = {\n    iat: Math.floor(new Date().getTime() / 1000),\n    jti: uuid(),\n  };\n\n  const headers = {\n    typ: 'dpop+jwt',\n    alg: 'ES256',\n    jwk: publicJwk,\n  };\n\n  const jws = {\n    protected: strToUrlBase64(JSON.stringify(headers)),\n    claims: strToUrlBase64(JSON.stringify(claims)),\n  };\n\n  const data = strToUint8(`${jws.protected}.${jws.claims}`);\n  const sigType = { name: ALGO_NAME, hash: { name: 'SHA-256' } };\n\n  const sig = uint8ToUrlBase64(new Uint8Array(await subtle.sign(sigType, privateJwk, data)));\n  return `${jws.protected}.${jws.claims}.${sig}`;\n}\n\nasync function getPublicKey() {\n  if (!isWebCryptoSupported()) {\n    console.info('webcrypto is not supported');\n    return undefined;\n  }\n\n  if (!(await getItem(STORE_KEY_PUBLIC_JWK))) {\n    await generateWCKP();\n  }\n\n  return getItem(STORE_KEY_PUBLIC_JWK) as JsonWebKey;\n}\n\nasync function generateWCKP() {\n  // to avoid a nasty babel bug we have to hoist this above the await ourselves\n  // https://github.com/rpetrich/babel-plugin-transform-async-to-promises/issues/20\n  const { subtle } = window.crypto;\n  const kp = await subtle.generateKey(\n    EC_GEN_PARAMS,\n    false, // need to export the public key, while keep private key non-extractable\n    ['sign'],\n  );\n\n  const jwkPublicKey = await subtle.exportKey('jwk', kp.publicKey!);\n\n  // persist keys\n  await setItem(STORE_KEY_PRIVATE_KEY, kp.privateKey!);\n  // persist the jwk public key since it needs to be exported anyways\n  await setItem(STORE_KEY_PUBLIC_JWK, jwkPublicKey);\n}\n\nfunction strToUrlBase64(str: string) {\n  return binToUrlBase64(utf8ToBinaryString(str));\n}\n\nfunction strToUint8(str: string) {\n  return new TextEncoder().encode(str);\n}\n\nfunction binToUrlBase64(bin: string) {\n  return btoa(bin).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+/g, '');\n}\n\nfunction utf8ToBinaryString(str: string) {\n  const escstr = encodeURIComponent(str);\n  // replaces any uri escape sequence, such as %0A,\n  // with binary escape, such as 0x0A\n  return escstr.replace(/%([0-9A-F]{2})/g, (_, p1) => String.fromCharCode(parseInt(p1, 16)));\n}\n\nfunction uint8ToUrlBase64(uint8: Uint8Array) {\n  let bin = '';\n  uint8.forEach((code) => {\n    bin += String.fromCharCode(code);\n  });\n  return binToUrlBase64(bin);\n}\n","import { getItem, iterate, removeItem, setItem } from './storage';\nimport { isWebCryptoSupported } from './web-crypto';\n\nexport const DEVICE_SHARE_KEY = 'ds';\nexport const ENCRYPTION_KEY_KEY = 'ek';\nexport const INITIALIZATION_VECTOR_KEY = 'iv';\n\nconst ALGO_NAME = 'AES-GCM'; // for encryption\nconst ALGO_LENGTH = 256;\n\nexport async function clearDeviceShares() {\n  const keysToRemove: string[] = [];\n  await iterate((value, key, iterationNumber) => {\n    if (key.startsWith(`${DEVICE_SHARE_KEY}_`)) {\n      keysToRemove.push(key);\n    }\n  });\n  for (const key of keysToRemove) {\n    // eslint-disable-next-line no-await-in-loop\n    await removeItem(key);\n  }\n}\n\nfunction arrayBufferToBase64(buffer: ArrayBuffer) {\n  let binary = '';\n  const bytes = new Uint8Array(buffer);\n  const len = bytes.byteLength;\n  for (let i = 0; i < len; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return window.btoa(binary);\n}\n\nexport function base64ToArrayBuffer(base64: string) {\n  const binaryString = window.atob(base64);\n  const len = binaryString.length;\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) {\n    bytes[i] = binaryString.charCodeAt(i);\n  }\n  return bytes.buffer;\n}\n\nasync function getOrCreateInitVector() {\n  if (!isWebCryptoSupported()) {\n    console.info('webcrypto is not supported');\n    return undefined;\n  }\n  const { crypto } = window;\n  const existingIv = (await getItem(INITIALIZATION_VECTOR_KEY)) as Uint8Array;\n  if (existingIv) {\n    return existingIv;\n  }\n\n  const iv = crypto.getRandomValues(new Uint8Array(12)); // 12 bytes for AES-GCM\n  return iv;\n}\n\nasync function getOrCreateEncryptionKey() {\n  if (!isWebCryptoSupported()) {\n    console.info('webcrypto is not supported');\n    return undefined;\n  }\n  const { subtle } = window.crypto;\n  const existingKey = (await getItem(ENCRYPTION_KEY_KEY)) as CryptoKey;\n  if (existingKey) {\n    return existingKey;\n  }\n\n  const key = await subtle.generateKey(\n    { name: ALGO_NAME, length: ALGO_LENGTH },\n    false, // non-extractable\n    ['encrypt', 'decrypt'],\n  );\n  return key;\n}\n\nexport async function encryptAndPersistDeviceShare(deviceShareBase64: string, networkHash: string): Promise<void> {\n  const iv = await getOrCreateInitVector();\n  const encryptionKey = await getOrCreateEncryptionKey();\n\n  if (!iv || !encryptionKey || !deviceShareBase64) {\n    return;\n  }\n  const decodedDeviceShare = base64ToArrayBuffer(deviceShareBase64);\n\n  const { subtle } = window.crypto;\n\n  const encryptedData = await subtle.encrypt(\n    {\n      name: ALGO_NAME,\n      iv,\n    },\n    encryptionKey,\n    decodedDeviceShare,\n  );\n\n  // The encrypted device share we store is a base64 encoded string representation\n  // of the magic kms encrypted client share encrypted with webcrypto\n  const encryptedDeviceShare = arrayBufferToBase64(encryptedData);\n\n  await setItem(`${DEVICE_SHARE_KEY}_${networkHash}`, encryptedDeviceShare);\n  await setItem(ENCRYPTION_KEY_KEY, encryptionKey);\n  await setItem(INITIALIZATION_VECTOR_KEY, iv);\n}\n\nexport async function getDecryptedDeviceShare(networkHash: string): Promise<string | undefined> {\n  const encryptedDeviceShare = await getItem<string>(`${DEVICE_SHARE_KEY}_${networkHash}`);\n  const iv = (await getItem(INITIALIZATION_VECTOR_KEY)) as Uint8Array; // use existing encryption key and initialization vector\n  const encryptionKey = (await getItem(ENCRYPTION_KEY_KEY)) as CryptoKey;\n\n  if (!iv || !encryptedDeviceShare || !encryptionKey || !isWebCryptoSupported()) {\n    return undefined;\n  }\n\n  const { subtle } = window.crypto;\n  const ab = await subtle.decrypt({ name: ALGO_NAME, iv }, encryptionKey, base64ToArrayBuffer(encryptedDeviceShare));\n\n  return arrayBufferToBase64(ab);\n}\n","/**\n * Builds a `URL` object safely.\n */\nexport function createURL(url: string, base?: string): URL {\n  // Safari raises an error if `undefined` is given to the second argument of\n  // the `URL` constructor.\n  return base ? new URL(url, base) : new URL(url);\n}\n","import {\n  Events,\n  GasApiResponse,\n  MagicPayloadMethod,\n  GaslessTransactionRequest,\n  RequestUserInfoScope,\n  UserEnv,\n  UserInfo,\n  WalletInfo,\n  Wallets,\n} from '@magic-sdk/types';\n\nimport { BaseModule } from './base-module';\nimport { createJsonRpcRequestPayload } from '../core/json-rpc';\nimport { createDeprecationWarning } from '../core/sdk-exceptions';\nimport { setItem, getItem, removeItem } from '../util/storage';\nimport { ProductConsolidationMethodRemovalVersions } from './auth';\nimport { createPromiEvent } from '../util';\nimport { clearDeviceShares } from '../util/device-share-web-crypto';\n\nexport type ConnectWithUiEvents = {\n  'id-token-created': (params: { idToken: string }) => void;\n  wallet_selected: (params: { wallet: Wallets }) => any;\n};\n\ntype ShowUiConfig = {\n  onramperParams?: { [key: string]: string };\n};\n\nexport class WalletModule extends BaseModule {\n  /* Prompt Magic's Login Form */\n  public connectWithUI() {\n    const promiEvent = createPromiEvent<string[], ConnectWithUiEvents>(async (resolve, reject) => {\n      try {\n        // If within metamask wallet browser, auto-connect without any UI (if dapp has metamask enabled)\n        if (this.isMetaMaskBrowser() && (await this.isWalletEnabled(Wallets.MetaMask))) {\n          const result = await this.autoConnectIfWalletBrowser(Wallets.MetaMask);\n          resolve(result);\n          return;\n        }\n        // If within coinbase wallet browser, auto-connect without any UI (if dapp has coinbase enabled)\n        if (this.isCoinbaseWalletBrowser() && (await this.isWalletEnabled(Wallets.CoinbaseWallet))) {\n          const result = await this.autoConnectIfWalletBrowser(Wallets.CoinbaseWallet);\n          resolve(result);\n          return;\n        }\n        const userEnv = this.getUserEnv();\n        const loginRequestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.Login, [userEnv]);\n        const loginRequest = this.request<string[], ConnectWithUiEvents>(loginRequestPayload);\n        loginRequest.on(Events.WalletSelected as any, (params: { wallet: Wallets }) =>\n          this.handleWalletSelected({ ...params, payloadId: loginRequestPayload.id as number }),\n        );\n        loginRequest.on('id-token-created' as any, (params: { idToken: string }) => {\n          promiEvent.emit('id-token-created', params);\n        });\n        const result = await loginRequest;\n        if ((result as any).error) reject(result);\n        resolve(result);\n      } catch (error) {\n        reject(error);\n      }\n    });\n    return promiEvent;\n  }\n\n  /* Prompt Magic's Wallet UI (not available for users logged in with third party wallets) */\n  public showUI(config?: ShowUiConfig) {\n    return this.request<boolean>(createJsonRpcRequestPayload(MagicPayloadMethod.ShowUI, [config]));\n  }\n\n  public showAddress() {\n    return this.request<boolean>(createJsonRpcRequestPayload(MagicPayloadMethod.ShowAddress));\n  }\n\n  public showSendTokensUI() {\n    return this.request<boolean>(createJsonRpcRequestPayload(MagicPayloadMethod.ShowSendTokensUI));\n  }\n\n  public showOnRamp() {\n    return this.request<boolean>(createJsonRpcRequestPayload(MagicPayloadMethod.ShowOnRamp));\n  }\n\n  public showNFTs() {\n    return this.request<boolean>(createJsonRpcRequestPayload(MagicPayloadMethod.ShowNFTs));\n  }\n\n  public showBalances() {\n    return this.request<boolean>(createJsonRpcRequestPayload(MagicPayloadMethod.ShowBalances));\n  }\n\n  public sendGaslessTransaction(address: string, transaction: GaslessTransactionRequest) {\n    return this.request<GasApiResponse>(\n      createJsonRpcRequestPayload(MagicPayloadMethod.SendGaslessTransaction, [address, transaction]),\n    );\n  }\n\n  /* Get user info such as the wallet type they are logged in with */\n  // deprecating\n  public async getInfo() {\n    createDeprecationWarning({\n      method: 'wallet.getInfo()',\n      removalVersions: ProductConsolidationMethodRemovalVersions,\n      useInstead: 'user.getInfo()',\n    }).log();\n    const activeWallet = await getItem(this.localForageKey);\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.GetInfo, [{ walletType: activeWallet }]);\n    return this.request<WalletInfo>(requestPayload);\n  }\n\n  /* Logout user */\n  // deprecating\n  public disconnect() {\n    createDeprecationWarning({\n      method: 'wallet.disconnect()',\n      removalVersions: ProductConsolidationMethodRemovalVersions,\n      useInstead: 'user.logout()',\n    }).log();\n    removeItem(this.localForageKey);\n    clearDeviceShares();\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.Disconnect);\n    return this.request<boolean>(requestPayload);\n  }\n\n  /* Request email address from logged in user */\n  // deprecating\n  public requestUserInfoWithUI(scope?: RequestUserInfoScope) {\n    createDeprecationWarning({\n      method: 'wallet.requestUserInfoWithUI()',\n      removalVersions: ProductConsolidationMethodRemovalVersions,\n      useInstead: 'user.requestUserInfoWithUI()',\n    }).log();\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.RequestUserInfoWithUI, scope ? [scope] : []);\n    return this.request<UserInfo>(requestPayload);\n  }\n\n  /* Returns the provider for the connected wallet */\n  public async getProvider(): Promise<any> {\n    const activeWallet = await getItem(this.localForageKey);\n    switch (activeWallet) {\n      case Wallets.MetaMask:\n        return this.getMetaMaskProvider();\n      case Wallets.CoinbaseWallet:\n        return this.getCoinbaseProvider();\n      default:\n        return this.sdk.rpcProvider;\n    }\n  }\n\n  /* Private methods */\n\n  private localForageKey = 'mc_active_wallet';\n\n  /* MetaMask */\n  private isMetaMaskInstalled(): boolean {\n    return (\n      (window as any).ethereum?.isMetaMask ||\n      !!(window as any).ethereum?.providers?.find((provider: any) => provider?.isMetaMask)\n    );\n  }\n\n  private isMetaMaskBrowser(): boolean {\n    return this.isMobile() && this.isMetaMaskInstalled();\n  }\n\n  private getMetaMaskProvider(): any {\n    return (window as any).ethereum?.providers?.find((p: any) => p?.isMetaMask) || (window as any).ethereum;\n  }\n\n  private connectToMetaMask(): Promise<string[]> {\n    // Redirect to MetaMask app if user selects MetaMask on mobile\n    if (this.isMobile() && !this.isMetaMaskInstalled()) {\n      const metaMaskDeepLink = `https://metamask.app.link/dapp/${window.location.href.replace(/(^\\w+:|^)\\/\\//, '')}`;\n      window.location.href = metaMaskDeepLink;\n    }\n    return this.getMetaMaskProvider().request({ method: 'eth_requestAccounts' });\n  }\n\n  /* Coinbase Wallet */\n  private isCoinbaseWalletInstalled(): boolean {\n    return (\n      (window as any).ethereum?.isCoinbaseWallet ||\n      !!(window as any).ethereum?.providers?.find((provider: any) => provider?.isCoinbaseWallet)\n    );\n  }\n\n  private isCoinbaseWalletBrowser(): boolean {\n    return !!(window as any).ethereum?.isCoinbaseBrowser;\n  }\n\n  private getCoinbaseProvider(): any {\n    return (window as any).ethereum?.providers?.find((p: any) => p?.isCoinbaseWallet) || (window as any).ethereum;\n  }\n\n  private connectToCoinbaseWallet(): Promise<string[]> {\n    // Redirect to Coinbase Wallet app if user selects Coinbase Wallet on mobile\n    if (this.isMobile() && !this.isCoinbaseWalletBrowser()) {\n      const coinbaseWalletDeepLink = `https://go.cb-w.com/dapp?cb_url=${encodeURIComponent(window.location.href)}`;\n      window.location.href = coinbaseWalletDeepLink;\n    }\n    const provider = this.getCoinbaseProvider();\n    return provider.request({ method: 'eth_requestAccounts' });\n  }\n\n  /* Helpers */\n  private isMobile(): boolean {\n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Silk|Opera Mini/i.test(\n      navigator.userAgent,\n    );\n  }\n\n  private getUserEnv(): UserEnv {\n    return {\n      env: {\n        isMetaMaskInstalled: this.isMetaMaskInstalled(),\n        isCoinbaseWalletInstalled: this.isCoinbaseWalletInstalled(),\n      },\n    };\n  }\n\n  private connectToThirdPartyWallet(provider: Wallets): Promise<any> {\n    switch (provider) {\n      case Wallets.MetaMask:\n        return this.connectToMetaMask();\n      case Wallets.CoinbaseWallet:\n        return this.connectToCoinbaseWallet();\n      default:\n        throw new Error(`Invalid provider: ${provider}. Must be one of \"metamask\" or \"coinbase_wallet\".`);\n    }\n  }\n\n  private isWalletEnabled(wallet: Wallets): Promise<boolean> {\n    const isWalletEnabled = createJsonRpcRequestPayload('mc_is_wallet_enabled', [{ wallet }]);\n    return this.request<boolean>(isWalletEnabled);\n  }\n\n  /* Triggers connection to wallet, emits success/reject event back to iframe */\n  private async handleWalletSelected(params: { wallet: Wallets; payloadId: number }) {\n    try {\n      const address = await this.connectToThirdPartyWallet(params.wallet);\n      await setItem(this.localForageKey, params.wallet);\n      this.createIntermediaryEvent(Events.WalletConnected as any, params.payloadId as any)(address);\n    } catch (error) {\n      console.error(error);\n      this.createIntermediaryEvent(Events.WalletRejected as any, params.payloadId as any)();\n    }\n  }\n\n  private async autoConnectIfWalletBrowser(wallet: Wallets): Promise<string[]> {\n    let address;\n    if (wallet === Wallets.MetaMask) {\n      address = await this.getMetaMaskProvider().request({ method: 'eth_requestAccounts' });\n    }\n    if (wallet === Wallets.CoinbaseWallet) {\n      address = await this.getCoinbaseProvider().request({ method: 'eth_requestAccounts' });\n    }\n    await setItem(this.localForageKey, wallet);\n    const autoConnectPayload = createJsonRpcRequestPayload(MagicPayloadMethod.AutoConnect, [{ wallet, address }]);\n    const autoConnectRequest = this.request<string[]>(autoConnectPayload);\n    return autoConnectRequest;\n  }\n}\n","/* eslint-disable consistent-return, prefer-spread */\n\nimport {\n  JsonRpcRequestPayload,\n  JsonRpcRequestCallback,\n  MagicOutgoingWindowMessage,\n  JsonRpcBatchRequestCallback,\n  JsonRpcResponsePayload,\n  ProviderEnableEvents,\n  MagicPayloadMethod,\n} from '@magic-sdk/types';\nimport { BaseModule } from './base-module';\nimport { createInvalidArgumentError, MagicRPCError, createSynchronousWeb3MethodWarning } from '../core/sdk-exceptions';\nimport { createJsonRpcRequestPayload, standardizeJsonRpcRequestPayload, JsonRpcResponse } from '../core/json-rpc';\nimport { PromiEvent } from '../util/promise-tools';\nimport { createTypedEmitter, EventsDefinition, TypedEmitter } from '../util/events';\n\nconst { createBoundEmitterMethod, createChainingEmitterMethod } = createTypedEmitter();\n\n/** */\nexport class RPCProviderModule extends BaseModule implements TypedEmitter {\n  // Implements EIP 1193:\n  // https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1193.md\n\n  public readonly isMagic = true;\n\n  /* eslint-disable prettier/prettier */\n  public sendAsync(payload: Partial<JsonRpcRequestPayload>, onRequestComplete: JsonRpcRequestCallback): void;\n  public sendAsync(payload: Partial<JsonRpcRequestPayload>[], onRequestComplete: JsonRpcBatchRequestCallback): void;\n  public sendAsync(\n    payload: Partial<JsonRpcRequestPayload> | Partial<JsonRpcRequestPayload>[],\n    onRequestComplete: JsonRpcRequestCallback | JsonRpcBatchRequestCallback,\n  ): void;\n  /* eslint-enable prettier/prettier */\n  public sendAsync(\n    payload: Partial<JsonRpcRequestPayload> | Partial<JsonRpcRequestPayload>[],\n    onRequestComplete: JsonRpcRequestCallback | JsonRpcBatchRequestCallback,\n  ): void {\n    if (!onRequestComplete) {\n      throw createInvalidArgumentError({\n        procedure: 'Magic.rpcProvider.sendAsync',\n        argument: 1,\n        expected: 'function',\n        received: onRequestComplete === null ? 'null' : typeof onRequestComplete,\n      });\n    }\n\n    if (Array.isArray(payload)) {\n      this.overlay\n        .post(\n          MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,\n          payload.map((p) => {\n            const standardizedPayload = standardizeJsonRpcRequestPayload(p);\n            this.prefixPayloadMethodForTestMode(standardizedPayload);\n            return standardizedPayload;\n          }),\n        )\n        .then((batchResponse) => {\n          (onRequestComplete as JsonRpcBatchRequestCallback)(\n            null,\n            batchResponse.map((response) => ({\n              ...response.payload,\n              error: response.hasError ? new MagicRPCError(response.payload.error) : null,\n            })),\n          );\n        });\n    } else {\n      const finalPayload = standardizeJsonRpcRequestPayload(payload);\n      this.prefixPayloadMethodForTestMode(finalPayload);\n      this.overlay.post(MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST, finalPayload).then((response) => {\n        (onRequestComplete as JsonRpcRequestCallback)(\n          response.hasError ? new MagicRPCError(response.payload.error) : null,\n          response.payload,\n        );\n      });\n    }\n  }\n\n  /* eslint-disable prettier/prettier */\n  public send<ResultType = any>(method: string, params?: any[]): PromiEvent<ResultType>;\n  public send(\n    payload: JsonRpcRequestPayload | JsonRpcRequestPayload[],\n    onRequestComplete: JsonRpcRequestCallback,\n  ): void;\n  public send<ResultType>(payload: JsonRpcRequestPayload, none: void): JsonRpcResponsePayload<ResultType>;\n  /* eslint-enable prettier/prettier */\n  public send<ResultType = any>(\n    payloadOrMethod: string | JsonRpcRequestPayload | JsonRpcRequestPayload[],\n    onRequestCompleteOrParams: JsonRpcRequestCallback | any[] | void,\n  ): PromiEvent<ResultType> | JsonRpcResponsePayload<ResultType> | void {\n    // Case #1\n    // Web3 >= 1.0.0-beta.38 calls `send` with method and parameters.\n    if (typeof payloadOrMethod === 'string') {\n      const payload = createJsonRpcRequestPayload(\n        payloadOrMethod,\n        Array.isArray(onRequestCompleteOrParams) ? onRequestCompleteOrParams : [],\n      );\n      return this.request(payload) as any;\n    }\n\n    // Case #2\n    // Web3 <= 1.0.0-beta.37 uses `send` with a callback for async queries.\n    if (Array.isArray(payloadOrMethod) || !!onRequestCompleteOrParams) {\n      /* eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion */\n      this.sendAsync(payloadOrMethod, onRequestCompleteOrParams as any);\n      return;\n    }\n\n    // Case #3\n    // Legacy synchronous methods (unsupported).\n    const warning = createSynchronousWeb3MethodWarning();\n    warning.log();\n    return new JsonRpcResponse(payloadOrMethod).applyError({\n      code: -32603,\n      message: warning.rawMessage,\n    }).payload;\n  }\n\n  public enable() {\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.Login);\n    return this.request<string[], ProviderEnableEvents>(requestPayload);\n  }\n\n  /**\n   * Here, we wrap `BaseModule.request` with an additional check\n   * to determine if the RPC method requires a test-mode prefix.\n   */\n  protected request<ResultType = any, Events extends EventsDefinition = void>(payload: Partial<JsonRpcRequestPayload>) {\n    this.prefixPayloadMethodForTestMode(payload);\n    return super.request<ResultType, Events>(payload);\n  }\n\n  /**\n   * Prefixes Ethereum RPC methods with a `testMode` identifier. This is done so\n   * that Magic's <iframe> can handle signing methods using test-specific keys.\n   */\n  private prefixPayloadMethodForTestMode(payload: Partial<JsonRpcRequestPayload>) {\n    const testModePrefix = 'testMode/eth/';\n\n    // In test mode, we prefix all RPC methods with `test/` so that the\n    // Magic <iframe> can handle them without requiring network calls.\n    if (this.sdk.testMode) {\n      // eslint-disable-next-line no-param-reassign\n      payload.method = `${testModePrefix}${payload.method}`;\n    }\n  }\n\n  public on = createChainingEmitterMethod('on', this);\n  public once = createChainingEmitterMethod('once', this);\n  public addListener = createChainingEmitterMethod('addListener', this);\n\n  public off = createChainingEmitterMethod('off', this);\n  public removeListener = createChainingEmitterMethod('removeListener', this);\n  public removeAllListeners = createChainingEmitterMethod('removeAllListeners', this);\n\n  public emit = createBoundEmitterMethod('emit');\n  public eventNames = createBoundEmitterMethod('eventNames');\n  public listeners = createBoundEmitterMethod('listeners');\n  public listenerCount = createBoundEmitterMethod('listenerCount');\n}\n","import { createJsonRpcRequestPayload, standardizeJsonRpcRequestPayload } from '../core/json-rpc';\nimport { BaseModule } from './base-module';\nimport { SDKBase, MagicSDKAdditionalConfiguration, MagicSDKExtensionsOption } from '../core/sdk';\nimport { createExtensionNotInitializedError, MagicExtensionError, MagicExtensionWarning } from '../core/sdk-exceptions';\nimport { createPromiEvent, encodeJSON, decodeJSON, storage, isPromiEvent } from '../util';\n\ntype AnonymousExtension = 'anonymous extension';\n\ninterface BaseExtension<TName extends string = AnonymousExtension> extends BaseModule {\n  /**\n   * A structure describing the platform and version compatiblity of this\n   * extension.\n   */\n  compat?: {\n    'magic-sdk': boolean | string;\n    '@magic-sdk/react-native': boolean | string;\n    '@magic-sdk/react-native-bare': boolean | string;\n    '@magic-sdk/react-native-expo': boolean | string;\n  };\n}\n\nconst sdkAccessFields = ['request', 'overlay', 'sdk'];\n\n/**\n * From the `BaseExtension`-derived instance, get the prototype\n * chain up to and including the `BaseModule` class.\n */\nfunction getPrototypeChain<T extends BaseExtension<string>>(instance: T) {\n  let currentProto = Object.getPrototypeOf(instance);\n  const protos = [currentProto];\n\n  while (currentProto !== BaseModule.prototype) {\n    currentProto = Object.getPrototypeOf(currentProto);\n    protos.push(currentProto);\n  }\n\n  return protos;\n}\n\nabstract class BaseExtension<TName extends string = AnonymousExtension> extends BaseModule {\n  public abstract readonly name: TName;\n\n  private __sdk_access_field_descriptors__ = new Map<\n    string,\n    { descriptor: PropertyDescriptor; isPrototypeField: boolean }\n  >();\n  private __is_initialized__ = false;\n\n  protected utils = {\n    createPromiEvent,\n    isPromiEvent,\n    encodeJSON,\n    decodeJSON,\n    createJsonRpcRequestPayload,\n    standardizeJsonRpcRequestPayload,\n    storage,\n  };\n\n  constructor() {\n    super(undefined as any);\n\n    // Disallow SDK access before initialization...\n\n    const allSources = [this, ...getPrototypeChain(this)];\n\n    sdkAccessFields.forEach((prop) => {\n      const allDescriptors = allSources.map((source) => Object.getOwnPropertyDescriptor(source, prop));\n      const sourceIndex = allDescriptors.findIndex((x) => !!x);\n      const isPrototypeField = sourceIndex > 0;\n      const descriptor = allDescriptors[sourceIndex];\n\n      /* istanbul ignore else */\n      if (descriptor) {\n        this.__sdk_access_field_descriptors__.set(prop, { descriptor, isPrototypeField });\n\n        Object.defineProperty(this, prop, {\n          configurable: true,\n          get: () => {\n            throw createExtensionNotInitializedError(prop);\n          },\n        });\n      }\n    });\n  }\n\n  /**\n   * Registers a Magic SDK instance with this Extension.\n   *\n   * @internal\n   */\n  public init(sdk: SDKBase) {\n    if (this.__is_initialized__) return;\n\n    // Replace original property descriptors\n    // for SDK access fields post-initialization.\n    sdkAccessFields.forEach((prop) => {\n      /* istanbul ignore else */\n      if (this.__sdk_access_field_descriptors__.has(prop)) {\n        const { descriptor, isPrototypeField } = this.__sdk_access_field_descriptors__.get(prop)!;\n\n        if (isPrototypeField) {\n          // For prototype fields, we just need the `delete` operator so that\n          // the instance will fallback to the prototype chain itself.\n          delete this[prop as keyof this];\n        } else {\n          Object.defineProperty(this, prop, descriptor);\n        }\n      }\n    });\n\n    this.sdk = sdk;\n    this.__is_initialized__ = true;\n  }\n\n  /**\n   * Creates a deprecation warning wrapped with a native Magic SDK warning type.\n   * Best practice is to warn users of upcoming deprecations at least one major\n   * version before the change is implemented. You can use this method to\n   * communicate deprecations in a manner consistent with Magic SDK core code.\n   */\n  protected createDeprecationWarning(options: {\n    method: string;\n    removalVersion: string;\n    useInstead?: string;\n  }): MagicExtensionWarning {\n    const { method, removalVersion, useInstead } = options;\n\n    const useInsteadSuffix = useInstead ? ` Use \\`${useInstead}\\` instead.` : '';\n    const message = `\\`${method}\\` will be removed from this Extension in version \\`${removalVersion}\\`.${useInsteadSuffix}`;\n    return new MagicExtensionWarning(this, 'DEPRECATION_NOTICE', message);\n  }\n\n  /**\n   * Creates a warning wrapped with a native Magic SDK warning type. This\n   * maintains consistency in warning messaging for consumers of Magic SDK and\n   * this Extension.\n   */\n  protected createWarning(code: string | number, message: string): MagicExtensionWarning {\n    return new MagicExtensionWarning(this, code, message);\n  }\n\n  /**\n   * Creates an error wrapped with a native Magic SDK error type. This maintains\n   * consistency in error handling for consumers of Magic SDK and this\n   * Extension.\n   */\n  protected createError<TData = any>(code: string | number, message: string, data: TData): MagicExtensionError<TData> {\n    return new MagicExtensionError<TData>(this, code, message, data);\n  }\n}\n\nabstract class InternalExtension<TName extends string, TConfig extends any = any> extends BaseExtension<TName> {\n  public abstract readonly config: TConfig;\n}\n\n/**\n * A base class representing \"extensions\" to the core Magic JS APIs. Extensions\n * enable new functionality by composing Magic endpoints methods together.\n */\nexport abstract class Extension<TName extends string = AnonymousExtension> extends BaseExtension<TName> {\n  /**\n   * This is a special constructor used to mark \"official\" extensions. These\n   * extensions are designed for special interaction with the Magic iframe using\n   * custom JSON RPC methods, business logic, and global configurations. This is\n   * intended for internal-use only (and provides no useful advantage to\n   * open-source extension developers over the regular `Extension` class).\n   *\n   * @internal\n   */\n  public static Internal = InternalExtension;\n  public static Anonymous: AnonymousExtension = 'anonymous extension';\n}\n\n/**\n * These fields are exposed on the `Extension` type,\n * but should be hidden from the public interface.\n */\ntype HiddenExtensionFields = 'name' | 'init' | 'config' | 'compat';\n\n/**\n * Gets the type contained in an array type.\n */\ntype UnwrapArray<T extends any[]> = T extends Array<infer P> ? P : never;\n\n/**\n * Create a union type of Extension names from an\n * array of Extension types given by `TExt`.\n */\ntype ExtensionNames<TExt extends Extension<string>[]> = UnwrapArray<TExt> extends Extension<infer R> ? R : never;\n\n/**\n * From the literal Extension name type given by `TExtName`,\n * extract a dictionary of Extension types.\n */\ntype GetExtensionFromName<TExt extends Extension<string>[], TExtName extends string> = {\n  [P in TExtName]: Extract<UnwrapArray<TExt>, Extension<TExtName>>;\n}[TExtName];\n\n/**\n * Wraps a Magic SDK constructor with the necessary type\n * information to support a strongly-typed `Extension` interface.\n */\nexport type WithExtensions<SDK extends SDKBase> = {\n  new <TCustomExtName extends string, TExt extends MagicSDKExtensionsOption<TCustomExtName>>(\n    apiKey: string,\n    options?: MagicSDKAdditionalConfiguration<TCustomExtName, TExt>,\n  ): InstanceWithExtensions<SDK, TExt>;\n};\n\nexport type InstanceWithExtensions<SDK extends SDKBase, TExt extends MagicSDKExtensionsOption> = SDK &\n  {\n    [P in Exclude<\n      TExt extends Extension<string>[] ? ExtensionNames<TExt> : keyof TExt,\n      number | AnonymousExtension\n    >]: TExt extends Extension<string>[]\n      ? Omit<GetExtensionFromName<TExt, P>, HiddenExtensionFields>\n      : TExt extends {\n          [P in Exclude<\n            TExt extends Extension<string>[] ? ExtensionNames<TExt> : keyof TExt,\n            number | AnonymousExtension\n          >]: Extension<string>;\n        }\n      ? Omit<TExt[P], HiddenExtensionFields>\n      : never;\n  };\n","import {\n  MagicPayloadMethod,\n  NFTCheckoutRequest,\n  NFTCheckoutResponse,\n  NFTPurchaseRequest,\n  NFTPurchaseResponse,\n  NFTTransferRequest,\n  NFTTransferResponse,\n} from '@magic-sdk/types';\nimport { BaseModule } from './base-module';\nimport { createJsonRpcRequestPayload } from '../core/json-rpc';\n\nexport class NFTModule extends BaseModule {\n  /* Start an NFT Purchase flow with Sardine */\n  public purchase(options: NFTPurchaseRequest) {\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.NFTPurchase, [options]);\n    return this.request<NFTPurchaseResponse>(requestPayload);\n  }\n\n  /* Start an NFT Checkout flow with Paypal */\n  public checkout(options: NFTCheckoutRequest) {\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.NFTCheckout, [options]);\n    return this.request<NFTCheckoutResponse>(requestPayload);\n  }\n\n  /* Start an NFT Transfer flow */\n  public transfer(options: NFTTransferRequest) {\n    const requestPayload = createJsonRpcRequestPayload(MagicPayloadMethod.NFTTransfer, [options]);\n    return this.request<NFTTransferResponse>(requestPayload);\n  }\n}\n","/* eslint-disable no-param-reassign  */\n\nimport { EthNetworkConfiguration, QueryParameters, SupportedLocale } from '@magic-sdk/types';\nimport type { AbstractProvider } from 'web3-core';\nimport { coerce, satisfies } from '../util/semver';\nimport { encodeJSON } from '../util/base64-json';\nimport {\n  createMissingApiKeyError,\n  createReactNativeEndpointConfigurationWarning,\n  createIncompatibleExtensionsError,\n} from './sdk-exceptions';\nimport { AuthModule } from '../modules/auth';\nimport { UserModule } from '../modules/user';\nimport { WalletModule } from '../modules/wallet';\nimport { RPCProviderModule } from '../modules/rpc-provider';\nimport { ViewController } from './view-controller';\nimport { createURL } from '../util/url';\nimport { Extension } from '../modules/base-extension';\nimport { isEmpty } from '../util/type-guards';\nimport { SDKEnvironment, sdkNameToEnvName } from './sdk-environment';\nimport { NFTModule } from '../modules/nft';\n\n/**\n * Checks if the given `ext` is compatible with the platform & version of Magic\n * SDK currently in use.\n */\nfunction checkExtensionCompat(ext: Extension<string>) {\n  if (ext.compat && ext.compat[SDKEnvironment.sdkName] != null) {\n    return typeof ext.compat[SDKEnvironment.sdkName] === 'string'\n      ? satisfies(coerce(SDKEnvironment.version), ext.compat[SDKEnvironment.sdkName] as string)\n      : !!ext.compat[SDKEnvironment.sdkName];\n  }\n\n  // To gracefully support older extensions, we assume\n  // compatibility when the `compat` field is missing.\n  return true;\n}\n\n/**\n * Generates a network hash of the SDK instance for persisting network specific\n * information on multichain setups\n */\nfunction getNetworkHash(apiKey: string, network?: EthNetworkConfiguration, extConfig?: any) {\n  if (!network && !extConfig) {\n    return `${apiKey}_eth_mainnet`;\n  }\n  if (extConfig) {\n    return `${apiKey}_${JSON.stringify(extConfig)}`;\n  }\n  if (network) {\n    if (typeof network === 'string') {\n      return `${apiKey}_eth_${network}`;\n    }\n    // Custom network, not necessarily eth.\n    return `${apiKey}_${network.rpcUrl}_${network.chainId}_${network.chainType}`;\n  }\n  return `${apiKey}_unknown`;\n}\n\n/**\n * Initializes SDK extensions, checks for platform/version compatiblity issues,\n * then consolidates any global configurations provided by those extensions.\n */\nfunction prepareExtensions(this: SDKBase, options?: MagicSDKAdditionalConfiguration): Record<string, any> {\n  const extensions: Extension<string>[] | { [key: string]: Extension<string> } = options?.extensions ?? [];\n  const extConfig: any = {};\n  const incompatibleExtensions: Extension<string>[] = [];\n\n  if (Array.isArray(extensions)) {\n    extensions.forEach((ext) => {\n      if (checkExtensionCompat(ext)) {\n        ext.init(this);\n        if (ext.name || ext.name !== Extension.Anonymous) {\n          // Only apply extensions with a known, defined `name` parameter.\n          (this as any)[ext.name] = ext;\n        }\n        if (ext instanceof Extension.Internal) {\n          if (!isEmpty(ext.config)) extConfig[ext.name] = ext.config;\n        }\n      } else {\n        incompatibleExtensions.push(ext);\n      }\n    });\n  } else {\n    Object.keys(extensions).forEach((name) => {\n      if (checkExtensionCompat(extensions[name])) {\n        extensions[name].init(this);\n        const ext = extensions[name];\n        (this as any)[name] = ext;\n        if (ext instanceof Extension.Internal) {\n          if (!isEmpty(ext.config)) extConfig[extensions[name].name] = ext.config;\n        }\n      } else {\n        incompatibleExtensions.push(extensions[name]);\n      }\n    });\n  }\n\n  if (incompatibleExtensions.length) {\n    throw createIncompatibleExtensionsError(incompatibleExtensions);\n  }\n\n  return extConfig;\n}\n\nexport type MagicSDKExtensionsOption<TCustomExtName extends string = string> =\n  | Extension<string>[]\n  | { [P in TCustomExtName]: Extension<string> };\n\nexport interface MagicSDKAdditionalConfiguration<\n  TCustomExtName extends string = string,\n  TExt extends MagicSDKExtensionsOption<TCustomExtName> = any,\n> {\n  endpoint?: string;\n  locale?: SupportedLocale;\n  network?: EthNetworkConfiguration;\n  extensions?: TExt;\n  testMode?: boolean;\n  deferPreload?: boolean;\n  useStorageCache?: boolean;\n  meta?: any; // Generic field for clients to add metadata\n}\n\nexport class SDKBase {\n  private static readonly __overlays__: Map<string, ViewController> = new Map();\n\n  protected readonly endpoint: string;\n  protected readonly parameters: string;\n  protected readonly networkHash: string;\n  public readonly testMode: boolean;\n  public readonly useStorageCache: boolean;\n\n  /**\n   * Contains methods for starting a Magic SDK authentication flow.\n   */\n  public readonly auth: AuthModule;\n\n  /**\n   * Contains methods for interacting with user data, checking login\n   * status, generating cryptographically-secure ID tokens, and more.\n   */\n  public readonly user: UserModule;\n\n  /**\n   * Contains methods previously under the `ConnectExtension`, including\n   * login, show wallet UI, request user info, and more.\n   */\n  public readonly wallet: WalletModule;\n\n  /**\n   * Contains methods for interacting with NFTs, including purchase.\n   */\n  public readonly nft: NFTModule;\n\n  /**\n   * Contains a Web3-compliant provider. Pass this module to your Web3/Ethers\n   * instance for automatic compatibility with Ethereum methods.\n   */\n  public readonly rpcProvider: RPCProviderModule & AbstractProvider;\n\n  /**\n   * Creates an instance of Magic SDK.\n   */\n  constructor(public readonly apiKey: string, options?: MagicSDKAdditionalConfiguration) {\n    if (!apiKey) throw createMissingApiKeyError();\n\n    if (SDKEnvironment.platform === 'react-native' && options?.endpoint) {\n      createReactNativeEndpointConfigurationWarning().log();\n    }\n\n    const { defaultEndpoint, version } = SDKEnvironment;\n    this.testMode = !!options?.testMode;\n    this.useStorageCache = !!options?.useStorageCache;\n    this.endpoint = createURL(options?.endpoint ?? defaultEndpoint).origin;\n\n    // Prepare built-in modules\n    this.auth = new AuthModule(this);\n    this.user = new UserModule(this);\n    this.wallet = new WalletModule(this);\n    this.nft = new NFTModule(this);\n    this.rpcProvider = new RPCProviderModule(this) as any;\n\n    // Prepare extensions\n    const extConfig: any = prepareExtensions.call(this, options);\n\n    // Encode parameters as base64-JSON\n    this.parameters = encodeJSON<QueryParameters>({\n      API_KEY: this.apiKey,\n      DOMAIN_ORIGIN: window.location ? window.location.origin : '',\n      ETH_NETWORK: options?.network,\n      host: createURL(this.endpoint).host,\n      sdk: sdkNameToEnvName[SDKEnvironment.sdkName],\n      version,\n      ext: isEmpty(extConfig) ? undefined : extConfig,\n      locale: options?.locale || 'en_US',\n      ...(SDKEnvironment.bundleId ? { bundleId: SDKEnvironment.bundleId } : {}),\n      meta: options?.meta,\n    });\n    this.networkHash = getNetworkHash(this.apiKey, options?.network, isEmpty(extConfig) ? undefined : extConfig);\n    if (!options?.deferPreload) this.preload();\n  }\n\n  /**\n   * Represents the view controller associated with this `MagicSDK` instance.\n   */\n  protected get overlay(): ViewController {\n    if (!SDKBase.__overlays__.has(this.parameters)) {\n      const controller = new SDKEnvironment.ViewController(this.endpoint, this.parameters, this.networkHash);\n\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore - We don't want to expose this method to the user, but we\n      // need to invoke in here so that the `ViewController` is ready for use.\n      controller.init();\n\n      SDKBase.__overlays__.set(this.parameters, controller);\n    }\n\n    return SDKBase.__overlays__.get(this.parameters)!;\n  }\n\n  /**\n   * Preloads the Magic view, allowing for faster initial requests in browser\n   * environments. Awaiting the returned promise will signal when the Magic view\n   * has completed loading and is ready for requests.\n   */\n  public async preload() {\n    await this.overlay.checkIsReadyForRequest;\n  }\n}\n","import {\n  MagicIncomingWindowMessage,\n  MagicOutgoingWindowMessage,\n  JsonRpcRequestPayload,\n  MagicMessageEvent,\n  MagicMessageRequest,\n  SDKWarningCode,\n} from '@magic-sdk/types';\nimport { JsonRpcResponse } from './json-rpc';\nimport { createPromise } from '../util/promise-tools';\nimport { getItem, setItem } from '../util/storage';\nimport { createJwt } from '../util/web-crypto';\nimport { SDKEnvironment } from './sdk-environment';\nimport { MagicSDKWarning, createModalNotReadyError } from './sdk-exceptions';\nimport {\n  clearDeviceShares,\n  encryptAndPersistDeviceShare,\n  getDecryptedDeviceShare,\n} from '../util/device-share-web-crypto';\n\ninterface RemoveEventListenerFunction {\n  (): void;\n}\n\ninterface StandardizedResponse {\n  id?: string | number;\n  response?: JsonRpcResponse;\n}\n\ninterface StandardizedMagicRequest {\n  msgType: string;\n  payload: JsonRpcRequestPayload<any> | JsonRpcRequestPayload<any>[];\n  jwt?: string;\n  rt?: string;\n  deviceShare?: string;\n}\n\n/**\n * Get the originating payload from a batch request using the specified `id`.\n */\nfunction getRequestPayloadFromBatch(\n  requestPayload: JsonRpcRequestPayload | JsonRpcRequestPayload[],\n  id?: string | number | null,\n): JsonRpcRequestPayload | undefined {\n  return id && Array.isArray(requestPayload)\n    ? requestPayload.find((p) => p.id === id)\n    : (requestPayload as JsonRpcRequestPayload);\n}\n\n/**\n * Ensures the incoming response follows the expected schema and parses for a\n * JSON RPC payload ID.\n */\nfunction standardizeResponse(\n  requestPayload: JsonRpcRequestPayload | JsonRpcRequestPayload[],\n  event: MagicMessageEvent,\n): StandardizedResponse {\n  const id = event.data.response?.id;\n  const requestPayloadResolved = getRequestPayloadFromBatch(requestPayload, id);\n\n  if (id && requestPayloadResolved) {\n    // Build a standardized response object\n    const response = new JsonRpcResponse(requestPayloadResolved)\n      .applyResult(event.data.response.result)\n      .applyError(event.data.response.error);\n\n    return { id, response };\n  }\n\n  return {};\n}\n\nasync function createMagicRequest(\n  msgType: string,\n  payload: JsonRpcRequestPayload | JsonRpcRequestPayload[],\n  networkHash: string,\n) {\n  const rt = await getItem<string>('rt');\n  let jwt;\n\n  // only for webcrypto platforms\n  if (SDKEnvironment.platform === 'web') {\n    try {\n      jwt = (await getItem<string>('jwt')) ?? (await createJwt());\n    } catch (e) {\n      console.error('webcrypto error', e);\n    }\n  }\n\n  const request: StandardizedMagicRequest = { msgType, payload };\n\n  if (jwt) {\n    request.jwt = jwt;\n  }\n  if (jwt && rt) {\n    request.rt = rt;\n  }\n\n  // Grab the device share if it exists for the network\n  const decryptedDeviceShare = await getDecryptedDeviceShare(networkHash);\n  if (decryptedDeviceShare) {\n    request.deviceShare = decryptedDeviceShare;\n  }\n\n  return request;\n}\n\nasync function persistMagicEventRefreshToken(event: MagicMessageEvent) {\n  if (!event.data.rt) {\n    return;\n  }\n\n  await setItem('rt', event.data.rt);\n}\n\nexport abstract class ViewController {\n  public checkIsReadyForRequest: Promise<void>;\n  public isReadyForRequest: boolean;\n  protected readonly messageHandlers = new Set<(event: MagicMessageEvent) => any>();\n  protected isConnectedToInternet = true;\n\n  /**\n   * Create an instance of `ViewController`\n   *\n   * @param endpoint - The URL for the relevant iframe context.\n   * @param parameters - The unique, encoded query parameters for the\n   * relevant iframe context.\n   * @param networkHash - The hash of the network that this sdk instance is connected to\n   * for multi-chain scenarios\n   */\n  constructor(\n    protected readonly endpoint: string,\n    protected readonly parameters: string,\n    protected readonly networkHash: string,\n  ) {\n    this.checkIsReadyForRequest = this.waitForReady();\n    this.isReadyForRequest = false;\n    this.listen();\n  }\n\n  protected abstract init(): void;\n  protected abstract _post(data: MagicMessageRequest): Promise<void>;\n  protected abstract hideOverlay(): void;\n  protected abstract showOverlay(): void;\n\n  /**\n   * Send a payload to the Magic `<iframe>` for processing and automatically\n   * handle the acknowledging follow-up event(s).\n   *\n   * @param msgType - The type of message to encode with the data.\n   * @param payload - The JSON RPC payload to emit via `window.postMessage`.\n   */\n  public async post<ResultType = any>(\n    msgType: MagicOutgoingWindowMessage,\n    payload: JsonRpcRequestPayload[],\n  ): Promise<JsonRpcResponse<ResultType>[]>;\n\n  public async post<ResultType = any>(\n    msgType: MagicOutgoingWindowMessage,\n    payload: JsonRpcRequestPayload,\n  ): Promise<JsonRpcResponse<ResultType>>;\n\n  public async post<ResultType = any>(\n    msgType: MagicOutgoingWindowMessage,\n    payload: JsonRpcRequestPayload | JsonRpcRequestPayload[],\n  ): Promise<JsonRpcResponse<ResultType> | JsonRpcResponse<ResultType>[]> {\n    return createPromise(async (resolve, reject) => {\n      if (!this.isConnectedToInternet) {\n        const error = createModalNotReadyError();\n        reject(error);\n      }\n\n      if (!this.isReadyForRequest) {\n        await this.waitForReady();\n      }\n\n      const batchData: JsonRpcResponse[] = [];\n      const batchIds = Array.isArray(payload) ? payload.map((p) => p.id) : [];\n      const msg = await createMagicRequest(`${msgType}-${this.parameters}`, payload, this.networkHash);\n\n      await this._post(msg);\n\n      /**\n       * Collect successful RPC responses and resolve.\n       */\n      const acknowledgeResponse = (removeEventListener: RemoveEventListenerFunction) => (event: MagicMessageEvent) => {\n        const { id, response } = standardizeResponse(payload, event);\n        persistMagicEventRefreshToken(event);\n        if (response?.payload.error?.message === 'User denied account access.') {\n          clearDeviceShares();\n        } else if (event.data.deviceShare) {\n          const { deviceShare } = event.data;\n          encryptAndPersistDeviceShare(deviceShare, this.networkHash);\n        }\n        if (id && response && Array.isArray(payload) && batchIds.includes(id)) {\n          batchData.push(response);\n\n          // For batch requests, we wait for all responses before resolving.\n          if (batchData.length === payload.length) {\n            removeEventListener();\n            resolve(batchData);\n          }\n        } else if (id && response && !Array.isArray(payload) && id === payload.id) {\n          removeEventListener();\n          resolve(response);\n        }\n      };\n\n      // Listen for and handle responses.\n      const removeResponseListener = this.on(\n        MagicIncomingWindowMessage.MAGIC_HANDLE_RESPONSE,\n        acknowledgeResponse(() => removeResponseListener()),\n      );\n    });\n  }\n\n  /**\n   * Listen for events received with the given `msgType`.\n   *\n   * @param msgType - The `msgType` encoded with the event data.\n   * @param handler - A handler function to execute on each event received.\n   * @return A `void` function to remove the attached event.\n   */\n  public on(\n    msgType: MagicIncomingWindowMessage,\n    handler: (this: Window, event: MagicMessageEvent) => any,\n  ): RemoveEventListenerFunction {\n    const boundHandler = handler.bind(window);\n\n    // We cannot effectively cover this function because it never gets reference\n    // by value. The functionality of this callback is tested within\n    // `initMessageListener`.\n    /* istanbul ignore next */\n    const listener = (event: MagicMessageEvent) => {\n      if (event.data.msgType === `${msgType}-${this.parameters}`) boundHandler(event);\n    };\n\n    this.messageHandlers.add(listener);\n    return () => this.messageHandlers.delete(listener);\n  }\n\n  private waitForReady() {\n    return new Promise<void>((resolve) => {\n      const unsubscribe = this.on(MagicIncomingWindowMessage.MAGIC_OVERLAY_READY, () => {\n        this.isReadyForRequest = true;\n        resolve();\n        unsubscribe();\n      });\n\n      // We expect the overlay to be ready within 15 seconds.\n      // Sometimes the message is not properly processed due to\n      // webview issues. In that case, after 15 seconds we consider\n      // the overlay ready, to avoid requests hanging forever.\n      setTimeout(() => {\n        this.isReadyForRequest = true;\n        resolve();\n        unsubscribe();\n      }, 15000);\n    });\n  }\n\n  /**\n   * Listen for messages sent from the underlying Magic `<WebView>`.\n   */\n  private listen() {\n    this.on(MagicIncomingWindowMessage.MAGIC_HIDE_OVERLAY, () => {\n      this.hideOverlay();\n    });\n\n    this.on(MagicIncomingWindowMessage.MAGIC_SHOW_OVERLAY, () => {\n      this.showOverlay();\n    });\n\n    this.on(MagicIncomingWindowMessage.MAGIC_SEND_PRODUCT_ANNOUNCEMENT, (event: MagicMessageEvent) => {\n      if (event.data.response.result.product_announcement) {\n        new MagicSDKWarning(SDKWarningCode.ProductAnnouncement, event.data.response.result.product_announcement).log();\n      }\n    });\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}